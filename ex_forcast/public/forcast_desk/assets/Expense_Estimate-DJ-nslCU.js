var yt=Object.defineProperty;var Ve=Object.getOwnPropertySymbols;var wt=Object.prototype.hasOwnProperty,_t=Object.prototype.propertyIsEnumerable;var Re=(u,p,n)=>p in u?yt(u,p,{enumerable:!0,configurable:!0,writable:!0,value:n}):u[p]=n,ye=(u,p)=>{for(var n in p||(p={}))wt.call(p,n)&&Re(u,n,p[n]);if(Ve)for(var n of Ve(p))_t.call(p,n)&&Re(u,n,p[n]);return u};var P=(u,p,n)=>new Promise((m,r)=>{var c=f=>{try{w(n.next(f))}catch(j){r(j)}},y=f=>{try{w(n.throw(f))}catch(j){r(j)}},w=f=>f.done?m(f.value):Promise.resolve(f.value).then(c,y);w((n=n.apply(u,p)).next())});import{q as z,_ as De,o as l,c as a,b as e,e as v,u as o,d as h,v as k,h as _,J as kt,l as ce,p as le,m as St,n as Et,K as Ne,I as Ct,t as Le,j as ne,i as H,w as we,T as _e,F as x,x as D,B as R,L as $e,M as Ue,N as B,C as ke}from"./index-BbtVxGeo.js";import{u as jt,C as Me,a as Se}from"./yearSettingsStore-CilQFo7d.js";import{c as M,A as Dt,d as At,_ as Ft,e as pe,T as Ie,a as Ee,R as Tt,X as re,S as Oe,C as Pe}from"./SettingsModal-1hy0bolw.js";import{g as Ae,a as Je,c as Yt,s as ie,b as Vt,d as Rt,i as G,t as Nt,e as Be,f as ve,h as Y,r as Lt,j as ze,k as $t,l as Ut,m as Mt}from"./advanced_settings-CxjuzcaQ.js";import{l as It,a as Ce,b as de,c as me,e as je}from"./data_service-BaNe30yv.js";import{c as ue,C as Xe,a as Ot,T as Pt}from"./cloneDeep-DsfYDpDt.js";import{S as Bt,m as zt}from"./filter_utils-D6EjR3B4.js";import{g as qe,a as qt}from"./expense_options-C7RR1mW3.js";import{a as Kt}from"./payroll_data_service-BzVD1VR-.js";import{E as Wt,N as Ht}from"./ErrorState-JqQOeire.js";import{c as ge}from"./createLucideIcon-BMj80q4R.js";import{P as ee}from"./plus-x10FG7MU.js";import{a as Ke}from"./index-BKwUrwX7.js";import{L as Qt}from"./loader-circle-C4xYbVfY.js";import{F as Jt}from"./funnel-Bce4BdGF.js";import{R as Xt,T as Zt}from"./trash-2-Ds4vGNiS.js";import{B as Gt}from"./building-BVEDDje1.js";import{C as eo}from"./circle-plus-FTV919DA.js";import"./zap-CUuR70sR.js";/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=ge("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=ge("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=ge("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=ge("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);//! Helper function to find expense details from data
function oo(u,p,n,m){var w;const c=(((w=u==null?void 0:u[n])==null?void 0:w[m])||[]).find(f=>f.expense===p);if(c)return{department:c.department||"",department_location:c.department_location||"",hospitality_category:c.hospitality_category||"",cost_type:c.cost_type||""};const y=(u==null?void 0:u[n])||{};for(const f in y){const C=(y[f]||[]).find(N=>N.expense===p);if(C)return{department:C.department||"",department_location:C.department_location||"",hospitality_category:C.hospitality_category||"",cost_type:C.cost_type||""}}for(const f in u){const j=u[f]||{};for(const C in j){const L=(j[C]||[]).find(F=>F.expense===p);if(L)return{department:L.department||"",department_location:L.department_location||"",hospitality_category:L.hospitality_category||"",cost_type:L.cost_type||""}}}return{department:"",department_location:"",hospitality_category:"",cost_type:""}}//! Helper function to check if an expense is a default expense
function so(u,p){if(!Array.isArray(p)||typeof p.some!="function")return console.warn("defaultExpenses is not an array:",p),!1;try{return p.some(n=>n.expense===u)}catch(n){return console.error("Error checking if expense is default:",n),!1}}//! Helper function to get expense details from either default expenses or regular expense data
function lo(u,p,n,m,r){const c=r.find(w=>w.expense===u);if(c)return{department:c.department||"",department_location:c.department_location||"",cost_type:c.cost_type||"",hospitality_category:c.hospitality_category||""};const y=oo(m,u,p,n);return{department:y.department||"",department_location:y.department_location||"",cost_type:y.cost_type||"",hospitality_category:y.hospitality_category||""}}function ao(f,j,C,N,L,F,$){return P(this,arguments,function*(u,p,n,m,r,c,y,w=[]){var q,V;if(u.value.length===0)return;Array.isArray(w)||(console.warn("defaultExpenses is not an array, converting to empty array:",w),w=[]);const I=z.value;if(!I){M.error("No project selected. Please select a project first.");return}p.value=!0,n.value="";try{const O=u.value.map(T=>{const X=lo(T.expense,T.year,T.label,m.value,w),te=so(T.expense,w);return{year:T.year,month:T.label,expense:T.expense,amount:parseFloat(T.newValue),department:X.department,department_location:X.department_location,cost_type:X.cost_type,hospitality_category:X.hospitality_category,is_default_expense:te}});console.log("Saving expense changes with payload:",O);const S=yield(yield fetch("/api/method/ex_forcast.api.expense_estimate.upsert_expense_items",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({changes:O,project:I.project_name})})).json();if(((q=S.message)==null?void 0:q.status)==="success"){M.success("Changes saved successfully!"),c.value=!0,u.value=[];const T=yield y();m.value=T,r.value=ue(T)}else{const T=typeof((V=S.message)==null?void 0:V.message)=="string"?S.message.message:"Save failed.";M.error(T)}}catch(O){const U=typeof O.message=="string"?O.message:"Save failed.";M.error(U)}finally{p.value=!1}})}function no(u,p,n){if(!p||!p.value||!p.value.rows){console.warn("addExpenseForm is not properly initialized");return}const m=p.value.rows[u];if(!m){console.warn(`Row at index ${u} not found`);return}let r=m.amountDisplay;r=r.replace(/[^\d.]/g,"");const c=r.split(".");if(c.length>2&&(r=c[0]+"."+c.slice(1).join("")),!r.includes(".")||c.length===2&&c[1].length===2){c.length===2&&c[1].length>2&&(r=c[0]+"."+c[1].substring(0,2));const f=(parseFloat(r)||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});if(f!==n.target.innerText){n.target.innerText=f;const j=document.createRange(),C=window.getSelection(),N=n.target.firstChild||n.target;j.setStart(N,N.textContent.length),j.collapse(!0),C.removeAllRanges(),C.addRange(j)}}else r!==n.target.innerText&&(n.target.innerText=r)}function ro(u,p){if(!p||!p.value||!p.value.rows){console.warn("addExpenseForm is not properly initialized");return}const n=p.value.rows[u];if(!n){console.warn(`Row at index ${u} not found`);return}const m=parseFloat(n.amountDisplay.replace(/[^\d.]/g,""))||0;n.amountDisplay=m.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),n.amount=m}function io({year:u,label:p,expense:n,event:m,originalExpenseData:r,changedCells:c,expenseData:y,isSaved:w}){var F,$,I,q;let f=m.target.innerText.replace(/,/g,"").trim();f===""&&(f="0.00"),f=(parseFloat(f)||0).toFixed(2);let C="0.00";const L=((($=(F=r.value)==null?void 0:F[u])==null?void 0:$[p])||[]).find(V=>V.expense===n);if(L&&(C=parseFloat(L.amount).toFixed(2)),f!==C){w.value=!1;const V=c.value.findIndex(S=>S.year===u&&S.label===p&&S.expense===n);V!==-1?c.value[V].newValue=f:c.value.push({year:u,label:p,expense:n,newValue:f});const U=(((q=(I=y.value)==null?void 0:I[u])==null?void 0:q[p])||[]).find(S=>S.expense===n);U&&(U.amount=parseFloat(f))}else c.value=c.value.filter(V=>!(V.year===u&&V.label===p&&V.expense===n)),c.value.length===0&&(w.value=!0)}function uo({year:u,label:p,expense:n,event:m}){let r=m.target.innerText;r=r.replace(/[^\d.]/g,"");const c=r.split(".");if(c.length>2&&(r=c[0]+"."+c.slice(1).join("")),!r.includes(".")||c.length===2&&c[1].length===2){c.length===2&&c[1].length>2&&(r=c[0]+"."+c[1].substring(0,2));const f=(parseFloat(r)||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});if(f!==m.target.innerText){m.target.innerText=f;const j=document.createRange(),C=window.getSelection(),N=m.target.firstChild||m.target;j.setStart(N,N.textContent.length),j.collapse(!0),C.removeAllRanges(),C.addRange(j)}}else r!==m.target.innerText&&(m.target.innerText=r)}function co({year:u,label:p,expense:n,event:m}){const c=m.target.innerText.replace(/,/g,"");m.target.innerText=c;const y=document.createRange(),w=window.getSelection();y.selectNodeContents(m.target),w.removeAllRanges(),w.addRange(y)}function po(u,p,n,m,r){let c=0;for(const y of p.locations)for(const w of y.expenses){const f=Ae(u,w,n,m,r),j=parseFloat(f.toString().replace(/,/g,""));isNaN(j)||(c+=j)}return c.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}function Qe(u,p,n,m){const r=Je(m);let c=0;for(const y of p.locations)for(const w of y.expenses)for(const f of r){const j=Ae(u,w,n,f,m),C=parseFloat(j.toString().replace(/,/g,""));isNaN(C)||(c+=C)}return c.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}function vo(u,p,n,m,r,c){return P(this,null,function*(){var N;const{year:y,month:w,rows:f}=u.value;if(!y||!w||f.length===0){r.error("Please select year, month, and add at least one expense.");return}const j=f.filter(L=>L.expense&&L.amount>0),C=yield Yt({year:y,month:w,expenses:j});C.success?(r.success(`Expense document created successfully: ${C.name}`),p.value=!1,n(),c&&(yield c()),m.value=!0):r.error("Failed to create document: "+(((N=C.error)==null?void 0:N.message)||C.error))})}const mo={class:"flex flex-col items-center justify-center h-96"},fo={class:"w-24 h-24 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center mb-6"},go={class:"text-gray-600 mb-6 text-center max-w-md"},xo={class:"font-semibold text-violet-600"},bo={__name:"NoDataState",props:{project:{type:String,default:""}},emits:["add-expense"],setup(u){return(p,n)=>(l(),a("div",mo,[e("div",fo,[v(o(fe),{class:"w-12 h-12 text-blue-600"})]),n[4]||(n[4]=e("h3",{class:"text-xl font-semibold text-gray-800 mb-2"},"No Expense Data Found",-1)),e("p",go,[n[1]||(n[1]=h(" The project ")),e("span",xo,k(u.project),1),n[2]||(n[2]=h(" doesn't have any expense data yet. "))]),e("button",{onClick:n[0]||(n[0]=m=>p.$emit("add-expense")),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-violet-500 to-violet-600 text-white rounded-lg hover:from-violet-600 hover:to-violet-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[v(o(ee),{class:"w-4 h-4"}),n[3]||(n[3]=h(" Add First Expense "))])]))}},ho=De(bo,[["__scopeId","data-v-7e3d9036"]]),yo={class:"flex flex-col items-center justify-center min-h-[400px] bg-white border-2 border-dashed border-violet-300 rounded-xl shadow-sm"},wo={class:"w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center mb-4"},_o={class:"text-lg text-violet-700 font-semibold mb-2"},ko={class:"text-gray-500 text-center max-w-md leading-relaxed text-sm"},So={class:"mt-4 flex items-center gap-2 text-xs text-violet-600"},Eo={__name:"NoYearsSelectedState",props:{fromYear:{type:String,default:""},toYear:{type:String,default:""}},setup(u){return(p,n)=>(l(),a("div",yo,[e("div",wo,[v(o(Xe),{class:"w-8 h-8 text-violet-500"})]),e("h3",_o,k(u.fromYear&&!u.toYear?'Select "To Year"':!u.fromYear&&u.toYear?'Select "From Year"':"No Years Selected"),1),e("p",ko,k(u.fromYear&&!u.toYear?"You have selected a From Year, now please select a To Year to display the expense table.":!u.fromYear&&u.toYear?"You have selected a To Year, now please select a From Year to display the expense table.":'Please select both "From Year" and "To Year" in the left panel to display the expense table.'),1),e("div",So,[v(o(Dt),{class:"w-3 h-3"}),n[0]||(n[0]=e("span",null,"Use the filters on the left to get started",-1))])]))}},Co=De(Eo,[["__scopeId","data-v-741a36b9"]]),jo={class:"flex"},Do={class:"flex-1 min-h-screen bg-gradient-to-br from-white to-violet-50"},Ao={class:"flex"},Fo={key:2,class:"text-violet-700 text-sm font-medium"},To={class:"mb-8"},Yo={class:"flex items-center gap-3 mb-2"},Vo={class:"w-12 h-12 bg-gradient-to-br from-violet-500 to-violet-600 rounded-xl flex items-center justify-center shadow-lg"},Ro={class:"bg-white rounded-xl p-4 mb-6 border border-gray-200 shadow-sm"},No={class:"flex items-center justify-between"},Lo={class:"flex items-center gap-2"},$o={key:0,class:"flex items-center gap-2 text-sm font-medium text-red-600 bg-red-50 px-3 py-2 rounded-lg border border-red-200"},Uo={key:1,class:"flex items-center gap-2 text-sm font-medium text-green-600 bg-green-50 px-3 py-2 rounded-lg border border-green-200"},Mo=["disabled"],Io={key:1,class:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg cursor-not-allowed"},Oo={key:0,class:"mt-2 text-xs text-red-500 flex items-center gap-1"},Po={class:"mb-8"},Bo={class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},zo={class:"flex gap-2 mt-3"},qo={class:"flex-1"},Ko={class:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm"},Wo={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},Ho={class:"space-y-4"},Qo={class:"grid grid-cols-2 gap-3"},Jo={class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},Xo=["value"],Zo={class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},Go=["value"],es={class:"flex gap-2"},ts={class:"flex-1 p-4"},os={key:0},ss={key:1},ls={key:2},as={class:"mb-4"},ns={class:"flex items-center gap-2"},rs={class:"flex items-center gap-2"},is={class:"w-6 h-6 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},ds={class:"mt-2"},us={class:"bg-white rounded-lg border border-violet-200 shadow-sm overflow-hidden md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px]"},cs={class:"overflow-x-auto max-w-[100%] md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px]"},ps={class:"min-w-full w-max"},vs={class:"w-full"},ms={class:"bg-gradient-to-r from-violet-600 to-violet-700 text-white"},fs={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},gs={class:"flex items-center gap-1"},xs={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},bs={class:"flex items-center gap-1"},hs={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},ys={class:"flex items-center gap-1"},ws=["colspan","onClick"],_s={class:"flex items-center justify-center gap-1"},ks={class:"font-semibold"},Ss={class:"bg-violet-500/90 text-xs"},Es={class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},Cs={class:"flex items-center justify-center gap-1"},js={key:1,class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},Ds={class:"flex items-center justify-center gap-1"},As={class:"text-gray-700 bg-white text-sm"},Fs={class:"bg-gradient-to-r from-violet-600 to-violet-700 border-b-2 border-violet-800"},Ts={colspan:"3",class:"px-3 py-3 font-bold text-white border-r border-violet-500"},Ys={class:"flex items-center gap-2"},Vs={key:1,class:"px-1 py-1 text-center border border-violet-500 bg-violet-600"},Rs={class:"bg-gradient-to-r from-violet-100 to-violet-200 border-b border-violet-300"},Ns={colspan:"3",class:"px-6 py-2 font-semibold text-violet-700 border-r border-violet-300"},Ls={class:"flex items-center gap-2"},$s={key:1,class:"px-1 py-1 text-center border border-violet-300 bg-violet-100"},Us={class:"px-8 py-2 font-medium border-r border-violet-200 text-gray-600"},Ms={class:"flex items-center gap-1"},Is={class:"px-3 py-2 font-medium border-r border-violet-200"},Os={class:"flex items-center justify-between gap-2"},Ps=["onClick"],Bs={class:"px-3 py-2 font-medium border-r border-violet-200 text-gray-600"},zs={class:"flex items-center gap-1"},qs=["onInput","onFocus","onBlur"],Ks={class:"font-mono text-xs"},Ws={class:"px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50"},Hs={class:"font-mono text-xs text-violet-700"},Qs={key:1,class:"px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50"},Js={class:"font-mono text-xs text-violet-700"},Xs={class:"bg-gradient-to-r from-violet-200 to-violet-300 border-y-2 border-violet-500"},Zs={colspan:"3",class:"px-3 py-2 font-bold text-violet-900 border-r border-violet-400"},Gs={class:"flex items-center gap-1"},el={class:"font-mono text-xs"},tl={class:"px-2 py-1 text-right border border-violet-400 bg-violet-200 font-bold text-violet-900"},ol={class:"font-mono text-xs"},sl={key:1,class:"px-2 py-1 text-right border border-violet-400 bg-violet-200 font-bold text-violet-900"},ll={class:"font-mono text-xs"},al={key:4,class:"flex flex-col items-center justify-center min-h-[400px] bg-white border-2 border-dashed border-violet-300 rounded-xl shadow-sm"},nl={class:"w-16 h-16 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center mb-4"},rl={class:"text-gray-600 text-center max-w-md leading-relaxed text-sm"},il={class:"font-semibold text-violet-600"},dl={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm"},ul={class:"bg-white rounded-2xl shadow-2xl border border-violet-200 w-[95%] max-w-lg p-0 overflow-hidden"},cl={class:"flex items-center gap-3 px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},pl={class:"p-8 pt-6"},vl={key:0,class:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center gap-3"},ml={key:1,class:"space-y-4 max-h-[50vh] overflow-auto pr-2"},fl={class:"font-medium text-gray-700 flex items-center gap-2"},gl=["onUpdate:modelValue"],xl={class:"flex justify-end gap-3 px-8 py-4 bg-gray-50 border-t border-violet-100"},bl={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm"},hl={class:"bg-white rounded-2xl shadow-2xl border border-violet-100 w-[95%] max-w-4xl max-h-[90vh] overflow-hidden flex flex-col"},yl={class:"flex items-center justify-between px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},wl={class:"flex items-center gap-3"},_l={class:"p-8 pb-0 space-y-6 overflow-y-auto max-h-[calc(90vh-140px)]"},kl={class:"grid grid-cols-2 gap-6"},Sl=["value"],El=["value"],Cl={class:"mb-6"},jl={class:"flex items-center gap-3"},Dl={class:"w-8 h-8 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},Al={class:"mt-3 space-y-4 p-4 bg-white border border-violet-200 rounded-lg shadow-sm"},Fl={class:"flex items-center gap-3 mb-2"},Tl={class:"grid grid-cols-4 gap-3"},Yl=["value"],Vl=["disabled"],Rl={class:"space-y-4"},Nl={class:"space-y-4"},Ll={class:"flex items-center justify-between mb-4"},$l={class:"text-lg font-semibold text-gray-800"},Ul=["onClick","disabled"],Ml={class:"grid grid-cols-2 rounded-lg p-2 gap-6"},Il=["onUpdate:modelValue"],Ol=["value"],Pl=["onUpdate:modelValue"],Bl=["value"],zl=["onUpdate:modelValue"],ql=["value"],Kl=["onUpdate:modelValue"],Wl=["value"],Hl=["onUpdate:modelValue","onInput","onBlur"],Ql={class:"flex justify-between items-center pt-3 pb-3 border-t border-gray-200 bg-white sticky bottom-0"},Jl={class:"flex gap-3"},Xl={__name:"Expense_Estimate",setup(u){const p=_([]),n=_("monthly"),m=_([]),r=_({}),c=_([]),y=_([]),w=_(!1),f=_({}),j=_([]),C=_(localStorage.getItem("hospitalityExperience")===null?!0:localStorage.getItem("hospitalityExperience")==="true"),N=_([]),L=_([]),F=_(!1),$=_({}),I=_(new Set),q=_([]),V=_(!1),O=_("");_(!1),_(null);const U=_(!1);_(""),_(!1);const S=_({account_name:"",account_number:"",parent_account:""}),T=_(!1),X=_([]),te=_(!1);_(""),_("");const ae=_([]),Z=_([]),xe=_(!1),be=jt(),{fromYear:oe,toYear:se,advancedModes:K}=kt(be),{setFromYear:Zl,setToYear:Gl,setAdvancedModes:Ze,clearYearSettings:Ge,getFilteredToYears:et}=be,A=ce(()=>Vt(oe.value,se.value)),tt=ce(()=>et(p.value)),ot=ce(()=>Rt(r.value,A.value,y.value));function st(i){const t=new Set(I.value);t.add(i),I.value=t,F.value=!1}function lt(){try{$.value&&Object.keys($.value).length&&(r.value=ue($.value)),I.value=new Set,F.value=!1,M.info("Restored to original")}catch(i){}}function at(i){const t=I.value;return(i||[]).filter(E=>!t.has(E))}const Fe=ce(()=>{if(y.value.length>0)return!0;if(!A.value.length||r.value.status)return!1;for(const i of A.value)if(r.value[i]&&Object.keys(r.value[i]).length>0){for(const t in r.value[i])if(r.value[i][t]&&r.value[i][t].length>0)return!0}return!1}),Q=i=>i==="Default"?["Default"]:Je(K.value[i]||n.value),Te=i=>c.value.length>0?$t(c.value,i):Ut(r.value,i,A.value,y.value);le(A,()=>{A.value.forEach(i=>{K.value[i]||be.setAdvancedMode(i,n.value)})}),le(C,i=>{localStorage.setItem("hospitalityExperience",i)}),setInterval(()=>{const i=localStorage.getItem("hospitalityExperience"),t=i===null?!0:i==="true";C.value!==t&&(C.value=t)},1e3),le(z,(i,t)=>P(this,null,function*(){if(i&&i!==t)try{const E=yield Ce();E.status==="success"&&(c.value=E.expenses);const s=yield de();s.status==="success"&&(y.value=s.defaultExpenses),r.value=yield me(),r.value.status?($.value=r.value,m.value=[]):($.value=ue(r.value),m.value=je(r.value)),q.value=[],F.value=!0,M.success(`Switched to project: ${i.project_name}`);try{ae.value=yield Ne(i.project_name)}catch(b){ae.value=[]}try{const d=yield(yield fetch("/api/method/ex_forcast.api.payroll_department_location_list.get_payroll_department_location_list")).json();d.message&&d.message.success?Z.value=(d.message.locations||[]).map(g=>g.department_location||g.name):Z.value=[]}catch(b){Z.value=[]}}catch(E){console.error("Error loading project data:",E),M.error("Failed to load project data. Please try again.")}}),{immediate:!0}),le(()=>{var i;return(i=z.value)==null?void 0:i.project_name},(i,t)=>P(this,null,function*(){if(i&&i!==t)try{const E=yield de();E.status==="success"&&(y.value=E.defaultExpenses)}catch(E){console.error("Error loading default expenses for project:",E)}}),{immediate:!0}),le(w,i=>{i&&(f.value=ye({},K.value))});function nt(){Ze(ye({},f.value)),w.value=!1}function rt(){w.value=!1}St(()=>P(this,null,function*(){var i,t;try{yield Et(),p.value=yield It();const E=yield Ce();if(E.status==="success"&&(c.value=E.expenses),z.value){const g=yield de();g.status==="success"&&(y.value=g.defaultExpenses)}r.value=yield me(),r.value.status?($.value=r.value,m.value=[]):($.value=ue(r.value),m.value=je(r.value)),j.value=((i=yield qe())==null?void 0:i.map(g=>({label:g,value:g})))||[];const s=yield qt();N.value=s.hospitality_category.map(g=>({label:g,value:g})),L.value=s.cost_type.map(g=>({label:g,value:g}));const d=yield(yield fetch("/api/v2/method/ex_forcast.api.account_list.get_group_accounts")).json();if(d.data&&d.data.group_accounts&&(X.value=d.data.group_accounts),z&&z.value&&z.value.project_name)try{ae.value=yield Ne(z.value.project_name)}catch(g){ae.value=[]}try{yield Kt();const W=yield(yield fetch("/api/method/ex_forcast.api.payroll_department_location_list.get_payroll_department_location_list")).json();W.message&&W.message.success?Z.value=(W.message.locations||[]).map(J=>J.department_location||J.name):Z.value=[]}catch(g){Z.value=[]}if(F.value=!0,localStorage.getItem("showRefreshSuccess")==="true"&&(localStorage.removeItem("showRefreshSuccess"),M.success("Page refreshed successfully")),(t=z.value)!=null&&t.project_name){const g=yield de();g.status==="success"&&(y.value=g.defaultExpenses)}}catch(E){console.error("Error loading data:",E)}}));function it(){Ge(),F.value=!1}function dt({year:i,label:t,expense:E,event:s}){io({year:i,label:t,expense:E,event:s,originalExpenseData:$,changedCells:q,expenseData:r,isSaved:F})}const ut=(i,t)=>{Y&&Y.value&&Y.value.rows&&no(i,Y,t)},ct=i=>{Y&&Y.value&&Y.value.rows&&ro(i,Y)},pt=()=>P(this,null,function*(){Y&&Y.value&&(yield vo(Y,ie,Mt,F,M,()=>P(this,null,function*(){const i=yield Ce();i.status==="success"&&(c.value=i.expenses);const t=yield de();t.status==="success"&&(y.value=t.defaultExpenses),r.value=yield me(),r.value.status||($.value=ue(r.value),m.value=je(r.value))})))}),vt=()=>P(this,null,function*(){yield ao(q,V,O,r,$,F,me,y.value)});le(F,i=>{i?window.removeEventListener("beforeunload",he):window.addEventListener("beforeunload",he)});function he(i){if(!F.value)return i.preventDefault(),i.returnValue="You have unsaved changes that may be discarded if not saved. Are you sure you want to leave?",i.returnValue}Ct(()=>{window.removeEventListener("beforeunload",he)});function Ye(){localStorage.setItem("showRefreshSuccess","true"),window.location.reload()}function mt(){return P(this,null,function*(){var i;if(!(!S.value.account_name.trim()||!S.value.account_number.trim()||!S.value.parent_account)){T.value=!0;try{const E=yield(yield fetch("/api/v2/method/ex_forcast.api.account_list.create_account",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({account_name:S.value.account_name.trim(),account_number:S.value.account_number.trim(),parent_account:S.value.parent_account})})).json();E.data&&E.data.success?(M.success(`Account '${S.value.account_name.trim()}' created successfully!`),S.value={account_name:"",account_number:"",parent_account:""},j.value=((i=yield qe())==null?void 0:i.map(s=>({label:s,value:s})))||[]):M.error(E.data&&E.data.error||E.error||"Failed to create account.")}catch(t){M.error("Failed to create account.")}finally{T.value=!1}}})}function ft(i){const t=i.which?i.which:i.keyCode;t>31&&(t<48||t>57)&&i.preventDefault()}function gt(i){i.preventDefault();const E=(i.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");S.value.account_number+=E}function xt(i){S.value.account_number=i.target.value.replace(/[^0-9]/g,"")}function bt(){xe.value=!0}function ht(){xe.value=!1}return(i,t)=>{var E;return l(),a(x,null,[e("div",jo,[v(Ft,{onOpenSettings:bt}),e("div",Do,[e("div",Ao,[e("div",{class:Le(["bg-gradient-to-b from-white to-gray-50 border-r border-gray-200 min-h-screen flex flex-col shadow-sm transition-all duration-300",U.value?"w-14 p-2":"w-80 p-6"])},[e("button",{onClick:t[0]||(t[0]=s=>U.value=!U.value),class:"mb-4 flex items-center gap-2 px-2 py-1 bg-violet-100 hover:bg-violet-200 rounded transition-all"},[U.value?(l(),ne(o(Me),{key:1,class:"w-5 h-5 text-violet-700"})):(l(),ne(o(Ot),{key:0,class:"w-5 h-5 text-violet-700"})),U.value?H("",!0):(l(),a("span",Fo,"Collapse"))]),v(_e,{name:"fade"},{default:we(()=>[R(e("div",null,[e("div",To,[e("div",Yo,[e("div",Vo,[v(o(pe),{class:"w-7 h-7 mx-2 text-white"})]),t[17]||(t[17]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Expense Assumptions",-1))]),t[18]||(t[18]=e("p",{class:"text-sm text-gray-500"},"Manage and configure your expense data",-1))]),e("div",Ro,[e("div",No,[e("div",Lo,[F.value?(l(),a("div",Uo,[v(o(Ee),{class:"w-4 h-4 text-green-600"}),t[20]||(t[20]=h(" All Saved "))])):(l(),a("div",$o,[v(o(Ie),{class:"w-4 h-4 text-red-600"}),t[19]||(t[19]=h(" Unsaved "))]))]),!V.value&&!F.value?(l(),a("button",{key:0,disabled:V.value,onClick:vt,class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-lg hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[v(o(Bt),{class:"w-4 h-4"}),t[21]||(t[21]=h(" Save "))],8,Mo)):H("",!0),V.value?(l(),a("button",Io,[v(o(Qt),{class:"w-4 h-4 animate-spin"}),t[22]||(t[22]=h(" Saving... "))])):H("",!0)]),O.value?(l(),a("span",Oo,[v(o(Xe),{class:"w-3 h-3"}),h(" "+k(O.value),1)])):H("",!0)]),e("div",Po,[e("h3",Bo,[v(o(ee),{class:"w-4 h-4 text-violet-600"}),t[23]||(t[23]=h(" Quick Actions "))]),e("button",{onClick:t[1]||(t[1]=s=>ie.value=!0),class:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-violet-500 to-violet-600 text-white rounded-xl hover:from-violet-600 hover:to-violet-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 font-medium"},[v(o(ee),{class:"w-4 h-4"}),t[24]||(t[24]=h(" Add New Expense "))]),e("div",zo,[e("button",{onClick:Ye,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-violet-200 text-violet-700 rounded-lg hover:bg-violet-50 transition-all text-sm font-medium"},[v(o(Tt),{class:"w-4 h-4"}),t[25]||(t[25]=h(" Refresh "))])])]),e("div",qo,[e("div",Ko,[e("h3",Wo,[v(o(Jt),{class:"w-5 h-5 text-violet-600"}),t[26]||(t[26]=h(" Year Range Filter "))]),e("div",Ho,[e("div",Qo,[e("div",null,[e("label",Jo,[v(o(Se),{class:"w-3 h-3 text-gray-500"}),t[27]||(t[27]=h(" From Year "))]),R(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>Ue(oe)?oe.value=s:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-sm"},[t[28]||(t[28]=e("option",{value:""},"Select Year",-1)),(l(!0),a(x,null,D(p.value,s=>(l(),a("option",{key:"from-"+s,value:s},k(s),9,Xo))),128))],512),[[B,o(oe)]])]),e("div",null,[e("label",Zo,[v(o(Se),{class:"w-3 h-3 text-gray-500"}),t[29]||(t[29]=h(" To Year "))]),R(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>Ue(se)?se.value=s:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-sm"},[t[30]||(t[30]=e("option",{value:""},"Select Year",-1)),(l(!0),a(x,null,D(tt.value,s=>(l(),a("option",{key:"to-"+s,value:s},k(s),9,Go))),128))],512),[[B,o(se)]])])]),e("div",es,[e("button",{onClick:it,class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all duration-200 text-sm font-medium"},[v(o(re),{class:"w-4 h-4"}),t[31]||(t[31]=h(" Clear "))]),e("button",{onClick:t[4]||(t[4]=s=>w.value=!0),class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-white border border-violet-500 text-violet-700 rounded-lg hover:bg-violet-50 transition-all duration-200 text-sm font-medium"},[v(o(Oe),{class:"w-4 h-4"}),t[32]||(t[32]=h(" Advanced "))])])])])])],512),[[$e,!U.value]])]),_:1})],2),e("div",ts,[r.value.status==="no_project_selected"?(l(),a("div",os,[v(Ht)])):r.value.status==="no_data"?(l(),a("div",ss,[v(ho,{project:r.value.project,onAddExpense:t[5]||(t[5]=s=>ie.value=!0)},null,8,["project"])])):r.value.status==="error"?(l(),a("div",ls,[v(Wt,{message:r.value.message,onRetry:Ye},null,8,["message"])])):A.value.length&&Fe.value?(l(),a(x,{key:3},[e("div",as,[e("div",ns,[e("div",rs,[e("div",is,[v(o(Pt),{class:"w-3 h-3 text-white"})]),t[33]||(t[33]=e("h2",{class:"text-lg font-bold text-gray-800"},"Expense Overview",-1))])]),e("div",ds,[e("button",{onClick:lt,class:"inline-flex items-center gap-2 px-3 py-1.5 bg-gray-500 text-white rounded-md hover:bg-gray-600 text-sm font-medium shadow-sm"},[v(o(Xt),{class:"w-4 h-4"}),t[34]||(t[34]=h(" Restore "))])])]),e("div",us,[e("div",cs,[e("div",ps,[e("table",vs,[e("thead",ms,[e("tr",null,[e("th",fs,[e("div",gs,[v(o(We),{class:"w-3 h-3"}),t[35]||(t[35]=h(" Code "))])]),e("th",xs,[e("div",bs,[v(o(fe),{class:"w-3 h-3"}),t[36]||(t[36]=h(" Expense "))])]),e("th",hs,[e("div",ys,[v(o(He),{class:"w-3 h-3"}),t[37]||(t[37]=h(" Cost Type "))])]),(l(!0),a(x,null,D(A.value.length>0?A.value:["Default"],s=>(l(),a("th",{key:"header-"+s,colspan:o(G)(s)?1:Q(s).length+1,class:"px-2 py-2 text-center border-x-2 border-white cursor-pointer select-none hover:bg-violet-700 transition-all duration-200 group text-sm",onClick:b=>o(Nt)(s),title:"Click to collapse/expand"},[e("div",_s,[e("span",ks,k(s==="Default"?"Default":s),1),o(G)(s)?(l(),ne(o(Me),{key:1,class:"w-3 h-3 transition-transform group-hover:scale-110"})):(l(),ne(o(Pe),{key:0,class:"w-3 h-3 transition-transform group-hover:scale-110"}))])],8,ws))),128))]),e("tr",Ss,[(l(!0),a(x,null,D(A.value.length>0?A.value:["Default"],s=>(l(),a(x,{key:"months-"+s},[o(G)(s)?(l(),a("th",js,[e("div",Ds,[v(o(pe),{class:"w-2 h-2"}),t[39]||(t[39]=h(" Total "))])])):(l(),a(x,{key:0},[(l(!0),a(x,null,D(Q(s),b=>(l(),a("th",{key:s+"-"+b,class:"px-2 py-1 text-center border border-violet-300 min-w-[100px] font-medium"},k(b),1))),128)),e("th",Es,[e("div",Cs,[v(o(pe),{class:"w-2 h-2"}),t[38]||(t[38]=h(" Total "))])])],64))],64))),128))])]),e("tbody",As,[(l(!0),a(x,null,D(ot.value,s=>(l(),a(x,{key:"department-"+s.department},[e("tr",Fs,[e("td",Ts,[e("div",Ys,[v(o(Gt),{class:"w-4 h-4"}),h(" "+k(s.department),1)])]),(l(!0),a(x,null,D(A.value.length>0?A.value:["Default"],b=>(l(),a(x,{key:"department-header-"+b},[o(G)(b)?(l(),a("td",Vs)):(l(),a(x,{key:0},[(l(!0),a(x,null,D(Q(b),d=>(l(),a("td",{key:"department-cell-"+b+"-"+d,class:"px-1 py-1 text-center border border-violet-500 bg-violet-600"}))),128)),t[40]||(t[40]=e("td",{class:"px-1 py-1 text-center border border-violet-500 bg-violet-600"},null,-1))],64))],64))),128))]),(l(!0),a(x,null,D(s.locations,b=>(l(),a(x,{key:"location-"+b.location},[e("tr",Rs,[e("td",Ns,[e("div",Ls,[v(o(to),{class:"w-3 h-3"}),h(" "+k(b.location),1)])]),(l(!0),a(x,null,D(A.value.length>0?A.value:["Default"],d=>(l(),a(x,{key:"location-header-"+d},[o(G)(d)?(l(),a("td",$s)):(l(),a(x,{key:0},[(l(!0),a(x,null,D(Q(d),g=>(l(),a("td",{key:"location-cell-"+d+"-"+g,class:"px-1 py-1 text-center border border-violet-300 bg-violet-100"}))),128)),t[41]||(t[41]=e("td",{class:"px-1 py-1 text-center border border-violet-300 bg-violet-100"},null,-1))],64))],64))),128))]),(l(!0),a(x,null,D(at(b.expenses),d=>(l(),a("tr",{key:"expense-"+d,class:"even:bg-gray-50 hover:bg-violet-50 transition-all duration-200 border-b border-gray-100"},[e("td",Us,[e("div",Ms,[v(o(We),{class:"w-2 h-2 text-gray-400"}),h(" "+k(Te(d).code),1)])]),e("td",Is,[e("div",Os,[e("span",null,k(d),1),e("button",{onClick:g=>st(d),class:"text-red-600 hover:text-red-700",title:"Delete expense"},[v(o(re),{class:"w-4 h-4"})],8,Ps)])]),e("td",Bs,[e("div",zs,[v(o(He),{class:"w-2 h-2 text-gray-400"}),h(" "+k(Te(d).costType),1)])]),(l(!0),a(x,null,D(A.value.length>0?A.value:["Default"],g=>(l(),a(x,{key:"row-"+g+"-"+d},[o(G)(g)?(l(),a("td",Qs,[e("span",Js,k(g==="Default"?"0.00":o(Be)(r.value,d,g,o(K)[g]||n.value,Q)),1)])):(l(),a(x,{key:0},[(l(!0),a(x,null,D(Q(g),W=>(l(),a("td",{key:"cell-"+g+"-"+W,contenteditable:"true",class:"px-2 py-1 text-right border border-violet-200 hover:bg-violet-50 focus:bg-white focus:outline-none focus:ring-1 focus:ring-violet-500 focus:border-transparent transition-all duration-200",onInput:J=>o(uo)({year:g,label:W,expense:d,event:J}),onFocus:J=>o(co)({year:g,label:W,expense:d,event:J}),onBlur:J=>dt({year:g,label:W,expense:d,event:J})},[e("span",Ks,k(g==="Default"?"0.00":o(Ae)(r.value,d,g,W,o(K)[g]||n.value)),1)],40,qs))),128)),e("td",Ws,[e("span",Hs,k(g==="Default"?"0.00":o(Be)(r.value,d,g,o(K)[g]||n.value,Q)),1)])],64))],64))),128))]))),128))],64))),128)),e("tr",Xs,[e("td",Zs,[e("div",Gs,[v(o(pe),{class:"w-3 h-3"}),t[42]||(t[42]=h(" Department Total "))])]),(l(!0),a(x,null,D(A.value.length>0?A.value:["Default"],b=>(l(),a(x,{key:"department-total-"+b},[o(G)(b)?(l(),a("td",sl,[e("span",ll,k(b==="Default"?"0.00":o(Qe)(r.value,s,b,o(K)[b]||n.value)),1)])):(l(),a(x,{key:0},[(l(!0),a(x,null,D(Q(b),d=>(l(),a("td",{key:"department-total-cell-"+b+"-"+d,class:"px-2 py-1 text-right border border-violet-400 bg-violet-200 font-bold text-violet-900"},[e("span",el,k(b==="Default"?"0.00":o(po)(r.value,s,b,d,o(K)[b]||n.value)),1)]))),128)),e("td",tl,[e("span",ol,k(b==="Default"?"0.00":o(Qe)(r.value,s,b,o(K)[b]||n.value)),1)])],64))],64))),128))])],64))),128))])])])])])],64)):A.value.length&&!Fe.value?(l(),a("div",al,[e("div",nl,[v(o(fe),{class:"w-8 h-8 text-blue-600"})]),t[45]||(t[45]=e("h3",{class:"text-lg text-gray-800 font-semibold mb-2"},"No Expense Data Found",-1)),e("p",rl,[h(" No expense data found for the selected years ("+k(o(oe))+" - "+k(o(se))+") in project ",1),e("span",il,k((E=o(z))==null?void 0:E.project_name),1),t[43]||(t[43]=h(". "))]),e("button",{onClick:t[6]||(t[6]=s=>ie.value=!0),class:"mt-4 flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-violet-500 to-violet-600 text-white rounded-lg hover:from-violet-600 hover:to-violet-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[v(o(ee),{class:"w-4 h-4"}),t[44]||(t[44]=h(" Add First Expense "))])])):(l(),ne(Co,{key:5,"from-year":o(oe),"to-year":o(se)},null,8,["from-year","to-year"]))])])])]),v(_e,{name:"fade"},{default:we(()=>[w.value?(l(),a("div",dl,[e("div",ul,[e("div",cl,[v(o(Oe),{class:"w-4 h-4 text-white"}),t[46]||(t[46]=e("h2",{class:"text-xl font-bold text-white"},"Advanced Display Mode Settings",-1))]),e("div",pl,[A.value.length?H("",!0):(l(),a("div",vl,[v(o(Ie),{class:"w-4 h-4 text-yellow-600"}),t[47]||(t[47]=e("span",{class:"text-yellow-800 font-medium"},'Please select both \\"From Year\\" and \\"To Year\\" to configure advanced settings.',-1))])),A.value.length?(l(),a("div",ml,[(l(!0),a(x,null,D(A.value,s=>(l(),a("div",{key:"adv-"+s,class:"flex justify-between items-center border-b pb-2"},[e("span",fl,[v(o(Se),{class:"w-3 h-3 text-violet-600"}),h(" "+k(s),1)]),R(e("select",{"onUpdate:modelValue":b=>f.value[s]=b,class:"px-6 py-2 border rounded-md focus:ring-violet-500"},t[48]||(t[48]=[e("option",{value:"monthly"},"Monthly",-1),e("option",{value:"quarterly"},"Quarterly",-1)]),8,gl),[[B,f.value[s]]])]))),128))])):H("",!0)]),e("div",xl,[e("button",{onClick:rt,class:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 flex items-center gap-2"},[v(o(re),{class:"w-4 h-4"}),t[49]||(t[49]=h(" Cancel "))]),A.value.length?(l(),a("button",{key:0,onClick:nt,class:"px-4 py-2 rounded-md bg-violet-600 text-white hover:bg-violet-700 flex items-center gap-2"},[v(o(Ee),{class:"w-4 h-4"}),t[50]||(t[50]=h(" Apply "))])):H("",!0)])])])):H("",!0)]),_:1}),v(_e,{name:"fade"},{default:we(()=>[o(ie)?(l(),a("div",bl,[e("div",hl,[e("div",yl,[e("div",wl,[v(o(eo),{class:"w-7 h-7 text-white"}),t[51]||(t[51]=e("div",null,[e("h2",{class:"text-2xl font-bold text-white"},"Add New Expense"),e("p",{class:"text-violet-100 mt-1 text-sm"},"Enter expense details for the selected period")],-1))]),e("button",{onClick:t[7]||(t[7]=(...s)=>o(ve)&&o(ve)(...s)),class:"text-violet-100 hover:text-white transition-colors p-2 rounded-full hover:bg-violet-600"},[v(o(re),{class:"w-4 h-4"})])]),e("div",_l,[e("div",kl,[e("div",null,[t[53]||(t[53]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Select Year",-1)),R(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>o(Y).year=s),class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[52]||(t[52]=e("option",{disabled:"",value:""},"Choose a year",-1)),(l(!0),a(x,null,D(p.value,s=>(l(),a("option",{key:"add-year-"+s,value:s},k(s),9,Sl))),128))],512),[[B,o(Y).year]])]),e("div",null,[t[55]||(t[55]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Select Month/Quarter",-1)),R(e("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>o(Y).month=s),class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[54]||(t[54]=e("option",{disabled:"",value:""},"Choose a month/quarter",-1)),(l(!0),a(x,null,D(o(zt),s=>(l(),a("option",{key:"add-month-"+s,value:s},k(s),9,El))),128))],512),[[B,o(Y).month]])])]),e("div",Cl,[e("button",{onClick:t[10]||(t[10]=s=>te.value=!te.value),class:"w-full flex items-center justify-between p-4 bg-gradient-to-r from-violet-50 to-violet-100 border border-violet-200 rounded-lg hover:from-violet-100 hover:to-violet-200 transition-all duration-200"},[e("div",jl,[e("div",Dl,[v(o(ee),{class:"w-4 h-4 text-white"})]),t[56]||(t[56]=e("span",{class:"text-lg font-semibold text-violet-800"},"Quick Actions",-1))]),v(o(Pe),{class:Le(["w-5 h-5 text-violet-600 transition-transform duration-200",te.value?"rotate-180":""])},null,8,["class"])]),R(e("div",Al,[e("div",null,[e("div",Fl,[v(o(fe),{class:"w-5 h-5 text-violet-600"}),t[57]||(t[57]=e("span",{class:"text-md font-semibold text-gray-700"},"Create New Expense",-1))]),e("div",Tl,[R(e("input",{"onUpdate:modelValue":t[11]||(t[11]=s=>S.value.account_name=s),type:"text",placeholder:"Account Name",class:"px-4 py-2 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},null,512),[[ke,S.value.account_name]]),R(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>S.value.account_number=s),type:"text",placeholder:"Account Number",class:"px-4 py-2 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white",onKeypress:ft,onPaste:gt,onInput:xt},null,544),[[ke,S.value.account_number]]),R(e("select",{"onUpdate:modelValue":t[13]||(t[13]=s=>S.value.parent_account=s),class:"px-4 py-2 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[58]||(t[58]=e("option",{value:""},"Parent Account",-1)),(l(!0),a(x,null,D(X.value,s=>(l(),a("option",{key:s,value:s},k(s),9,Yl))),128))],512),[[B,S.value.parent_account]]),e("button",{disabled:T.value||!S.value.account_name.trim()||!S.value.account_number.trim()||!S.value.parent_account,onClick:mt,class:"px-4 py-2 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-all font-medium flex items-center justify-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed"},[v(o(ee),{class:"w-4 h-4"}),t[59]||(t[59]=h(" Create Account "))],8,Vl)])])],512),[[$e,te.value]])]),e("div",Rl,[t[69]||(t[69]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-1 h-6 bg-gradient-to-b from-violet-500 to-violet-600 rounded-full"}),e("h3",{class:"text-lg font-semibold text-gray-800"},"Expense Items")],-1)),e("div",Nl,[(l(!0),a(x,null,D(o(Y).rows,(s,b)=>(l(),a("div",{key:"expense-row-"+b,class:"bg-white hover:border-violet-200 rounded-lg p-6 hover:shadow-md border-2 transition-all"},[e("div",Ll,[e("h4",$l,"Expense Entry "+k(b+1),1),e("button",{onClick:d=>o(Lt)(b),disabled:o(Y).rows.length===1,class:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove entry"},[v(o(Zt),{class:"w-5 h-5"})],8,Ul)]),e("div",Ml,[e("div",null,[t[61]||(t[61]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Department",-1)),R(e("select",{"onUpdate:modelValue":d=>s.department=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[60]||(t[60]=e("option",{disabled:"",value:""},"Select Department",-1)),(l(!0),a(x,null,D(ae.value,d=>(l(),a("option",{key:d,value:d},k(d),9,Ol))),128))],8,Il),[[B,s.department]])]),e("div",null,[t[63]||(t[63]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Department Location",-1)),R(e("select",{"onUpdate:modelValue":d=>s.department_location=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[62]||(t[62]=e("option",{disabled:"",value:""},"Select Department Location",-1)),(l(!0),a(x,null,D(Z.value,d=>(l(),a("option",{key:d,value:d},k(d),9,Bl))),128))],8,Pl),[[B,s.department_location]])]),e("div",null,[t[65]||(t[65]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Expense Name",-1)),R(e("select",{"onUpdate:modelValue":d=>s.expense=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[64]||(t[64]=e("option",{disabled:"",value:""},"Select expense",-1)),(l(!0),a(x,null,D(j.value,d=>(l(),a("option",{key:d.value,value:d.value},k(d.label),9,ql))),128))],8,zl),[[B,s.expense]])]),e("div",null,[t[67]||(t[67]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cost Type",-1)),R(e("select",{"onUpdate:modelValue":d=>s.costType=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[66]||(t[66]=e("option",{disabled:"",value:""},"Select Cost Type",-1)),(l(!0),a(x,null,D(L.value,d=>(l(),a("option",{key:d.value,value:d.value},k(d.label),9,Wl))),128))],8,Kl),[[B,s.costType]])]),e("div",null,[t[68]||(t[68]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Amount",-1)),R(e("input",{type:"text","onUpdate:modelValue":d=>s.amountDisplay=d,onKeypress:t[14]||(t[14]=(...d)=>o(Ke)&&o(Ke)(...d)),onInput:d=>ut(b,d),onBlur:d=>ct(b),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-left",placeholder:"0.00"},null,40,Hl),[[ke,s.amountDisplay]])])])]))),128))])]),e("div",Ql,[e("button",{onClick:t[15]||(t[15]=(...s)=>o(ze)&&o(ze)(...s)),class:"flex items-center gap-2 px-4 py-2 bg-violet-500 text-white rounded-lg hover:bg-violet-600 transition-all font-medium"},[v(o(ee),{class:"w-5 h-5"}),t[70]||(t[70]=h(" Add Row "))]),e("div",Jl,[e("button",{onClick:t[16]||(t[16]=(...s)=>o(ve)&&o(ve)(...s)),class:"px-6 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium flex items-center gap-2"},[v(o(re),{class:"w-5 h-5"}),t[71]||(t[71]=h(" Cancel "))]),e("button",{onClick:pt,class:"px-6 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-all font-medium flex items-center gap-2"},[v(o(Ee),{class:"w-5 h-5"}),t[72]||(t[72]=h(" Submit "))])])])])])])):H("",!0)]),_:1}),v(At,{"is-visible":xe.value,onClose:ht},null,8,["is-visible"])],64)}}},wa=De(Xl,[["__scopeId","data-v-1ed85d07"]]);export{wa as default};
