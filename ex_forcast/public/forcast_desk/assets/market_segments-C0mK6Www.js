var f=(e,o,t)=>new Promise((r,a)=>{var n=i=>{try{s(t.next(i))}catch(c){a(c)}},g=i=>{try{s(t.throw(i))}catch(c){a(c)}},s=i=>i.done?r(i.value):Promise.resolve(i.value).then(n,g);s((t=t.apply(e,o)).next())});import{s as S}from"./projectService-Cz5ZqhwS.js";import{h as v}from"./index-FWH8FmVo.js";function A(){return f(this,null,function*(){try{const e=S.value;if(!e)return{status:"no_project_selected",message:"No project selected"};const r=(yield(yield fetch(`/api/v2/method/ex_forcast.api.room_revenue_display.room_revenue_display?project=${encodeURIComponent(e.project_name)}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json()).data||{};return Object.keys(r).length>0?r:{status:"no_data",message:`No room revenue data found for project: ${e.project_name}`,project:e.project_name}}catch(e){return console.error("Error fetching room revenue data:",e),{status:"error",message:"Failed to load room revenue data"}}})}function P(e){return f(this,null,function*(){try{console.log("Creating segment category:",e);const o=new URLSearchParams;o.append("category_name",e);const t=yield fetch("/api/v2/method/ex_forcast.api.segment_category_api.create_segment_category",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o});if(!t.ok){const a=yield t.text();throw console.error("API Error Response:",a),new Error(`API call failed with status ${t.status}: ${a}`)}const r=yield t.json();return console.log("Segment Category creation response:",r),r}catch(o){throw console.error("Error creating segment category:",o),o}})}function j(){return f(this,null,function*(){try{const e=yield fetch("/api/v2/method/ex_forcast.api.segment_category_api.get_segment_categories",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){const t=yield e.text();throw console.error("API Error Response:",t),new Error(`API call failed with status ${e.status}: ${t}`)}return yield e.json()}catch(e){throw console.error("Error fetching segment categories:",e),e}})}function C(){return f(this,null,function*(){try{const e=yield fetch("/api/v2/method/ex_forcast.api.segment_category_api.get_default_segment_categories",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){const t=yield e.text();throw console.error("API Error Response:",t),new Error(`API call failed with status ${e.status}: ${t}`)}const o=yield e.json();return console.log("Default Segment Categories response:",o),o}catch(e){throw console.error("Error fetching default segment categories:",e),e}})}function I(e){return f(this,null,function*(){try{console.log("Deleting segment category:",e);const o=new URLSearchParams;o.append("category_name",e);const t=yield fetch("/api/v2/method/ex_forcast.api.segment_category_api.delete_segment_category",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o});if(!t.ok){const a=yield t.text();throw console.error("API Error Response:",a),new Error(`API call failed with status ${t.status}: ${a}`)}const r=yield t.json();return console.log("Segment Category deletion response:",r),r}catch(o){throw console.error("Error deleting segment category:",o),o}})}function M(e){return f(this,null,function*(){try{const o=S.value;if(!o)throw new Error("No project selected. Please select a project first.");const t=new URLSearchParams;t.append("changes",JSON.stringify(e)),t.append("project",o.project_name);const r=yield fetch("/api/v2/method/ex_forcast.api.room_revenue_display.upsert_room_revenue_items",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});if(!r.ok){const n=yield r.text();throw console.error("Room revenue API Error Response:",n),new Error(`API call failed with status ${r.status}: ${n}`)}return yield r.json()}catch(o){throw console.error("Error saving room revenue changes:",o),o}})}function x(e,o){return f(this,null,function*(){try{console.log("Creating room market segment:",e,"in category:",o);const t=new URLSearchParams;t.append("market_segment",e),t.append("segment_category",o);const r=yield fetch("/api/v2/method/ex_forcast.api.room_market_segment_api.create_room_market_segment",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});if(!r.ok){const n=yield r.text();throw console.error("API Error Response:",n),new Error(`API call failed with status ${r.status}: ${n}`)}const a=yield r.json();return console.log("Room Market Segment creation response:",a),a}catch(t){throw console.error("Error creating room market segment:",t),t}})}function D(){return f(this,null,function*(){try{const e=yield fetch("/api/v2/method/ex_forcast.api.room_market_segment_api.get_room_market_segments",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){const t=yield e.text();throw console.error("API Error Response:",t),new Error(`API call failed with status ${e.status}: ${t}`)}return yield e.json()}catch(e){throw console.error("Error fetching room market segments:",e),e}})}function U(){return f(this,null,function*(){try{const e=yield fetch("/api/v2/method/ex_forcast.api.room_market_segment_api.get_default_room_market_segments",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){const t=yield e.text();throw console.error("API Error Response:",t),new Error(`API call failed with status ${e.status}: ${t}`)}const o=yield e.json();return console.log("Default Room Market Segments response:",o),o}catch(e){throw console.error("Error fetching default room market segments:",e),e}})}function N(e){return f(this,null,function*(){try{console.log("Deleting room market segment:",e);const o=new URLSearchParams;o.append("market_segment",e);const t=yield fetch("/api/v2/method/ex_forcast.api.room_market_segment_api.delete_room_market_segment",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o});if(!t.ok){const a=yield t.text();throw console.error("API Error Response:",a),new Error(`API call failed with status ${t.status}: ${a}`)}const r=yield t.json();return console.log("Room Market Segment deletion response:",r),r}catch(o){throw console.error("Error deleting room market segment:",o),o}})}function G(){return f(this,null,function*(){try{const e=S.value;if(!e)return{status:"no_project_selected",message:"No project selected"};const r=(yield(yield fetch(`/api/v2/method/ex_forcast.api.room_revenue_display.market_segment_display?project=${encodeURIComponent(e.project_name)}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json()).data||{};return Object.keys(r).length>0?r:{status:"no_data",message:`No market segment data found for project: ${e.project_name}`,project:e.project_name}}catch(e){return console.error("Error fetching market segment data:",e),{status:"error",message:"Failed to load market segment data"}}})}function L(e){return f(this,null,function*(){try{const o=S.value;if(!o)throw new Error("No project selected. Please select a project first.");const t=new URLSearchParams;t.append("changes",JSON.stringify(e)),t.append("project",o.project_name);const r=yield fetch("/api/v2/method/ex_forcast.api.room_revenue_display.upsert_market_segment_items",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t});if(!r.ok){const n=yield r.text();throw console.error("API Error Response:",n),new Error(`API call failed with status ${r.status}: ${n}`)}return yield r.json()}catch(o){throw console.error("Error saving market segment changes:",o),o}})}const J=Object.freeze(Object.defineProperty({__proto__:null,createRoomMarketSegment:x,createSegmentCategory:P,deleteRoomMarketSegment:N,deleteSegmentCategory:I,getDefaultRoomMarketSegments:U,getDefaultSegmentCategories:C,getMarketSegmentList:G,getRoomMarketSegments:D,getRoomRevenueList:A,getSegmentCategories:j,saveMarketSegmentChanges:L,saveRoomRevenueChanges:M},Symbol.toStringTag,{value:"Module"})),k=["Standard","Superior","Deluxe","Suite","Presidential"];let b=[...k];function V(e){if(e&&e.length>0){const o=[...k];e.forEach(t=>{const r=t.package_name||t.name;k.includes(r)||o.push(r)}),b=o}else b=[...k]}const R=v(new Set);function H(e){R.value.has(e)?R.value.delete(e):R.value.add(e)}function B(e){return R.value.has(e)}function W(e,o){if(!e||!o)return[];const t=parseInt(e),r=parseInt(o);if(t>r)return[];const a=[];for(let n=t;n<=r;n++)a.push(n.toString());return a}function T(e="monthly"){return e==="quarterly"?["Jan-Mar","Apr-Jun","Jul-Sep","Oct-Dec"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}const p={"Jan-Mar":["Jan","Feb","Mar"],"Apr-Jun":["Apr","May","Jun"],"Jul-Sep":["Jul","Aug","Sep"],"Oct-Dec":["Oct","Nov","Dec"]};function _(e,o){const r={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11}[o];return r===void 0?0:new Date(parseInt(e),r+1,0).getDate()}function w(e,o,t,r,a="monthly"){var n,g;if(a==="quarterly"&&p[r]){const s={number_of_rooms:0,rate:0,occupied_beds:0,count:0};for(const i of p[r]){const u=(((n=e==null?void 0:e[t])==null?void 0:n[i])||[]).find(l=>l.room_package===o);u&&(s.number_of_rooms+=parseFloat(u.number_of_rooms)||0,s.rate+=parseFloat(u.rate)||0,s.occupied_beds+=parseFloat(u.occupied_beds)||0,s.count++)}return s.count>0?{number_of_rooms:s.number_of_rooms/s.count,rate:s.rate/s.count,occupied_beds:s.occupied_beds/s.count}:{number_of_rooms:0,rate:0,occupied_beds:0}}else{const i=(((g=e==null?void 0:e[t])==null?void 0:g[r])||[]).find(c=>c.room_package===o);return i?{number_of_rooms:parseFloat(i.number_of_rooms)||0,rate:parseFloat(i.rate)||0,occupied_beds:parseFloat(i.occupied_beds)||0}:{number_of_rooms:0,rate:0,occupied_beds:0}}}function E(e,o="number"){return o==="percentage"?e.toFixed(1)+"%":o==="currency"?e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):e.toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:0})}function Y(e,o,t,r,a="monthly",n=[]){w(e,o,t,r,a);const g=O(n,o,e);if(a==="quarterly"&&p[r]){let s=0;for(const c of p[r])s+=_(t,c);const i=g*s;return E(i,"number")}else{const s=_(t,r),i=g*s;return E(i,"number")}}function z(e,o,t,r,a="monthly"){const n=w(e,o,t,r,a);return E(n.occupied_beds,"percentage")}function K(e,o,t,r,a="monthly"){const n=w(e,o,t,r,a);return E(n.rate,"currency")}function Q(e,o,t,r,a="monthly",n=[]){const g=w(e,o,t,r,a),s=O(n,o,e);let i;if(a==="quarterly"&&p[r]){let u=0;for(const l of p[r])u+=_(t,l);i=s*u}else{const u=_(t,r);i=s*u}const c=i*(g.occupied_beds/100)*g.rate;return E(c,"currency")}function X(e,o,t,r,a="revenue",n=[]){const g=T(r);let s=0;for(const c of g){let u=0;const l=w(e,o,t,c,r),d=O(n,o,e);switch(a){case"available_beds":if(r==="quarterly"&&p[c]){let m=0;for(const y of p[c])m+=_(t,y);u=d*m}else{const m=_(t,c);u=d*m}break;case"occupied_beds":u=l.occupied_beds;break;case"rate":u=l.rate;break;case"revenue":let h;if(r==="quarterly"&&p[c]){let m=0;for(const y of p[c])m+=_(t,y);h=d*m}else{const m=_(t,c);h=d*m}u=h*(l.occupied_beds/100)*l.rate;break}s+=u}return E(s,a==="occupied_beds"?"percentage":a==="rate"||a==="revenue"?"currency":"number")}function Z(e,o,t,r,a="revenue",n=[]){let g=0,s=0;for(const c of b){const u=w(e,c,o,t,r),l=O(n,c,e);let d=0;switch(a){case"available_beds":if(r==="quarterly"&&p[t]){let m=0;for(const y of p[t])m+=_(o,y);d=l*m}else{const m=_(o,t);d=l*m}break;case"occupied_beds":d=u.occupied_beds;break;case"rate":d=u.rate;break;case"revenue":let h;if(r==="quarterly"&&p[t]){let m=0;for(const y of p[t])m+=_(o,y);h=l*m}else{const m=_(o,t);h=l*m}d=h*(u.occupied_beds/100)*u.rate;break}g+=d,s++}return(a==="occupied_beds"||a==="rate")&&(g=s>0?g/s:0),E(g,a==="occupied_beds"?"percentage":a==="rate"||a==="revenue"?"currency":"number")}function ee(e,o,t,r="revenue",a=[]){let n=0;for(const s of b){const i=T(t);for(const c of i){const u=w(e,s,o,c,t),l=O(a,s,e);let d=0;switch(r){case"available_beds":if(t==="quarterly"&&p[c]){let m=0;for(const y of p[c])m+=_(o,y);d=l*m}else{const m=_(o,c);d=l*m}break;case"occupied_beds":d=u.occupied_beds;break;case"rate":d=u.rate;break;case"revenue":let h;if(t==="quarterly"&&p[c]){let m=0;for(const y of p[c])m+=_(o,y);h=l*m}else{const m=_(o,c);h=l*m}d=h*(u.occupied_beds/100)*u.rate;break}n+=d}}return E(n,r==="occupied_beds"?"percentage":r==="rate"||r==="revenue"?"currency":"number")}function O(e,o,t=null){if(t&&t.room_packages){const a=t.room_packages.find(n=>n.name===o);if(a)return a.number_of_rooms}const r=e.find(a=>a.name===o);return r?r.number_of_rooms:0}const te=[{market_segment:"NO-SHOW /DAY USE / EXTRA BED / LATE CHECK OUT",segment_category:"OTHER ROOMS REVENUE"},{market_segment:"HOUSE USE ROOMS",segment_category:"OTHER ROOMS REVENUE"},{market_segment:"COMPLIMENTERY ROOMS",segment_category:"OTHER ROOMS REVENUE"},{market_segment:"Long Term Stays",segment_category:"CONTRACT ROOMS REVENUE"},{market_segment:"Crew",segment_category:"CONTRACT ROOMS REVENUE"},{market_segment:"Groups S.M.E.R.F",segment_category:"GROUP ROOMS REVENUE"},{market_segment:"Groups Tours / Wholesalers",segment_category:"GROUP ROOMS REVENUE"},{market_segment:"Groups Sports",segment_category:"GROUP ROOMS REVENUE"},{market_segment:"Groups Association / Conventions / Events",segment_category:"GROUP ROOMS REVENUE"},{market_segment:"Groups Government",segment_category:"GROUP ROOMS REVENUE"},{market_segment:"Groups Corporate",segment_category:"GROUP ROOMS REVENUE"},{market_segment:"Transient Tours / Travel",segment_category:"WHOLESALE"},{market_segment:"Wholesale Allotment / Static",segment_category:"WHOLESALE"},{market_segment:"Wholesale Dynamic",segment_category:"WHOLESALE"},{market_segment:"TMC / Consortia",segment_category:"NEGOTIATED (CORPORATE)"},{market_segment:"Government Global / Local",segment_category:"NEGOTIATED (CORPORATE)"},{market_segment:"Negotiated Local",segment_category:"NEGOTIATED (CORPORATE)"},{market_segment:"Negotiated Global",segment_category:"NEGOTIATED (CORPORATE)"},{market_segment:"Members Discount - Government Mandated",segment_category:"QUALIFIED"},{market_segment:"Staff Rate Discount / Management Discretion Discount",segment_category:"QUALIFIED"},{market_segment:"Loyalty",segment_category:"DISCOUNT"},{market_segment:"Hotel Discount",segment_category:"DISCOUNT"},{market_segment:"OTA Promotion / OTA Package",segment_category:"DISCOUNT"},{market_segment:"Local Promotion",segment_category:"DISCOUNT"},{market_segment:"Global Promotion",segment_category:"DISCOUNT"},{market_segment:"OTA Retail",segment_category:"RETAIL"},{market_segment:"Direct Retail",segment_category:"RETAIL"}];//! Function To Get Average Daily Rate Calculation
function oe(e,o,t,r){return!e>0?0:(e*(1+o/100)+t)*r}export{oe as A,te as M,b as R,D as a,x as b,P as c,I as d,N as e,C as f,j as g,U as h,G as i,_ as j,A as k,W as l,T as m,B as n,Y as o,X as p,Z as q,ee as r,z as s,H as t,V as u,K as v,Q as w,O as x,L as y,J as z};
