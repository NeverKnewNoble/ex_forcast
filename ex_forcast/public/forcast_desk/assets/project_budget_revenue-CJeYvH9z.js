var S=(g,e,r)=>new Promise((o,l)=>{var p=f=>{try{u(r.next(f))}catch(v){l(v)}},m=f=>{try{u(r.throw(f))}catch(v){l(v)}},u=f=>f.done?o(f.value):Promise.resolve(f.value).then(p,m);u((r=r.apply(g,e)).next())});import{_ as nt,c as k,i as B,o as j,b as t,e as b,u as x,F as K,x as z,v as w,E as R,h as F,l as I,m as St,n as Ct,p as Tt,q as st,t as H,j as rt,w as Dt,B as D,d as _,O as $t,T as Ut,C as U,N as Ft,a as Et}from"./index-DFp4WPHj.js";import{X as At,_ as Ot,W as X,T as Nt,b as Rt,R as Vt,h as Bt,d as Lt,c as C}from"./SettingsModal-D-D5AQet.js";import{c as lt}from"./createLucideIcon-D8X7RiyU.js";import{C as Mt}from"./chevron-left-Ct-jXL2q.js";import{a as It,C as Ht}from"./circle-alert-CbaxY-0D.js";import{S as qt}from"./save-CWxizgNn.js";import{L as Kt}from"./loader-circle-jaT7itjR.js";import{P as ot}from"./plus-Q6-mjf1P.js";import{C as Jt}from"./chart-column-CDQ4xrd1.js";import{T as at}from"./trash-yDZuAIRr.js";import"./zap-BeFUdqHw.js";/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=lt("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=lt("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),zt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},Wt={class:"relative z-10 w-full max-w-md bg-white rounded-xl shadow-2xl border border-violet-200"},Gt={class:"px-5 py-4 border-b border-gray-200 flex items-center justify-between"},Yt={class:"flex items-center gap-2"},Qt={class:"p-5 space-y-4"},Zt=["value"],te={key:0,class:"mt-2 text-xs text-amber-700 bg-amber-50 border border-amber-200 px-2 py-1 rounded"},ee=["value"],se=["value"],re={class:"px-5 py-4 border-t border-gray-200 flex items-center justify-end gap-2 bg-gray-50 rounded-b-xl"},oe={__name:"NewProjectModal",props:{isVisible:{type:Boolean,default:!1},newProjectName:{type:String,default:""},availableProjects:{type:Array,default:()=>[]},selectedExistingProject:{type:String,default:""},duplicateProject:{type:Boolean,default:!1}},emits:["close","confirm","refresh","update:newProjectName","update:selectedExistingProject"],setup(g){return(e,r)=>g.isVisible?(j(),k("div",zt,[r[10]||(r[10]=t("div",{class:"absolute inset-0 bg-black/30"},null,-1)),t("div",Wt,[t("div",Gt,[t("div",Yt,[b(x(W),{class:"w-5 h-5 text-violet-600"}),r[6]||(r[6]=t("h3",{class:"text-base font-semibold text-gray-800"},"Create or Add Existing Project",-1))]),t("button",{onClick:r[0]||(r[0]=o=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600"},[b(x(At),{class:"w-5 h-5"})])]),t("div",Qt,[t("div",null,[r[7]||(r[7]=t("label",{class:"text-sm font-medium text-gray-700"},"Create Your Project",-1)),t("input",{value:g.newProjectName,onInput:r[1]||(r[1]=o=>e.$emit("update:newProjectName",o.target.value)),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-transparent",placeholder:"Type a new name or select existing"},null,40,Zt),g.duplicateProject?(j(),k("p",te,"A project with this name already exists. Please select it below.")):B("",!0)]),t("div",null,[r[9]||(r[9]=t("label",{class:"text-sm font-medium text-gray-700"},"Select Existing Project",-1)),t("select",{value:g.selectedExistingProject,onChange:r[2]||(r[2]=o=>e.$emit("update:selectedExistingProject",o.target.value)),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-transparent bg-white"},[r[8]||(r[8]=t("option",{value:""},"-- Select a project --",-1)),(j(!0),k(K,null,z(g.availableProjects,o=>(j(),k("option",{key:o.name,value:o.name},w(o.project_name),9,se))),128))],40,ee),t("button",{onClick:r[3]||(r[3]=o=>e.$emit("refresh")),class:"mt-2 text-xs text-violet-700 hover:text-violet-900 underline",type:"button"},"Refresh list")])]),t("div",re,[t("button",{onClick:r[4]||(r[4]=o=>e.$emit("close")),class:"px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100"},"Cancel"),t("button",{onClick:r[5]||(r[5]=o=>e.$emit("confirm")),class:"px-4 py-2 rounded-md bg-gradient-to-r from-violet-600 to-violet-700 text-white hover:from-violet-700 hover:to-violet-800"},"Add")])])])):B("",!0)}},ae=nt(oe,[["__scopeId","data-v-74cd7ed6"]]),ne=["Not Started","In Progress","Complete","Needs Review","Approved","Overdue","On Hold"];class L{constructor(e={}){this.id=e.id||null,this.task=e.task||"",this.project_name=e.project_name||"",this.isSubtask=e.isSubtask||!1,this.description=e.description||"",this.status=e.status||"Not Started",this.plannedStartDate=e.plannedStartDate||"",this.actualStartDate=e.actualStartDate||"",this.endDate=e.endDate||"",this.hr=parseFloat(e.hr)||0,this.ratePerHr=parseFloat(e.ratePerHr)||0,this.units=parseFloat(e.units)||0,this.ratePerUnit=parseFloat(e.ratePerUnit)||0,this.travel=parseFloat(e.travel)||0,this.equipment=parseFloat(e.equipment)||0,this.misc=parseFloat(e.misc)||0,this.budget=parseFloat(e.budget)||0,this._addComputedProperties()}_addComputedProperties(){Object.defineProperty(this,"totalLabor",{get(){return this.hr*this.ratePerHr},enumerable:!0,configurable:!0}),Object.defineProperty(this,"totalMaterials",{get(){return this.units*this.ratePerUnit},enumerable:!0,configurable:!0}),Object.defineProperty(this,"actual",{get(){return this.totalLabor+this.totalMaterials+this.travel+this.equipment+this.misc},enumerable:!0,configurable:!0}),Object.defineProperty(this,"underOver",{get(){return this.actual-this.budget},enumerable:!0,configurable:!0})}validate(){const e=[];return this.task.trim()||e.push("Task name is required"),this.hr<0&&e.push("Labor hours cannot be negative"),this.ratePerHr<0&&e.push("Rate per hour cannot be negative"),this.units<0&&e.push("Material units cannot be negative"),this.ratePerUnit<0&&e.push("Rate per unit cannot be negative"),this.travel<0&&e.push("Travel cost cannot be negative"),this.equipment<0&&e.push("Equipment cost cannot be negative"),this.misc<0&&e.push("Miscellaneous cost cannot be negative"),this.budget<0&&e.push("Budget amount cannot be negative"),ne.includes(this.status)||e.push("Invalid task status"),e}toApiFormat(){return{id:this.id,task:this.task,project_name:this.project_name,description:this.description,status:this.status,plannedStartDate:this.plannedStartDate,actualStartDate:this.actualStartDate,endDate:this.endDate,hr:this.hr,ratePerHr:this.ratePerHr,units:this.units,ratePerUnit:this.ratePerUnit,travel:this.travel,equipment:this.equipment,misc:this.misc,budget:this.budget}}static fromApiData(e){return new L(e)}static createEmpty(){return new L}}class A{constructor(e={}){this.id=e.id,this.name=e.name||"",this.totalBudget=parseFloat(e.total_budget)||0,this.totalActual=parseFloat(e.total_actual)||0,this.variance=parseFloat(e.variance)||0,this.tasks=(e.tasks||[]).map(r=>r instanceof L?r:new L(r)),this._addComputedProperties()}_addComputedProperties(){Object.defineProperty(this,"subtotalLabor",{get(){return this.tasks.reduce((e,r)=>e+r.totalLabor,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalMaterials",{get(){return this.tasks.reduce((e,r)=>e+r.totalMaterials,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalTravel",{get(){return this.tasks.reduce((e,r)=>e+r.travel,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalEquipment",{get(){return this.tasks.reduce((e,r)=>e+r.equipment,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalMisc",{get(){return this.tasks.reduce((e,r)=>e+r.misc,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalBudget",{get(){return this.tasks.reduce((e,r)=>e+r.budget,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalActual",{get(){return this.subtotalLabor+this.subtotalMaterials+this.subtotalTravel+this.subtotalEquipment+this.subtotalMisc},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalUnderOver",{get(){return this.subtotalActual-this.subtotalBudget},enumerable:!0,configurable:!0})}addTask(e={}){e.id||(e.id=`task-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),e.project_name||(e.project_name=this.tasks.length>0&&this.tasks[0].project_name?this.tasks[0].project_name:this.name);const r=new L(e);return this.tasks.push(r),r}removeTask(e){const r=this.tasks.findIndex(o=>o.id===e);return r>-1?this.tasks.splice(r,1)[0]:null}getTask(e){return this.tasks.find(r=>r.id===e)}validate(){const e=[];return this.name.trim()||e.push("Project name is required"),this.tasks.forEach((r,o)=>{const l=r.validate();l.length>0&&e.push(`Task ${o+1}: ${l.join(", ")}`)}),e}toApiFormat(){const e=this.id&&this.id.startsWith("project-")&&this.id.includes("-"),r=this.tasks.length>0&&this.tasks[0].project_name?this.tasks[0].project_name:this.name;return{project_id:e?null:this.id,project_name:r,tasks:this.tasks.map(o=>o.toApiFormat())}}static fromApiData(e){return new A(e)}static createEmpty(e=""){const r=`project-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,o=new A({id:r,name:e});return o.addTask(),o}}class le{constructor(e={}){this.projectCount=e.project_count||0,this.taskCount=e.task_count||0,this.totalBudget=parseFloat(e.total_budget)||0,this.totalActual=parseFloat(e.total_actual)||0,this.totalVariance=parseFloat(e.total_variance)||0}get variancePercentage(){return this.totalBudget===0?0:this.totalVariance/this.totalBudget*100}get isOverBudget(){return this.totalVariance>0}get budgetUtilization(){return this.totalBudget===0?0:this.totalActual/this.totalBudget*100}}const ie={formatCurrency(g){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(g||0)},formatNumber(g){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(g||0)},calculatePercentage(g,e){return e===0?0:g/e*100},validateDateRange(g,e){return!g||!e?!0:new Date(g)<=new Date(e)},getStatusColor(g){return{"Not Started":"gray","In Progress":"blue",Complete:"green","Needs Review":"yellow",Approved:"green",Overdue:"red","On Hold":"orange"}[g]||"gray"},sortTasksByStatus(g){const e={Overdue:1,"In Progress":2,"Needs Review":3,"On Hold":4,"Not Started":5,Approved:6,Complete:7};return[...g].sort((r,o)=>{const l=e[r.status]||999,p=e[o.status]||999;return l-p})}},E={baseUrl:"/api/method/ex_forcast.api.construction_budget_api",endpoints:{display:"construction_budget_display",upsert:"upsert_construction_budget",delete:"delete_construction_budget_project",summary:"get_construction_budget_summary",listProjects:"list_projects"}};class de{constructor(){this.projects=[],this.isLoading=!1,this.error=null,this.lastSync=null,this.cachedProjectOptions=[]}fetchData(e=null){return S(this,null,function*(){try{this.isLoading=!0,this.error=null;const r=`${E.baseUrl}.${E.endpoints.display}?project=${e||""}`,o=yield fetch(r,{headers:{"X-Frappe-CSRF-Token":R()}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const l=yield o.json(),p=l.message||l;if(p.success)return this.projects=p.data.map(m=>{const u=A.fromApiData(m);return(u.id===null||u.id===void 0)&&(u.id=`project-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),u}),this.lastSync=new Date,this.projects;throw new Error(p.error||"Failed to fetch construction budget data")}catch(r){throw this.error=r.message,console.error("Error fetching construction budget data:",r),r}finally{this.isLoading=!1}})}fetchAvailableProjects(e="",r=100){return S(this,null,function*(){try{const o=`${E.baseUrl}.${E.endpoints.listProjects}?search=${encodeURIComponent(e)}&limit=${r}`,p=yield(yield fetch(o,{headers:{"X-Frappe-CSRF-Token":R()}})).json(),m=p.message||p;if(!m.success)throw new Error(m.error||"Failed to load projects");return this.cachedProjectOptions=m.data||[],this.cachedProjectOptions}catch(o){throw console.error("Failed to fetch available Projects:",o),o}})}saveData(e,r=null){return S(this,null,function*(){try{this.isLoading=!0,this.error=null;const o=[];if(e.forEach((v,$)=>{const c=v.validate();c.length>0&&o.push(`Project ${$+1}: ${c.join(", ")}`)}),o.length>0)throw new Error(`Validation failed: ${o.join("; ")}`);const p={changes:e.map(v=>v.toApiFormat()),project:r},u=yield(yield fetch(`${E.baseUrl}.${E.endpoints.upsert}`,{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":R()},body:JSON.stringify(p)})).json(),f=u.message||u;if(f.success)return f.results&&Array.isArray(f.results)&&f.results.forEach((v,$)=>{v.name&&e[$]&&(e[$].id=v.name)}),this.projects=e,this.lastSync=new Date,f.results;throw new Error(f.error||"Failed to save construction budget data")}catch(o){throw this.error=o.message,console.error("Error saving construction budget data:",o),o}finally{this.isLoading=!1}})}deleteProject(e){return S(this,null,function*(){try{this.isLoading=!0,this.error=null;const o=yield(yield fetch(`${E.baseUrl}.${E.endpoints.delete}`,{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":R()},body:JSON.stringify({project_id:e})})).json(),l=o.message||o;if(l.success)return this.projects=this.projects.filter(p=>p.id!==e),this.lastSync=new Date,!0;throw new Error(l.error||"Failed to delete project")}catch(r){throw this.error=r.message,console.error("Error deleting project:",r),r}finally{this.isLoading=!1}})}getSummary(e=null){return S(this,null,function*(){try{const o=yield(yield fetch(`${E.baseUrl}.${E.endpoints.summary}?project=${e||""}`,{headers:{"X-Frappe-CSRF-Token":R()}})).json();if(o.success)return new le(o.data);throw new Error(o.error||"Failed to fetch summary")}catch(r){throw console.error("Error fetching summary:",r),r}})}createProject(e){const r=A.createEmpty(e);return this.projects.push(r),r}addTaskToProject(e,r={}){const o=this.projects.find(l=>l.id===e);if(o)return o.addTask(r);throw new Error("Project not found")}removeTaskFromProject(e,r){const o=this.projects.find(l=>l.id===e);if(o)return o.removeTask(r);throw new Error("Project not found")}getProject(e){return this.projects.find(r=>r.id===e)}getAllProjects(){return this.projects.forEach(e=>{(e.id===null||e.id===void 0)&&(e.id=`project-${Date.now()}-${Math.random().toString(36).substr(2,9)}`)}),this.projects}getTotals(){const e=this.projects.filter(m=>m.tasks&&m.tasks.length>0),r=e.reduce((m,u)=>m+u.tasks.length,0),o=e.reduce((m,u)=>m+u.subtotalBudget,0),l=e.reduce((m,u)=>m+u.subtotalActual,0),p=l-o;return{totalTasks:r,totalBudget:o,totalActual:l,totalVariance:p}}exportData(e="json"){switch(e.toLowerCase()){case"json":return JSON.stringify(this.projects,null,2);case"csv":return this._exportToCSV();case"excel":return this._exportToExcel();default:throw new Error(`Unsupported export format: ${e}`)}}_exportToCSV(){const r=[["Project Name","Task Name","Description","Status","Planned Start Date","Actual Start Date","End Date","Labor Hours","Rate per Hour","Total Labor Cost","Material Units","Rate per Unit","Total Material Cost","Travel Cost","Equipment Cost","Miscellaneous Cost","Budget Amount","Actual Cost","Under/Over Budget"].join(",")];return this.projects.forEach(o=>{o.tasks.forEach(l=>{const p=[`"${o.name}"`,`"${l.task}"`,`"${l.description}"`,`"${l.status}"`,l.plannedStartDate,l.actualStartDate,l.endDate,l.hr,l.ratePerHr,l.totalLabor,l.units,l.ratePerUnit,l.totalMaterials,l.travel,l.equipment,l.misc,l.budget,l.actual,l.underOver];r.push(p.join(","))})}),r.join(`
`)}_exportToExcel(){return this._exportToCSV()}importData(e,r="json"){try{let o=[];switch(r.toLowerCase()){case"json":o=JSON.parse(e).map(l=>A.fromApiData(l));break;case"csv":o=this._importFromCSV(e);break;default:throw new Error(`Unsupported import format: ${r}`)}return o.forEach((l,p)=>{const m=l.validate();if(m.length>0)throw new Error(`Import validation failed for project ${p+1}: ${m.join(", ")}`)}),this.projects=o,o}catch(o){throw console.error("Error importing data:",o),o}}_importFromCSV(e){const r=e.split(`
`),o=r[0].split(",").map(p=>p.replace(/"/g,"").trim()),l=new Map;for(let p=1;p<r.length;p++){const m=r[p].split(",").map(c=>c.replace(/"/g,"").trim()),u={};o.forEach((c,J)=>{u[c]=m[J]||""});const f=u["Project Name"];l.has(f)||l.set(f,A.createEmpty(f));const v=l.get(f),$={task:u["Task Name"],description:u.Description,status:u.Status,plannedStartDate:u["Planned Start Date"],actualStartDate:u["Actual Start Date"],endDate:u["End Date"],hr:parseFloat(u["Labor Hours"])||0,ratePerHr:parseFloat(u["Rate per Hour"])||0,units:parseFloat(u["Material Units"])||0,ratePerUnit:parseFloat(u["Rate per Unit"])||0,travel:parseFloat(u["Travel Cost"])||0,equipment:parseFloat(u["Equipment Cost"])||0,misc:parseFloat(u["Miscellaneous Cost"])||0,budget:parseFloat(u["Budget Amount"])||0};v.addTask($)}return Array.from(l.values())}clearData(){this.projects=[],this.error=null,this.lastSync=null}hasUnsavedChanges(){return!1}testApiConnection(){return S(this,null,function*(){try{const r=yield(yield fetch(`${E.baseUrl}.test_construction_budget_api`,{headers:{"X-Frappe-CSRF-Token":R()}})).json();return(r.message||r).success}catch(e){return console.error("API Test Error:",e),!1}})}getStatus(){return{isLoading:this.isLoading,error:this.error,lastSync:this.lastSync,projectCount:this.projects.length,hasUnsavedChanges:this.hasUnsavedChanges()}}}const N=new de,ue={class:"flex"},ce={class:"flex-1 min-h-screen bg-gradient-to-br from-white to-violet-50"},pe={class:"flex"},me={key:2,class:"text-violet-700 text-sm font-medium dark:text-white"},he={class:"mb-8"},be={class:"flex items-center gap-3 mb-2"},ge={class:"w-12 h-12 bg-gradient-to-br from-violet-500 to-violet-600 rounded-xl flex items-center justify-center shadow-lg"},fe={class:"bg-white rounded-xl p-4 mb-6 border border-gray-200 shadow-sm"},xe={class:"flex items-center justify-between"},ve={class:"flex items-center gap-2"},ye={key:0,class:"flex items-center gap-2 text-sm font-medium text-red-600 bg-red-50 px-3 py-2 rounded-lg border border-red-200"},we={key:1,class:"flex items-center gap-2 text-sm font-medium text-green-600 bg-green-50 px-3 py-2 rounded-lg border border-green-200"},je=["disabled"],_e={key:1,class:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg cursor-not-allowed"},ke={key:0,class:"mt-2 text-xs text-red-500 flex items-center gap-1"},Pe={class:"mb-8"},Se={class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},Ce={class:"flex gap-2"},Te={class:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm"},De={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},$e={class:"space-y-3"},Ue={class:"flex justify-between items-center"},Fe={class:"font-semibold text-violet-600"},Ee={class:"flex justify-between items-center"},Ae={class:"font-semibold text-violet-600"},Oe={class:"flex justify-between items-center"},Ne={class:"font-semibold text-green-600"},Re={class:"flex justify-between items-center"},Ve={class:"font-semibold text-blue-600"},Be={class:"flex justify-between items-center"},Le={class:"flex-1 p-4 min-w-0"},Me={class:"flex items-center gap-2 mb-4"},Ie={class:"w-6 h-6 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},He={key:0,class:"bg-white rounded-lg border border-violet-200 shadow-sm p-12"},qe={class:"text-center"},Ke={class:"w-24 h-24 bg-gradient-to-br from-violet-100 to-violet-200 rounded-full flex items-center justify-center mx-auto mb-6"},Je={key:1,class:"bg-white rounded-2xl border border-gray-200 shadow-xl overflow-hidden md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px] dark:bg-gray-800 dark:border-gray-600"},Xe={class:"overflow-x-auto max-w-[100%] md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px]"},ze={class:"min-w-full"},We={class:"w-full"},Ge={class:"bg-white divide-y divide-gray-100"},Ye={class:"bg-gradient-to-r from-slate-50 to-gray-50 border-b-2 border-slate-200 hover:from-slate-100 hover:to-gray-100 transition-all duration-200"},Qe={class:"px-6 py-4 text-sm text-slate-800",colspan:18},Ze={class:"flex items-center justify-between"},ts={class:"flex items-center gap-3 text-black"},es=["value","onInput"],ss={class:"flex items-center gap-2"},rs=["onClick"],os=["onClick"],as=["onDragstart","onDrop"],ns={class:"p-0 text-sm"},ls={class:"flex items-center gap-2 pr-2"},is={class:"cursor-grab text-gray-400 hover:text-gray-600 active:cursor-grabbing px-2"},ds=["onUpdate:modelValue","onBlur"],us=["onClick"],cs={class:"p-0 text-sm text-gray-600"},ps=["onUpdate:modelValue"],ms={class:"p-0 text-sm"},hs=["onUpdate:modelValue"],bs={class:"p-0 text-sm"},gs=["onUpdate:modelValue"],fs={class:"p-0 text-sm"},xs=["onUpdate:modelValue"],vs={class:"p-0 text-sm"},ys=["onUpdate:modelValue"],ws={class:"p-0 text-sm"},js=["onUpdate:modelValue"],_s={class:"p-0 text-sm"},ks=["onUpdate:modelValue"],Ps={class:"px-2 py-3 text-sm font-medium text-violet-700 text-right"},Ss={class:"p-0 text-sm"},Cs=["onUpdate:modelValue"],Ts={class:"p-0 text-sm"},Ds=["onUpdate:modelValue"],$s={class:"px-2 py-3 text-sm font-medium text-violet-700 text-right"},Us={class:"p-0 text-sm"},Fs=["onUpdate:modelValue"],Es={class:"p-0 text-sm"},As=["onUpdate:modelValue"],Os={class:"p-0 text-sm"},Ns=["onUpdate:modelValue"],Rs={class:"p-0 text-sm"},Vs=["onUpdate:modelValue"],Bs={class:"px-2 py-3 text-sm font-medium text-violet-700 text-right"},Ls={class:"border-t-2 border-slate-300 bg-gradient-to-r from-slate-100 to-gray-100 font-bold shadow-lg"},Ms={class:"px-4 py-4 text-sm text-blue-800 bg-blue-50/80 border border-blue-200/50 text-right font-semibold"},Is={class:"px-4 py-4 text-sm text-emerald-800 bg-emerald-50/80 border border-emerald-200/50 text-right font-semibold"},Hs={class:"px-4 py-4 text-sm text-amber-800 bg-amber-50/80 border border-amber-200/50 text-right font-semibold"},qs={class:"px-4 py-4 text-sm text-amber-800 bg-amber-50/80 border border-amber-200/50 text-right font-semibold"},Ks={class:"px-4 py-4 text-sm text-amber-800 bg-amber-50/80 border border-amber-200/50 text-right font-semibold"},Js={class:"px-4 py-4 text-sm text-purple-800 bg-purple-50/80 border border-purple-200/50 text-right font-semibold"},Xs={class:"px-4 py-4 text-sm text-purple-800 bg-purple-50/80 border border-purple-200/50 text-right font-semibold"},zs={__name:"project_budget_revenue",setup(g){const e=F(!1),r=F(!0),o=F(!1),l=F(""),p=F(!1),m=F(!1),u=F(""),f=F([]),v=F(""),$=F(!1),c=F([]),J=I(()=>V.value.reduce((a,s)=>a+s.tasks.length,0)),G=I(()=>V.value.reduce((a,s)=>a+s.subtotalBudget,0)),Y=I(()=>V.value.reduce((a,s)=>a+s.subtotalActual,0)),Q=I(()=>Y.value-G.value),V=I(()=>c.value.filter(a=>a.tasks&&a.tasks.length>0)),Z=(a=!1)=>S(this,null,function*(){var s;try{o.value=!0;const n=(s=st.value)==null?void 0:s.project_name;(a||N.getAllProjects().length===0)&&(yield N.fetchData()),c.value=[...N.getAllProjects()],r.value=!0,l.value=""}catch(n){console.error("Load data error:",n),l.value=n.message,C.error(`Failed to load data: ${n.message}`)}finally{o.value=!1}}),T=a=>ie.formatCurrency(a),y=()=>{r.value=!1,l.value="",c.value=[...c.value]},O=a=>{const s=String.fromCharCode(a.which);/[0-9.]/.test(s)||a.preventDefault()},it=()=>S(this,null,function*(){o.value=!0,l.value="";try{yield N.saveData(c.value),r.value=!0,C.success("Construction budget saved successfully")}catch(a){l.value=a.message,C.error(`Failed to save changes: ${a.message}`)}finally{o.value=!1}}),dt=a=>{const s=c.value.find(n=>n.id===a);s?(s.addTask(),c.value=[...c.value],y()):console.error("Project not found with ID:",a)},ut=(a,s)=>S(this,null,function*(){if(confirm("Are you sure you want to delete this task?"))try{s&&s!==null&&s!==void 0&&(yield ct(s));const n=c.value.find(h=>h.id===a);n&&(n.removeTask(s),c.value=[...c.value],y(),C.success("Task deleted successfully"))}catch(n){C.error(`Failed to delete task: ${n.message}`)}}),ct=a=>S(this,null,function*(){try{const s=yield fetch("/api/method/ex_forcast.api.construction_budget_api.delete_construction_budget_task",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":R()},body:JSON.stringify({task_id:a})});if(!s.ok){const i=yield s.text();throw new Error(`HTTP error! status: ${s.status} - ${i}`)}const n=yield s.json(),h=n.message||n;if(!h.success)throw new Error(h.error||"Failed to delete task");return n}catch(s){throw console.error("Error deleting task from database:",s),s}}),pt=(a,s)=>{const n=a.target.value;y(),s.name=n||`PROJECT ${s.id}`,s.tasks.length>0&&(s.tasks[0].project_name=n||s.name),c.value=[...c.value]},mt=(a,s,n)=>{try{const h=c.value.find(i=>i.id===a);if(h){const i=h.tasks.find(P=>P.id===s);i&&(i.task=n||"Untitled Task",c.value=[...c.value],y())}}catch(h){C.error(`Failed to update task name: ${h.message}`)}},tt=()=>{const a=c.value.length+1;u.value=`PROJECT ${a}`,m.value=!0,$.value=!1,v.value="",et()},ht=()=>{const a=(u.value||"").trim(),s=new Set(c.value.flatMap(P=>P.tasks&&P.tasks[0]?[String(P.tasks[0].project_name).toLowerCase()]:[]));if(a&&s.has(a.toLowerCase())){$.value=!0,C.warning("Project already exists. Please select it from the dropdown.");return}if(v.value){const P=f.value.find(Pt=>Pt.name===v.value),d=P?P.project_name||P.name:v.value,M=A.createEmpty(d);M.tasks.length>0&&(M.tasks[0].project_name=d),c.value.push(M),c.value=[...c.value],m.value=!1,u.value="",v.value="",$.value=!1,y();return}const n=c.value.length+1,h=a||`PROJECT ${n}`,i=A.createEmpty(h);i.tasks.length>0&&(i.tasks[0].project_name=h),c.value.push(i),c.value=[...c.value],m.value=!1,u.value="",$.value=!1,y()},bt=()=>{m.value=!1,u.value="",v.value="",$.value=!1},gt=()=>S(this,null,function*(){try{yield Z(!0),C.success("Data refreshed successfully")}catch(a){C.error(`Failed to refresh data: ${a.message}`)}}),ft=()=>{try{const a=N.exportData("csv"),s=new Blob([a],{type:"text/csv"}),n=window.URL.createObjectURL(s),h=document.createElement("a");h.href=n,h.download=`construction_budget_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(n),C.success("Data exported successfully")}catch(a){C.error(`Failed to export data: ${a.message}`)}},et=()=>S(this,null,function*(){try{f.value=yield N.fetchAvailableProjects()}catch(a){C.error(`Failed to load existing projects: ${a.message}`)}}),xt=a=>S(this,null,function*(){if(confirm("Delete this Construction Budget Project and all its tasks? This cannot be undone."))try{yield N.deleteProject(a),c.value=c.value.filter(n=>n.id!==a),c.value=[...c.value],C.success("Project deleted successfully")}catch(n){C.error(`Failed to delete project: ${n.message}`)}}),q=F({projectId:null,fromIndex:null}),vt=(a,s)=>{q.value={projectId:a,fromIndex:s}},yt=(a,s)=>{const{projectId:n,fromIndex:h}=q.value||{};if(!(n===null||h===null)){if(n!==a){q.value={projectId:null,fromIndex:null};return}try{const i=c.value.find(M=>M.id===a);if(!i||!i.tasks)return;const P=i.tasks;if(h===s)return;const[d]=P.splice(h,1);P.splice(s,0,d),c.value=[...c.value],y()}finally{q.value={projectId:null,fromIndex:null}}}},wt=a=>{a.preventDefault()},jt=()=>{p.value=!0},_t=()=>{p.value=!1};St(()=>S(this,null,function*(){try{yield Ct()}catch(a){}yield N.testApiConnection(),yield Z()})),Tt(st,(a,s)=>S(this,null,function*(){const n=a==null?void 0:a.project_name,h=s==null?void 0:s.project_name}));const kt=a=>{try{a&&a.project_name&&C.success(`Switched to project: ${a.project_name}`)}catch(s){C.error("Failed to acknowledge project change")}};return(a,s)=>(j(),k("div",ue,[b(Ot,{onOpenSettings:jt,onProjectChanged:kt}),t("div",ce,[t("div",pe,[t("div",{class:H(["bg-gradient-to-b from-white to-gray-50 border-r border-gray-200 min-h-screen flex flex-col shadow-sm transition-all duration-300",e.value?"w-14 p-2":"w-80 p-6"])},[t("button",{onClick:s[0]||(s[0]=n=>e.value=!e.value),class:"mb-4 flex items-center gap-2 px-2 py-1 bg-violet-100 hover:bg-violet-200 rounded transition-all dark:bg-violet-900/30 dark:hover:bg-violet-800/40"},[e.value?(j(),rt(x(It),{key:1,class:"w-5 h-5 text-violet-700 dark:text-white"})):(j(),rt(x(Mt),{key:0,class:"w-5 h-5 text-violet-700 dark:text-white"})),e.value?B("",!0):(j(),k("span",me,"Collapse"))]),b(Ut,{name:"fade"},{default:Dt(()=>[D(t("div",null,[t("div",he,[t("div",be,[t("div",ge,[b(x(X),{class:"w-7 h-7 mx-2 text-white"})]),s[11]||(s[11]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Project Budget",-1))]),s[12]||(s[12]=t("p",{class:"text-sm text-gray-500"},"Manage and track your construction project budget",-1))]),t("div",fe,[t("div",xe,[t("div",ve,[r.value?(j(),k("div",we,[b(x(Rt),{class:"w-4 h-4 text-green-600"}),s[14]||(s[14]=_(" All Saved ",-1))])):(j(),k("div",ye,[b(x(Nt),{class:"w-4 h-4 text-red-600"}),s[13]||(s[13]=_(" Unsaved ",-1))]))]),!o.value&&!r.value?(j(),k("button",{key:0,disabled:o.value,onClick:it,class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-lg hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[b(x(qt),{class:"w-4 h-4"}),s[15]||(s[15]=_(" Save ",-1))],8,je)):B("",!0),o.value?(j(),k("button",_e,[b(x(Kt),{class:"w-4 h-4 animate-spin"}),s[16]||(s[16]=_(" Saving... ",-1))])):B("",!0)]),l.value?(j(),k("span",ke,[b(x(Ht),{class:"w-3 h-3"}),_(" "+w(l.value),1)])):B("",!0)]),t("div",Pe,[t("h3",Se,[b(x(ot),{class:"w-4 h-4 text-violet-600"}),s[17]||(s[17]=_(" Quick Actions ",-1))]),t("button",{onClick:tt,class:"inline-flex items-center justify-center w-full gap-2 mb-2 px-6 py-3 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-xl hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform font-medium"},[b(x(W),{class:"w-5 h-5"}),s[18]||(s[18]=_(" Add New Project ",-1))]),t("div",Ce,[t("button",{onClick:gt,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-violet-200 text-violet-700 rounded-lg hover:bg-violet-50 transition-all text-sm font-medium"},[b(x(Vt),{class:"w-4 h-4"}),s[19]||(s[19]=_(" Refresh ",-1))]),t("button",{onClick:ft,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-green-200 text-green-700 rounded-lg hover:bg-green-50 transition-all text-sm font-medium"},[b(x(Bt),{class:"w-4 h-4"}),s[20]||(s[20]=_(" Export ",-1))])])]),t("div",Te,[t("h3",De,[b(x(Jt),{class:"w-5 h-5 text-violet-600"}),s[21]||(s[21]=_(" Project Summary ",-1))]),t("div",$e,[t("div",Ue,[s[22]||(s[22]=t("span",{class:"text-sm text-gray-600"},"Total Projects:",-1)),t("span",Fe,w(V.value.length),1)]),t("div",Ee,[s[23]||(s[23]=t("span",{class:"text-sm text-gray-600"},"Total Tasks:",-1)),t("span",Ae,w(J.value),1)]),t("div",Oe,[s[24]||(s[24]=t("span",{class:"text-sm text-gray-600"},"Total Budget:",-1)),t("span",Ne,w(T(G.value)),1)]),t("div",Re,[s[25]||(s[25]=t("span",{class:"text-sm text-gray-600"},"Total Actual:",-1)),t("span",Ve,w(T(Y.value)),1)]),t("div",Be,[s[26]||(s[26]=t("span",{class:"text-sm text-gray-600"},"Variance:",-1)),t("span",{class:H(["font-semibold",Q.value>=0?"text-red-600":"text-green-600"])},w(T(Q.value)),3)])])])],512),[[$t,!e.value]])]),_:1})],2),t("div",Le,[t("div",Me,[t("div",Ie,[b(x(X),{class:"w-3 h-3 text-white"})]),s[27]||(s[27]=t("h2",{class:"text-lg font-bold text-gray-800"},"Project Budgets and Revenue Overview",-1))]),V.value.length===0?(j(),k("div",He,[t("div",qe,[t("div",Ke,[b(x(X),{class:"w-12 h-12 text-violet-600"})]),s[29]||(s[29]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"No Projects Yet",-1)),s[30]||(s[30]=t("p",{class:"text-gray-600 mb-8 max-w-md mx-auto"}," Get started by creating your first construction project. You can add tasks, track budgets, and monitor progress all in one place. ",-1)),t("button",{onClick:tt,class:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-xl hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 font-medium"},[b(x(W),{class:"w-5 h-5"}),s[28]||(s[28]=_(" Create Your First Project ",-1))])])])):(j(),k("div",Je,[t("div",Xe,[t("div",ze,[t("table",We,[s[40]||(s[40]=t("thead",{class:"bg-violet-500 text-white shadow-lg"},[t("tr",{class:"border-b border-white/20"},[t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-96"},"Task"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-[400px]"},"Description"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-72"},"Status"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-48"},"Planned Start Date"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-48"},"Actual Start Date"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-40"},"End Date"),t("th",{colspan:"3",class:"px-6 py-4 text-center text-sm font-bold uppercase tracking-wider border-l-2 border-r-2 border-white/30 bg-violet-500"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-2 h-2 bg-violet-200 rounded-full"}),_(" Labor ")])]),t("th",{colspan:"3",class:"px-6 py-4 text-center text-sm font-bold uppercase tracking-wider border-l-2 border-r-2 border-white/30 bg-violet-500"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-2 h-2 bg-violet-200 rounded-full"}),_(" Materials ")])]),t("th",{colspan:"3",class:"px-6 py-4 text-center text-sm font-bold uppercase tracking-wider border-l-2 border-r-2 border-white/30 bg-violet-500"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-2 h-2 bg-violet-200 rounded-full"}),_(" Fixed ")])]),t("th",{colspan:"3",class:"px-6 py-4 text-center text-sm font-bold uppercase tracking-wider border-l-2 border-r-2 border-white/30 bg-violet-500"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-2 h-2 bg-violet-200 rounded-full"}),_(" Balance ")])])]),t("tr",{class:"bg-violet-500 text-white border-b border-white/20"},[t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-64"},"HR"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-72"},"/HR"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-56"},"Total Labor"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Units"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-56"},"/Units"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-60"},"Total Materials"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Travel"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-60"},"Equipment/Space"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Misc."),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Budget"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Actual"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-56"},"Under/Over")])],-1)),t("tbody",Ge,[(j(!0),k(K,null,z(V.value,(n,h)=>(j(),k(K,{key:`project-${n.id}`},[t("tr",Ye,[t("td",Qe,[t("div",Ze,[t("div",ts,[s[31]||(s[31]=t("div",{class:"w-3 h-3 bg-gradient-to-r from-violet-500 to-purple-500 rounded-full"},null,-1)),t("input",{value:n.tasks.length>0&&n.tasks[0].project_name,onInput:i=>pt(i,n),type:"text",class:"font-bold text-lg bg-transparent border-0 focus:ring-2 focus:ring-violet-500 focus:bg-white focus:shadow-sm px-2 py-1 rounded transition-all duration-200 min-w-0 flex-1",placeholder:"Project name"},null,40,es)]),t("div",ss,[t("button",{onClick:i=>dt(n.id),class:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-lg hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[b(x(ot),{class:"w-4 h-4"}),s[32]||(s[32]=_(" Add Task ",-1))],8,rs),t("button",{onClick:i=>xt(n.id),class:"inline-flex items-center gap-2 px-3 py-2 border border-red-200 text-red-700 rounded-lg hover:bg-red-50 transition-all text-sm font-medium",title:"Delete this project and its tasks"},[b(x(at),{class:"w-4 h-4"}),s[33]||(s[33]=_(" Delete Project Tasks ",-1))],8,os)])])])]),(j(!0),k(K,null,z(n.tasks,(i,P)=>(j(),k("tr",{key:`task-${n.id}-${i.id||P}`,class:"transition-all duration-200 h-12 align-middle hover:bg-slate-50/50 border-b border-gray-100",draggable:!0,onDragstart:d=>vt(n.id,P),onDragover:wt,onDrop:d=>yt(n.id,P)},[t("td",ns,[t("div",ls,[t("span",is,[b(x(Xt),{class:"w-4 h-4"})]),D(t("input",{"onUpdate:modelValue":d=>i.task=d,type:"text",class:H(["flex-1 h-full px-4 py-0 border-0 bg-transparent text-sm focus:ring-2 focus:ring-violet-500 focus:bg-white focus:shadow-sm font-medium transition-all duration-200",i.isSubtask?"pl-8 text-gray-600":"text-gray-900"]),placeholder:"Enter task name",onInput:y,onBlur:d=>mt(n.id,i.id,i.task)},null,42,ds),[[U,i.task]]),t("button",{type:"button",class:"shrink-0 inline-flex items-center justify-center w-8 h-8 rounded-md text-red-600 hover:text-white hover:bg-red-600 transition-colors",onClick:d=>ut(n.id,i.id),title:"Delete task"},[b(x(at),{class:"w-4 h-4"})],8,us)])]),t("td",cs,[D(t("input",{"onUpdate:modelValue":d=>i.description=d,type:"text",class:"w-full h-full px-4 py-0 border-0 bg-transparent text-sm focus:ring-2 focus:ring-violet-500 focus:bg-white focus:shadow-sm transition-all duration-200",placeholder:"Enter description",onInput:y},null,40,ps),[[U,i.description]])]),t("td",ms,[D(t("select",{"onUpdate:modelValue":d=>i.status=d,class:"w-full h-full px-4 py-0 border-0 bg-transparent text-sm focus:ring-2 focus:ring-violet-500 focus:bg-white focus:shadow-sm transition-all duration-200",onChange:y},s[34]||(s[34]=[Et('<option value="Not Started" data-v-90838692>Not Started</option><option value="In Progress" data-v-90838692>In Progress</option><option value="Complete" data-v-90838692>Complete</option><option value="Needs Review" data-v-90838692>Needs Review</option><option value="Approved" data-v-90838692>Approved</option><option value="Overdue" data-v-90838692>Overdue</option><option value="On Hold" data-v-90838692>On Hold</option>',7)]),40,hs),[[Ft,i.status]])]),t("td",bs,[D(t("input",{"onUpdate:modelValue":d=>i.plannedStartDate=d,type:"date",class:"w-full h-full px-2 py-0 border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,gs),[[U,i.plannedStartDate]])]),t("td",fs,[D(t("input",{"onUpdate:modelValue":d=>i.actualStartDate=d,type:"date",class:"w-full h-full px-2 py-0 border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,xs),[[U,i.actualStartDate]])]),t("td",vs,[D(t("input",{"onUpdate:modelValue":d=>i.endDate=d,type:"date",class:"w-full h-full px-2 py-0 border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,ys),[[U,i.endDate]])]),t("td",ws,[D(t("input",{"onUpdate:modelValue":d=>i.hr=d,type:"number",step:"0.1",onKeypress:s[1]||(s[1]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,js),[[U,i.hr,void 0,{number:!0}]])]),t("td",_s,[D(t("input",{"onUpdate:modelValue":d=>i.ratePerHr=d,type:"number",step:"0.01",onKeypress:s[2]||(s[2]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,ks),[[U,i.ratePerHr,void 0,{number:!0}]])]),t("td",Ps,w(T(i.totalLabor)),1),t("td",Ss,[D(t("input",{"onUpdate:modelValue":d=>i.units=d,type:"number",step:"0.1",onKeypress:s[3]||(s[3]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:y},null,40,Cs),[[U,i.units,void 0,{number:!0}]])]),t("td",Ts,[D(t("input",{"onUpdate:modelValue":d=>i.ratePerUnit=d,type:"number",step:"0.01",onKeypress:s[4]||(s[4]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:y},null,40,Ds),[[U,i.ratePerUnit,void 0,{number:!0}]])]),t("td",$s,w(T(i.totalMaterials)),1),t("td",Us,[D(t("input",{"onUpdate:modelValue":d=>i.travel=d,type:"number",step:"0.01",onKeypress:s[5]||(s[5]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent",onInput:y},null,40,Fs),[[U,i.travel,void 0,{number:!0}]])]),t("td",Es,[D(t("input",{"onUpdate:modelValue":d=>i.equipment=d,type:"number",step:"0.01",onKeypress:s[6]||(s[6]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent",onInput:y},null,40,As),[[U,i.equipment,void 0,{number:!0}]])]),t("td",Os,[D(t("input",{"onUpdate:modelValue":d=>i.misc=d,type:"number",step:"0.01",onKeypress:s[7]||(s[7]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent",onInput:y},null,40,Ns),[[U,i.misc,void 0,{number:!0}]])]),t("td",Rs,[D(t("input",{"onUpdate:modelValue":d=>i.budget=d,type:"number",step:"0.01",onKeypress:s[8]||(s[8]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent",onInput:y},null,40,Vs),[[U,i.budget,void 0,{number:!0}]])]),t("td",Bs,w(T(i.actual)),1),t("td",{class:H(["px-2 py-3 text-sm font-medium text-right",i.underOver>=0?"text-red-50 bg-red-600":"text-green-50 bg-green-600"])},w(T(i.underOver)),3)],40,as))),128)),t("tr",Ls,[s[35]||(s[35]=t("td",{class:"px-6 py-4 text-sm text-slate-800 border border-slate-300 font-bold",colspan:6},[t("div",{class:"flex items-center gap-2"},[t("div",{class:"w-2 h-2 bg-slate-600 rounded-full"}),_(" SUBTOTAL ")])],-1)),s[36]||(s[36]=t("td",{class:"px-4 py-4 text-sm text-blue-800 bg-blue-50/80 border border-blue-200/50"},null,-1)),s[37]||(s[37]=t("td",{class:"px-4 py-4 text-sm text-blue-800 bg-blue-50/80 border border-blue-200/50"},null,-1)),t("td",Ms,w(T(n.subtotalLabor)),1),s[38]||(s[38]=t("td",{class:"px-4 py-4 text-sm text-emerald-800 bg-emerald-50/80 border border-emerald-200/50"},null,-1)),s[39]||(s[39]=t("td",{class:"px-4 py-4 text-sm text-emerald-800 bg-emerald-50/80 border border-emerald-200/50"},null,-1)),t("td",Is,w(T(n.subtotalMaterials)),1),t("td",Hs,w(T(n.subtotalTravel)),1),t("td",qs,w(T(n.subtotalEquipment)),1),t("td",Ks,w(T(n.subtotalMisc)),1),t("td",Js,w(T(n.subtotalBudget)),1),t("td",Xs,w(T(n.subtotalActual)),1),t("td",{class:H(["px-4 py-4 text-sm font-bold text-right border border-gray-200/50",n.subtotalUnderOver>=0?"text-red-800 bg-red-50/80":"text-green-800 bg-green-50/80"])},w(T(n.subtotalUnderOver)),3)])],64))),128))])])])])]))])])]),b(Lt,{"is-visible":p.value,onClose:_t},null,8,["is-visible"]),b(ae,{"is-visible":m.value,"new-project-name":u.value,"available-projects":f.value,"selected-existing-project":v.value,"duplicate-project":$.value,"onUpdate:newProjectName":s[9]||(s[9]=n=>u.value=n),"onUpdate:selectedExistingProject":s[10]||(s[10]=n=>v.value=n),onRefresh:et,onConfirm:ht,onClose:bt},null,8,["is-visible","new-project-name","available-projects","selected-existing-project","duplicate-project"])]))}},lr=nt(zs,[["__scopeId","data-v-90838692"]]);export{lr as default};
