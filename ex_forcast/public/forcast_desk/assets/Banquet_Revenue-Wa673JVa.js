var Ge=Object.defineProperty,Qe=Object.defineProperties;var We=Object.getOwnPropertyDescriptors;var xe=Object.getOwnPropertySymbols;var Xe=Object.prototype.hasOwnProperty,Ke=Object.prototype.propertyIsEnumerable;var he=(s,n,a)=>n in s?Ge(s,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[n]=a,Q=(s,n)=>{for(var a in n||(n={}))Xe.call(n,a)&&he(s,a,n[a]);if(xe)for(var a of xe(n))Ke.call(n,a)&&he(s,a,n[a]);return s},ie=(s,n)=>Qe(s,We(n));var O=(s,n,a)=>new Promise((r,p)=>{var v=h=>{try{_(a.next(h))}catch(f){p(f)}},u=h=>{try{_(a.throw(h))}catch(f){p(f)}},_=h=>h.done?r(h.value):Promise.resolve(h.value).then(v,u);_((a=a.apply(s,n)).next())});import{_ as Ze,h as S,k as et,z as tt,A as be,m as W,l as ot,x as st,c,b as e,e as b,n as P,j as te,u as l,i as F,w as de,T as ce,F as j,d as w,p as I,t as N,o as d,q as X,B as nt,C as _e,D as ue,v as rt}from"./index-FWH8FmVo.js";import{u as at,c as K,a as D,C as lt,b as we,R as it,d as ve,A as me,T as dt,S as ye,e as ct,f as ke}from"./cloneDeep-DJecBEfU.js";import{i as ut,s as y,_ as vt,H as mt,T as pe,F as pt,C as gt,X as je}from"./projectService-Cz5ZqhwS.js";import{l as ft,i as G,t as xt}from"./advanced_settings-68ZvMdlZ.js";import{u as ht}from"./useCalculationCache-nEKvnCaF.js";import"./createLucideIcon-BgmmH0Yw.js";function Se(s){return A(s.pax)*A(s.avg_food_check)}function Fe(s){return A(s.pax)*A(s.avg_liquor_check)}function qe(s){return A(s.pax)*A(s.avg_soft_drinks_check)}function Te(s){return A(s.events)*A(s.avg_hall_space_charges_check)}const Ce=["food","liquor","soft_drinks","hall_space_charges"],bt=["gross","net_amount","advance_bal","amount_per_event","amount_per_pax","avg_pax_per_event"],_t=["events","pax","avg_food_check","avg_liquor_check","avg_soft_drinks_check","avg_hall_space_charges_check"];function re(s,n=[]){let a=0;for(const r of Ce)switch(r){case"food":a+=Se(s);break;case"liquor":a+=Fe(s);break;case"soft_drinks":a+=qe(s);break;case"hall_space_charges":a+=Te(s);break}for(const r of n)!Ce.includes(r)&&!bt.includes(r)&&!_t.includes(r)&&(a+=A(s[r]));return a}function wt(s,n=[]){return re(s,n)-A(s.advance_bal||0)}function yt(s){const n=A(s.events);return n===0?0:re(s)/n}function kt(s){const n=A(s.pax);return n===0?0:re(s)/n}function jt(s){const n=A(s.events);return n===0?0:A(s.pax)/n}const Ct=["events","pax"];function oe(s,n){return Ct.includes(s)?n===0||n==="0"||n===0||n==="0.00"?"0":isNaN(n)?n:Number(n).toLocaleString(void 0,{maximumFractionDigits:0}):!isNaN(n)&&n!==""&&n!==null?Number(n).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):n}const Ae=[{code:"events",label:"Events"},{code:"pax",label:"Number of persons (Pax)"},{code:"avg_food_check",label:"Average food check"},{code:"avg_liquor_check",label:"Average liquor check"},{code:"avg_soft_drinks_check",label:"Average soft drinks check"},{code:"avg_hall_space_charges_check",label:"Average hall/Space charges check"},{code:"food",label:"Food"},{code:"liquor",label:"Liquor"},{code:"soft_drinks",label:"Soft Drinks"},{code:"hall_space_charges",label:"Hall/Space Charges"},{code:"tobacco",label:"Tobacco"},{code:"non_fnb",label:"Non F&B"},{code:"outside_service_food_catering",label:"Outside Service Food Catering"},{code:"outside_service_beverage_catering",label:"Outside Service Beverage Catering"},{code:"others",label:"Others"},{code:"gross",label:"Gross"},{code:"advance_bal",label:"Advance(Bal)"},{code:"net_amount",label:"Net Amount"},{code:"amount_per_event",label:"Amount / Event*"},{code:"amount_per_pax",label:"Amount per Pax*"},{code:"avg_pax_per_event",label:"Average Pax/Event"}],Me="/api/method/ex_forcast.api.call_and_save_banquet_revenue";function se(s=null){return O(this,null,function*(){try{let n=`${Me}.banquet_revenue_display`;s&&(n+=`?project=${encodeURIComponent(s)}`);const a=yield fetch(n);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const r=yield a.json();if(r.error)throw new Error(r.error);return r.message||r}catch(n){throw console.error("Error loading Banquet revenue data:",n),n}})}function At(s,n=null){return O(this,null,function*(){var a;try{const r=new FormData;r.append("changes",JSON.stringify(s)),n&&r.append("project",n);const p=yield fetch(`${Me}.upsert_banquet_revenue_items`,{method:"POST",body:r});if(!p.ok){const u=yield p.text();throw new Error(`HTTP error! status: ${p.status}, response: ${u}`)}const v=yield p.json();if(((a=v.message)==null?void 0:a.status)==="error")throw new Error(v.message.message);return v}catch(r){throw console.error("Error saving Banquet revenue changes:",r),r}})}function ne(s){const n={};for(const a in s){n[a]={};for(const r in s[a])n[a][r]=(s[a][r]||[]).map(p=>ie(Q({},p),{expense:p.banquet_detail}))}return n}//! Utility: Get visible years between from and to (inclusive)
function Bt(s,n){const a=parseInt(s),r=parseInt(n);if(!a||!r||a>r)return[];const p=[];for(let v=a;v<=r;v++)p.push(v);return p}//! Utility: Get column labels for display mode
const St=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Ft=["Jan-Mar","Apr-Jun","Jul-Sep","Oct-Dec"];function qt(s){return s==="monthly"?St:Ft}//! Utility: Get amount for a specific field, year, and label (month/quarter)
function Ee(s,n,a,r,p="monthly"){var v,u;if(p==="quarterly"&&["Jan-Mar","Apr-Jun","Jul-Sep","Oct-Dec"].includes(r)){const _={"Jan-Mar":["Jan","Feb","Mar"],"Apr-Jun":["Apr","May","Jun"],"Jul-Sep":["Jul","Aug","Sep"],"Oct-Dec":["Oct","Nov","Dec"]};let h=0;for(const f of _[r]){const C=(((v=s==null?void 0:s[a])==null?void 0:v[f])||[]).find(J=>J.expense===n);C&&(h+=Number(C.amount)||0)}return h}else{const h=(((u=s==null?void 0:s[a])==null?void 0:u[r])||[]).find(f=>f.expense===n);return h&&Number(h.amount)||0}}//! Utility: Calculate total for a field in a year
function Be(s,n,a,r,p){const v=p(r);let u=0;for(const _ of v)u+=Ee(s,n,a,_,r);return u}//! Safe number conversion utility
function A(s){return typeof s=="number"?s:s==null||s===""?0:Number(s)}//! Handler for cell edits (banquet-specific)
function Tt({year:s,label:n,expense:a,event:r,originalBanquetData:p,changedCells:v,banquetData:u,isSaved:_,isComponentReady:h}){var R,U,H,Z;if(!h||!h.value){console.warn("Component not ready yet, skipping cell edit");return}if(!v||!v.value){console.error("changedCells ref is undefined");return}if(!u){console.error("banquetData is undefined");return}if(!_){console.error("isSaved ref is undefined");return}if(!p||!p.value){console.error("originalBanquetData ref is undefined");return}let f=r.target.innerText.replace(/,/g,"").trim();f===""&&(f="0.00"),f=(parseFloat(f)||0).toFixed(2);let C="0.00";const z=(((U=(R=p.value)==null?void 0:R[s])==null?void 0:U[n])||[]).find(V=>V.expense===a);if(z&&(C=parseFloat(z.amount).toFixed(2)),f!==C){_.value=!1;const V=v.value.findIndex(B=>B.year===s&&B.label===n&&B.expense===a);V!==-1?v.value[V].newValue=f:v.value.push({year:s,label:n,expense:a,newValue:f}),u[s]||(u[s]={});let k=u[s][n]||[];const E=k.findIndex(B=>B.expense===a);E!==-1?k=[...k.slice(0,E),ie(Q({},k[E]),{amount:parseFloat(f)}),...k.slice(E+1)]:k=[...k,{expense:a,amount:parseFloat(f)}],u[s][n]=k,(Z=(H=u==null?void 0:u[s])==null?void 0:H[n])==null||Z.find(B=>B.expense===a)}else v.value=v.value.filter(V=>!(V.year===s&&V.label===n&&V.expense===a)),v.value.length===0&&(_.value=!0)}//! Handler for cell input (banquet-specific, real-time formatting)
function Mt({year:s,label:n,expense:a,event:r,banquetData:p}){let v=r.target.innerText;v=v.replace(/[^\d.]/g,"");const u=v.split(".");if(u.length>2&&(v=u[0]+"."+u.slice(1).join("")),!v.includes(".")||u.length===2&&u[1].length===2){u.length===2&&u[1].length>2&&(v=u[0]+"."+u[1].substring(0,2));const f=(parseFloat(v)||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});if(f!==r.target.innerText){r.target.innerText=f;const M=document.createRange(),C=window.getSelection(),J=r.target.firstChild||r.target;M.setStart(J,J.textContent.length),M.collapse(!0),C.removeAllRanges(),C.addRange(M)}}else v!==r.target.innerText&&(r.target.innerText=v)}//! Handler for cell focus (banquet-specific, show raw value for editing)
function Et({year:s,label:n,expense:a,event:r}){const v=r.target.innerText.replace(/,/g,"");r.target.innerText=v;const u=document.createRange(),_=window.getSelection();u.selectNodeContents(r.target),_.removeAllRanges(),_.addRange(u)}const Nt={class:"flex"},Dt={class:"flex-1 min-h-screen bg-gradient-to-br from-white to-violet-50"},Vt={class:"flex"},Yt={key:2,class:"text-violet-700 text-sm font-medium"},Lt={class:"mb-8"},Pt={class:"flex items-center gap-3 mb-2"},Rt={class:"w-12 h-12 bg-gradient-to-br from-violet-500 to-violet-600 rounded-xl flex items-center justify-center shadow-lg"},Ot={class:"bg-white rounded-xl p-4 mb-6 border border-gray-200 shadow-sm"},It={class:"flex items-center justify-between"},Jt={class:"flex items-center gap-2"},Ut={key:0,class:"flex items-center gap-2 text-sm font-medium text-red-600 bg-red-50 px-3 py-2 rounded-lg border border-red-200"},$t={key:1,class:"flex items-center gap-2 text-sm font-medium text-green-600 bg-green-50 px-3 py-2 rounded-lg border border-green-200"},zt=["disabled"],Ht={key:1,class:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg cursor-not-allowed"},Gt={key:0,class:"mt-2 text-xs text-red-500 flex items-center gap-1"},Qt={class:"mb-8"},Wt={key:0,class:"mb-4"},Xt={class:"flex items-center gap-2 p-4 bg-red-100 border border-red-200 rounded text-red-800 text-sm"},Kt={class:"flex gap-2 mt-3"},Zt={class:"flex-1"},eo={class:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm"},to={class:"space-y-4"},oo={class:"grid grid-cols-2 gap-3"},so=["value"],no=["value"],ro={class:"flex gap-2"},ao={class:"flex-1 p-4"},lo={key:0,class:"flex flex-col items-center justify-center min-h-[400px] bg-white border-2 border-dashed border-violet-300 rounded-xl shadow-sm"},io={class:"w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center mb-4"},co={class:"mt-4 flex items-center gap-2 text-xs text-violet-600"},uo={class:"mb-4"},vo={class:"flex items-center gap-2"},mo={class:"w-6 h-6 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},po={class:"flex gap-2 mt-2"},go=["disabled"],fo={class:"bg-white rounded-lg border border-violet-200 shadow-sm overflow-hidden"},xo={class:"overflow-x-auto"},ho={class:"min-w-full w-max"},bo={class:"w-full"},_o={class:"bg-gradient-to-r from-violet-600 to-violet-700 text-white"},wo={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},yo={class:"flex items-center gap-1"},ko=["colspan","onClick"],jo={class:"flex items-center justify-center gap-1"},Co={class:"font-semibold"},Ao={class:"bg-violet-500/90 text-xs"},Bo={key:1,class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},So={class:"text-gray-700 bg-white text-sm"},Fo={class:"flex items-center gap-1"},qo={key:0,class:"px-2 py-0.5 rounded bg-violet-100 text-violet-700 text-[10px] font-semibold border border-violet-200 align-middle whitespace-nowrap"},To={key:1,class:"px-2 py-0.5 rounded bg-green-100 text-green-700 text-[10px] font-semibold border border-green-200 align-middle whitespace-nowrap"},Mo=["onClick"],Eo={class:"font-mono text-xs"},No=["onInput","onFocus","onBlur"],Do={class:"font-mono text-xs"},Vo={key:0},Yo=["colspan"],Lo={key:1},Po=["colspan"],Ro={key:2,class:"flex flex-col items-center justify-center min-h-[400px] bg-white border-2 border-dashed border-violet-300 rounded-xl shadow-sm"},Oo={class:"w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center mb-4"},Io={class:"text-lg text-violet-700 font-semibold mb-2"},Jo={class:"text-gray-500 text-center max-w-md leading-relaxed text-sm"},Uo={class:"mt-4 flex items-center gap-2 text-xs text-violet-600"},$o={key:3,class:"flex flex-col items-center justify-center min-h-[400px] bg-white border-2 border-dashed border-violet-300 rounded-xl shadow-sm"},zo={class:"w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center mb-4"},Ho={class:"mt-4 flex items-center gap-2 text-xs text-violet-600"},Go={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm"},Qo={class:"bg-white rounded-2xl shadow-2xl border border-violet-200 w-[95%] max-w-lg p-0 overflow-hidden"},Wo={class:"flex items-center gap-3 px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},Xo={class:"p-8 pt-6"},Ko={key:0,class:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center gap-3"},Zo={key:1,class:"space-y-4 max-h-[50vh] overflow-auto pr-2"},es={class:"font-medium text-gray-700 flex items-center gap-2"},ts=["onUpdate:modelValue"],os={class:"flex justify-end gap-3 px-8 py-4 bg-gray-50 border-t border-violet-100"},ss={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm"},ns={class:"bg-white rounded-2xl shadow-2xl border border-violet-200 w-[95%] max-w-md p-0 overflow-hidden"},rs={class:"flex items-center gap-3 px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},as={class:"p-8 pt-6"},ls={key:0,class:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center gap-3"},is={key:1,class:"mb-4"},ds={class:"flex justify-end gap-3 px-8 py-4 bg-gray-50 border-t border-violet-100"},cs=["disabled"],us={__name:"Banquet_Revenue",setup(s){const n=S([]),a=S("monthly"),r=et({}),p=S(!1),v=S({}),u=S(!1),_=S({}),h=S([]),f=S(!1),M=S(""),C=S(!1),J=S(!1),z=S(!1),R=S(""),U=S([]),H=S([]),Z=ht(),V=at(),{fromYear:k,toYear:E,advancedModes:B}=tt(V),{setFromYear:vs,setToYear:ms,setAdvancedModes:Ne,clearYearSettings:De}=V,Y=be(()=>Bt(k.value,E.value)),$=i=>qt(B.value[i]||a.value);W(Y,()=>{Y.value.forEach(i=>{B.value[i]||V.setAdvancedMode(i,a.value)})}),W(r,(i,t)=>{},{deep:!0,immediate:!0}),W(p,i=>{i&&(v.value=Q({},B.value))});function Ve(){Ne(Q({},v.value)),p.value=!1}function Ye(){p.value=!1}function Le(){z.value=!1}function Pe(){return O(this,null,function*(){if(R.value){if(!y.value){D.error("Please select a project first");return}try{if(!(yield fetch("/api/resource/Banquet Details",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({banquet_detail:R.value,project:y.value.project_name})})).ok)throw new Error("Failed to create");R.value="",z.value=!1,yield ee(),D.success("Banquet detail added")}catch(i){D.error("Failed to add banquet detail")}}})}function ee(){return O(this,null,function*(){try{if(!y.value){U.value=[];return}const t=yield(yield fetch(`/api/resource/Banquet Details?fields=["name","banquet_detail"]&filters=[["project","=","${y.value.project_name}"]]&limit_page_length=1000`)).json();U.value=(t.data||[]).map(o=>({code:o.name,label:o.banquet_detail}))}catch(i){D.error("Failed to load banquet details")}})}ot(()=>O(this,null,function*(){try{if(yield ut(),yield new Promise(i=>setTimeout(i,100)),n.value=yield ft(),y.value){const i=(yield se(y.value.project_name))||{},t=ne(i);Object.assign(r,t)}else r.value={status:"no_project_selected",message:"No project selected"};_.value=K(r),u.value=!0,J.value=!0,yield ee()}catch(i){console.error("Error loading data:",i)}})),W(y,(i,t)=>O(this,null,function*(){if(i)try{const o=(yield se(i.project_name))||{},x=ne(o);Object.assign(r,x),_.value=K(r),h.value=[],u.value=!0,M.value="",yield ee(),D.success(`Switched to project: ${i.project_name}`)}catch(o){console.error("Error reloading Banquet revenue data for new project:",o),D.error("Failed to load project data. Please try again.")}else r.value={status:"no_project_selected",message:"No project selected"},_.value=K(r),h.value=[],u.value=!0,M.value="",U.value=[]}),{deep:!0});function Re(){De(),u.value=!1}function Oe({year:i,label:t,expense:o,event:x}){Tt({year:i,label:t,expense:o,event:x,originalBanquetData:_,changedCells:h,banquetData:r,isSaved:u,isComponentReady:J})}const Ie=()=>O(this,null,function*(){var i,t;try{f.value=!0,M.value="";const o=h.value.map(q=>({year:q.year,month:q.label,banquet_detail:q.expense,amount:q.newValue}));if(o.length===0){f.value=!1;return}const x=yield At(o,(i=y.value)==null?void 0:i.project_name),m=(yield se((t=y.value)==null?void 0:t.project_name))||{},g=ne(m);return Object.assign(r,g),_.value=K(r),h.value=[],u.value=!0,D.success("Changes saved successfully"),f.value=!1,x}catch(o){M.value=o.message||"Failed to save changes",D.error(M.value),f.value=!1}});W(u,i=>{i?window.removeEventListener("beforeunload",ae):window.addEventListener("beforeunload",ae)});function ae(i){if(!u.value)return i.preventDefault(),i.returnValue="You have unsaved changes that may be discarded if not saved. Are you sure you want to leave?",i.returnValue}st(()=>{window.removeEventListener("beforeunload",ae)});function Je(){return O(this,null,function*(){var i;try{const t=(yield se((i=y.value)==null?void 0:i.project_name))||{},o=ne(t);Object.assign(r,o),_.value=K(r),h.value=[],u.value=!0,D.success("Page refreshed successfully")}catch(t){console.error("Error refreshing table:",t),D.error("Failed to refresh data. Please try again.")}})}function Ue(i,t,o){var m;const x={};for(const g of le.value){const L=(((m=i==null?void 0:i[t])==null?void 0:m[o])||[]).find(T=>T.expense===g.code);x[g.code]=L&&Number(L.amount)||0}return A(x.pax)>0||A(x.avg_food_check)>0,x}function ge(i,t,o,x,m="monthly"){var fe;const g=Ue(i,o,x),q=le.value.map(He=>He.code),L={projectName:(fe=y.value)==null?void 0:fe.project_name,calculationCache:Z,year:o,label:x};let T;switch(t){case"food":T=Se(g);break;case"liquor":T=Fe(g);break;case"soft_drinks":T=qe(g);break;case"hall_space_charges":T=Te(g);break;case"gross":T=re(g,q),L.projectName&&L.calculationCache&&L.year&&L.label&&L.calculationCache.setValue(L.projectName,"Banquet Revenue Assumptions","Gross",L.year,L.label,T);break;case"net_amount":T=wt(g,q);break;case"amount_per_event":T=yt(g);break;case"amount_per_pax":T=kt(g);break;case"avg_pax_per_event":T=jt(g);break;default:T=Ee(i,t,o,x,m)}return T}function $e(i){return O(this,null,function*(){if(U.value.some(t=>t.code===i.code)){if(!confirm("Are you sure you want to delete this custom banquet detail? This action cannot be undone."))return;try{yield fetch(`/api/resource/Banquet Details/${i.code}`,{method:"DELETE"}),yield ee(),D.success("Banquet detail deleted")}catch(t){D.error("Failed to delete banquet detail")}}else H.value.push(i.code)})}function ze(){H.value=[],D.success("Default fields have been restored.")}const le=be(()=>{const i=Ae.findIndex(x=>x.code==="others"),t=Ae.filter(x=>!H.value.includes(x.code)),o=U.value.filter(x=>!H.value.includes(x.code));return i===-1?[...t,...o]:[...t.slice(0,i),...o,...t.slice(i)]});return(i,t)=>(d(),c(j,null,[e("div",Nt,[b(vt),e("div",Dt,[e("div",Vt,[e("div",{class:P(["bg-gradient-to-b from-white to-gray-50 border-r border-gray-200 min-h-screen flex flex-col shadow-sm transition-all duration-300",C.value?"w-14 p-2":"w-80 p-6"])},[e("button",{onClick:t[0]||(t[0]=o=>C.value=!C.value),class:"mb-4 flex items-center gap-2 px-2 py-1 bg-violet-100 hover:bg-violet-200 rounded transition-all"},[C.value?(d(),te(l(we),{key:1,class:"w-5 h-5 text-violet-700"})):(d(),te(l(lt),{key:0,class:"w-5 h-5 text-violet-700"})),C.value?F("",!0):(d(),c("span",Yt,"Collapse"))]),b(ce,{name:"fade"},{default:de(()=>[X(e("div",null,[e("div",Lt,[e("div",Pt,[e("div",Rt,[b(l(mt),{class:"w-7 h-7 mx-2 text-white"})]),t[6]||(t[6]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Banquet Revenue Assumptions",-1))]),t[7]||(t[7]=e("p",{class:"text-sm text-gray-500"},"Manage and configure your banquet revenue data",-1))]),e("div",Ot,[e("div",It,[e("div",Jt,[u.value?(d(),c("div",$t,t[9]||(t[9]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),w(" All Saved ")]))):(d(),c("div",Ut,t[8]||(t[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1),w(" Unsaved ")])))]),!f.value&&!u.value?(d(),c("button",{key:0,disabled:f.value,onClick:Ie,class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-lg hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})],-1),w(" Save ")]),8,zt)):F("",!0),f.value?(d(),c("button",Ht,t[11]||(t[11]=[e("svg",{class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),w(" Saving... ")]))):F("",!0)]),M.value?(d(),c("span",Gt,[t[12]||(t[12]=e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),w(" "+N(M.value),1)])):F("",!0)]),e("div",Qt,[t[15]||(t[15]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},[e("svg",{class:"w-4 h-4 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})]),w(" Quick Actions ")],-1)),C.value?F("",!0):(d(),c("div",Wt,[e("div",Xt,[b(l(pe),{class:"w-6 h-6 text-red-600"}),t[13]||(t[13]=e("span",null,"All figures shown exclude taxes.",-1))])])),e("div",Kt,[e("button",{onClick:Je,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-violet-200 text-violet-700 rounded-lg hover:bg-violet-50 transition-all text-sm font-medium"},[b(l(it),{class:"w-4 h-4"}),t[14]||(t[14]=w(" Refresh "))])])]),e("div",Zt,[e("div",eo,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})]),w(" Year Range Filter ")],-1)),e("div",to,[e("div",oo,[e("div",null,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},[e("svg",{class:"w-3 h-3 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),w(" From Year ")],-1)),X(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>_e(k)?k.value=o:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-sm"},[t[16]||(t[16]=e("option",{value:""},"Select Year",-1)),(d(!0),c(j,null,I(n.value,o=>(d(),c("option",{key:"from-"+o,value:o},N(o),9,so))),128))],512),[[ue,l(k)]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},[e("svg",{class:"w-3 h-3 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),w(" To Year ")],-1)),X(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>_e(E)?E.value=o:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-sm"},[t[18]||(t[18]=e("option",{value:""},"Select Year",-1)),(d(!0),c(j,null,I(n.value,o=>(d(),c("option",{key:"to-"+o,value:o},N(o),9,no))),128))],512),[[ue,l(E)]])])]),e("div",ro,[e("button",{onClick:Re,class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all duration-200 text-sm font-medium"},t[20]||(t[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),w(" Clear ")])),e("button",{onClick:t[3]||(t[3]=o=>p.value=!0),class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-white border border-violet-500 text-violet-700 rounded-lg hover:bg-violet-50 transition-all duration-200 text-sm font-medium"},t[21]||(t[21]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),w(" Advanced ")]))])])])])],512),[[nt,!C.value]])]),_:1})],2),e("div",ao,[l(y)?Y.value.length&&J.value?(d(),c(j,{key:1},[e("div",uo,[e("div",vo,[e("div",mo,[b(l(dt),{class:"w-3 h-3 text-white"})]),t[26]||(t[26]=e("h2",{class:"text-lg font-bold text-gray-800"},"Banquet Revenue Assumptions Overview",-1))]),e("div",po,[e("button",{onClick:t[4]||(t[4]=o=>z.value=!0),disabled:!l(y),class:P(["px-3 py-1.5 text-sm font-medium shadow rounded-md transition-all",l(y)?"bg-violet-600 text-white hover:bg-violet-700":"bg-gray-400 text-gray-200 cursor-not-allowed"])}," Add Banquet Detail ",10,go),e("button",{onClick:ze,class:"px-3 py-1.5 bg-gray-500 text-white rounded hover:bg-gray-600 text-sm font-medium shadow transition-all"}," Reset to Default ")])]),e("div",fo,[e("div",xo,[e("div",ho,[e("table",bo,[e("thead",_o,[e("tr",null,[e("th",wo,[e("div",yo,[b(l(pt),{class:"w-3 h-3"}),t[27]||(t[27]=w(" Banquet Details "))])]),(d(!0),c(j,null,I(Y.value,o=>(d(),c("th",{key:"header-"+o,colspan:l(G)(o)?1:$(o).length+1,class:"px-2 py-2 text-center border-x-2 border-white cursor-pointer select-none hover:bg-violet-700 transition-all duration-200 group text-sm",onClick:x=>l(xt)(o),title:"Click to collapse/expand"},[e("div",jo,[e("span",Co,N(o),1),l(G)(o)?(d(),te(l(we),{key:1,class:"w-3 h-3 transition-transform group-hover:scale-110"})):(d(),te(l(gt),{key:0,class:"w-3 h-3 transition-transform group-hover:scale-110"}))])],8,ko))),128))]),e("tr",Ao,[(d(!0),c(j,null,I(Y.value,o=>(d(),c(j,{key:"months-"+o},[l(G)(o)?(d(),c("th",Bo,t[29]||(t[29]=[e("div",{class:"flex items-center justify-center gap-1"}," Forecast ",-1)]))):(d(),c(j,{key:0},[(d(!0),c(j,null,I($(o),x=>(d(),c("th",{key:o+"-"+x,class:"px-2 py-1 text-center border border-violet-300 min-w-[100px] font-medium"},N(x),1))),128)),t[28]||(t[28]=e("th",{class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},[e("div",{class:"flex items-center justify-center gap-1"}," Forecast ")],-1))],64))],64))),128))])]),e("tbody",So,[(d(!0),c(j,null,I(le.value,(o,x)=>(d(),c(j,{key:o.code},[e("tr",{class:P(["transition-all duration-200 border-b border-gray-100",["gross","net_amount"].includes(o.code)?"bg-violet-700 text-white font-bold":"even:bg-gray-50 hover:bg-violet-50"])},[e("td",{class:P(["px-3 py-2 font-medium border-r border-violet-200 flex items-center justify-between",["gross","net_amount"].includes(o.code)?"bg-violet-700 text-white font-bold":"text-gray-600"])},[e("span",null,N(o.label),1),e("div",Fo,[["food","liquor","soft_drinks","hall_space_charges","gross","net_amount","amount_per_event","amount_per_pax","avg_pax_per_event"].includes(o.code)?(d(),c("span",qo," Auto ")):F("",!0),U.value.some(m=>m.code===o.code)?(d(),c("span",To," Custom ")):F("",!0),["gross","net_amount","advance_bal","amount_per_event","amount_per_pax","avg_pax_per_event"].includes(o.code)?F("",!0):(d(),c("button",{key:2,onClick:m=>$e(o),class:"ml-2 text-red-500 hover:text-red-700",title:"Delete"},t[30]||(t[30]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Mo))])],2),(d(!0),c(j,null,I(Y.value,m=>(d(),c(j,{key:"row-"+m+"-"+o.code},[l(G)(m)?(d(),c("td",{key:1,class:P(["px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50",["gross","net_amount"].includes(o.code)?"bg-violet-800 text-white font-bold":""])},[e("span",{class:P(["font-mono text-xs text-violet-700",["gross","net_amount"].includes(o.code)?"text-white":""])},N(l(oe)(o.code,l(Be)(r,o.code,m,l(B)[m]||a.value,$))),3)],2)):(d(),c(j,{key:0},[["food","liquor","soft_drinks","hall_space_charges","gross","net_amount","amount_per_event","amount_per_pax","avg_pax_per_event"].includes(o.code)?(d(!0),c(j,{key:0},I($(m),g=>(d(),c("td",{key:"cell-"+m+"-"+g,class:P(["px-2 py-1 text-right border border-violet-200 bg-gray-50 outline-none focus:ring-2 focus:ring-violet-500 transition-all duration-200 font-semibold select-none",["gross","net_amount"].includes(o.code)?"bg-violet-700 text-white font-bold":""])},[e("span",Eo,N(l(oe)(o.code,ge(r,o.code,m,g,l(B)[m]||a.value))),1)],2))),128)):(d(!0),c(j,{key:1},I($(m),g=>(d(),c("td",{key:"cell-editable-"+m+"-"+g,contenteditable:"true",class:P(["px-2 py-1 text-right border border-violet-200 hover:bg-violet-50 outline-none focus:ring-2 focus:ring-violet-500 transition-all duration-200",["gross","net_amount"].includes(o.code)?"bg-violet-700 text-white font-bold":""]),onInput:q=>l(Mt)({year:m,label:g,expense:o.code,event:q,banquetData:r}),onFocus:q=>l(Et)({year:m,label:g,expense:o.code,event:q}),onBlur:q=>Oe({year:m,label:g,expense:o.code,event:q})},[e("span",Do,N(l(oe)(o.code,ge(r,o.code,m,g,l(B)[m]||a.value))),1)],42,No))),128)),e("td",{class:P(["px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50",["gross","net_amount"].includes(o.code)?"bg-violet-800 text-white font-bold":""])},[e("span",{class:P(["font-mono text-xs text-violet-700",["gross","net_amount"].includes(o.code)?"text-white":""])},N(l(oe)(o.code,l(Be)(r,o.code,m,l(B)[m]||a.value,$))),3)],2)],64))],64))),128))],2),o.code==="avg_hall_space_charges_check"?(d(),c("tr",Vo,[e("td",{colspan:1+Y.value.reduce((m,g)=>m+(l(G)(g)?1:$(g).length+1),0),class:"h-10 font-bold text-xl text-violet-700 bg-violet-200 border px-2 py-2 m-0"}," Details ",8,Yo)])):F("",!0),o.code==="net_amount"?(d(),c("tr",Lo,[e("td",{colspan:1+Y.value.reduce((m,g)=>m+(l(G)(g)?1:$(g).length+1),0),class:"h-10 font-bold text-xl text-violet-700 bg-violet-200 border px-2 py-2 m-0"}," Statistics ",8,Po)])):F("",!0)],64))),128))])])])])])],64)):l(y)?(d(),c("div",Ro,[e("div",Oo,[b(l(ve),{class:"w-8 h-8 text-violet-500"})]),e("h3",Io,N(l(k)&&!l(E)?'Select "To Year"':!l(k)&&l(E)?'Select "From Year"':"No Years Selected"),1),e("p",Jo,N(l(k)&&!l(E)?"You have selected a From Year, now please select a To Year to display the expense table.":!l(k)&&l(E)?"You have selected a To Year, now please select a From Year to display the expense table.":'Please select both "From Year" and "To Year" in the left panel to display the expense table.'),1),e("div",Uo,[b(l(me),{class:"w-3 h-3"}),t[31]||(t[31]=e("span",null,"Use the filters on the left to get started",-1))])])):(d(),c("div",$o,[e("div",zo,[b(l(ve),{class:"w-8 h-8 text-violet-500"})]),t[33]||(t[33]=e("h3",{class:"text-lg text-violet-700 font-semibold mb-2"},"No Project Selected",-1)),t[34]||(t[34]=e("p",{class:"text-gray-500 text-center max-w-md leading-relaxed text-sm"}," Please select a project from the dashboard to view and manage banquet revenue assumptions. ",-1)),e("div",Ho,[b(l(me),{class:"w-3 h-3"}),t[32]||(t[32]=e("span",null,"Use the project selector in the dashboard to get started",-1))])])):(d(),c("div",lo,[e("div",io,[b(l(ve),{class:"w-8 h-8 text-violet-500"})]),t[24]||(t[24]=e("h3",{class:"text-lg text-violet-700 font-semibold mb-2"},"No Project Selected",-1)),t[25]||(t[25]=e("p",{class:"text-gray-500 text-center max-w-md leading-relaxed text-sm"}," Please select a project from the dashboard to view and manage banquet revenue assumptions. ",-1)),e("div",co,[b(l(me),{class:"w-3 h-3"}),t[23]||(t[23]=e("span",null,"Use the project selector in the dashboard to get started",-1))])]))])])])]),b(ce,{name:"fade"},{default:de(()=>[p.value?(d(),c("div",Go,[e("div",Qo,[e("div",Wo,[b(l(ye),{class:"w-6 h-6 text-white"}),t[35]||(t[35]=e("h2",{class:"text-xl font-bold text-white"},"Advanced Display Mode Settings",-1))]),e("div",Xo,[Y.value.length?F("",!0):(d(),c("div",Ko,[b(l(pe),{class:"w-6 h-6 text-yellow-600"}),t[36]||(t[36]=e("span",{class:"text-yellow-800 font-medium"},'Please select both \\"From Year\\" and \\"To Year\\" to configure advanced settings.',-1))])),Y.value.length?(d(),c("div",Zo,[(d(!0),c(j,null,I(Y.value,o=>(d(),c("div",{key:"adv-"+o,class:"flex justify-between items-center border-b pb-2"},[e("span",es,[b(l(ct),{class:"w-4 h-4 text-violet-600"}),w(" "+N(o),1)]),X(e("select",{"onUpdate:modelValue":x=>v.value[o]=x,class:"px-6 py-2 border rounded-md focus:ring-violet-500"},t[37]||(t[37]=[e("option",{value:"monthly"},"Monthly",-1),e("option",{value:"quarterly"},"Quarterly",-1)]),8,ts),[[ue,v.value[o]]])]))),128))])):F("",!0)]),e("div",os,[e("button",{onClick:Ye,class:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 flex items-center gap-2"},[b(l(je),{class:"w-4 h-4"}),t[38]||(t[38]=w(" Cancel "))]),Y.value.length?(d(),c("button",{key:0,onClick:Ve,class:"px-4 py-2 rounded-md bg-violet-600 text-white hover:bg-violet-700 flex items-center gap-2"},[b(l(ke),{class:"w-4 h-4"}),t[39]||(t[39]=w(" Apply "))])):F("",!0)])])])):F("",!0)]),_:1}),b(ce,{name:"fade"},{default:de(()=>[z.value?(d(),c("div",ss,[e("div",ns,[e("div",rs,[b(l(ye),{class:"w-6 h-6 text-white"}),t[40]||(t[40]=e("h2",{class:"text-xl font-bold text-white"},"Add Banquet Detail",-1))]),e("div",as,[l(y)?(d(),c("div",is,[t[42]||(t[42]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Banquet Detail",-1)),X(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>R.value=o),class:"w-full px-3 py-2 border rounded focus:ring-violet-500",placeholder:"e.g. Decoration"},null,512),[[rt,R.value]])])):(d(),c("div",ls,[b(l(pe),{class:"w-6 h-6 text-yellow-600"}),t[41]||(t[41]=e("span",{class:"text-yellow-800 font-medium"},"Please select a project first to add banquet details.",-1))]))]),e("div",ds,[e("button",{onClick:Le,class:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 flex items-center gap-2"},[b(l(je),{class:"w-4 h-4"}),t[43]||(t[43]=w(" Cancel "))]),e("button",{onClick:Pe,disabled:!l(y)||!R.value,class:P(["px-4 py-2 rounded-md flex items-center gap-2",l(y)&&R.value?"bg-violet-600 text-white hover:bg-violet-700":"bg-gray-400 text-gray-200 cursor-not-allowed"])},[b(l(ke),{class:"w-4 h-4"}),t[44]||(t[44]=w(" Add "))],10,cs)])])])):F("",!0)]),_:1})],64))}},ws=Ze(us,[["__scopeId","data-v-343177e2"]]);export{ws as default};
