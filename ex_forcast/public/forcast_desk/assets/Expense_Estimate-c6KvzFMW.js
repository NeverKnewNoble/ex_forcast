var Ct=Object.defineProperty;var Ue=Object.getOwnPropertySymbols;var Ft=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable;var Me=(c,p,l)=>p in c?Ct(c,p,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[p]=l,Ee=(c,p)=>{for(var l in p||(p={}))Ft.call(p,l)&&Me(c,l,p[l]);if(Ue)for(var l of Ue(p))jt.call(p,l)&&Me(c,l,p[l]);return c};var B=(c,p,l)=>new Promise((m,a)=>{var u=g=>{try{b(l.next(g))}catch(x){a(x)}},h=g=>{try{b(l.throw(g))}catch(x){a(x)}},b=g=>g.done?m(g.value):Promise.resolve(g.value).then(u,h);b((l=l.apply(c,p)).next())});import{q as L,E as de,_ as ge,r as At,c as r,o as n,b as e,e as v,u as s,w as fe,d as _,v as F,h as k,K as Dt,l as Se,p as te,L as Ie,m as Tt,n as Vt,J as Rt,t as Oe,j as le,i as X,B as $,M as Pe,F as y,x as j,N as z,O as Be,T as Ce,C as Fe}from"./index-DFp4WPHj.js";import{u as Yt,a as $t,C as je}from"./useCalculationCache-BtZyymO0.js";import{c as O,_ as Lt,e as pe,T as ze,b as Ae,R as Nt,X as ne,S as qe,C as Ke,d as Ut}from"./SettingsModal-D-D5AQet.js";import{g as Re,a as tt,c as Mt,b as It,d as Ot,s as ve,t as Pt,i as G,e as We,f as me,h as R,r as Bt,j as Xe,k as zt,l as qt,m as Kt}from"./advanced_settings-BeZtrwoj.js";import{l as De,a as re,b as ie,e as Te,c as Wt}from"./data_service-BOTCsL4b.js";import{c as ue,T as Xt}from"./cloneDeep-CauuWUtY.js";import{m as Ht}from"./filter_utils-BPZXPN_G.js";import{g as He,a as Qt}from"./expense_options-D3LBylt9.js";import{a as Jt}from"./payroll_data_service-AdR1_91F.js";import{F as Zt}from"./folder-open-DRdD7xRy.js";import{A as ot}from"./arrow-left-CHuuvpyq.js";import{c as xe}from"./createLucideIcon-D8X7RiyU.js";import{P as oe}from"./plus-Q6-mjf1P.js";import{E as Gt}from"./ExpenseErrorState-CH34bZk9.js";import{C as st,a as Qe}from"./circle-alert-CbaxY-0D.js";import{a as Je}from"./index-CQjpnSxs.js";import{C as eo}from"./chevron-left-Ct-jXL2q.js";import{S as to}from"./save-CWxizgNn.js";import{L as oo}from"./loader-circle-jaT7itjR.js";import{F as so}from"./funnel-CgUkICxt.js";import{R as ao}from"./rotate-ccw-CVymyNdy.js";import{B as lo}from"./building-C8CEir6l.js";import{C as no}from"./circle-plus-Dc3_pxg8.js";import{T as ro}from"./trash-2-UAPbMQqy.js";import"./zap-BeFUdqHw.js";/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=xe("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=xe("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=xe("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=xe("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);//! Helper function to find expense details from data
function uo(c,p,l,m){var b;const u=(((b=c==null?void 0:c[l])==null?void 0:b[m])||[]).find(g=>g.expense===p);if(u)return{department:u.department||"",department_location:u.department_location||"",hospitality_category:u.hospitality_category||"",cost_type:u.cost_type||""};const h=(c==null?void 0:c[l])||{};for(const g in h){const E=(h[g]||[]).find(N=>N.expense===p);if(E)return{department:E.department||"",department_location:E.department_location||"",hospitality_category:E.hospitality_category||"",cost_type:E.cost_type||""}}for(const g in c){const x=c[g]||{};for(const E in x){const U=(x[E]||[]).find(V=>V.expense===p);if(U)return{department:U.department||"",department_location:U.department_location||"",hospitality_category:U.hospitality_category||"",cost_type:U.cost_type||""}}}return{department:"",department_location:"",hospitality_category:"",cost_type:""}}//! Helper function to check if an expense is a default expense
function co(c,p,l=null){if(!Array.isArray(p)||typeof p.some!="function")return console.warn("defaultExpenses is not an array:",p),!1;try{return l?p.some(m=>m.expense===c&&m.department===l):p.some(m=>m.expense===c)}catch(m){return console.error("Error checking if expense is default:",m),!1}}//! Helper function to get expense details from either default expenses or regular expense data
function po(c,p,l,m,a,u=null){let h;if(u?h=a.find(g=>g.expense===c&&g.department===u):h=a.find(g=>g.expense===c),h)return{department:h.department||"",department_location:h.department_location||"",cost_type:h.cost_type||"",hospitality_category:h.hospitality_category||""};const b=uo(m,c,p,l);return{department:b.department||"",department_location:b.department_location||"",cost_type:b.cost_type||"",hospitality_category:b.hospitality_category||""}}function vo(g,x,E,N,U,V,M){return B(this,arguments,function*(c,p,l,m,a,u,h,b=[]){var q,A;if(c.value.length===0)return;Array.isArray(b)||(console.warn("defaultExpenses is not an array, converting to empty array:",b),b=[]);const P=L.value;if(!P){O.error("No project selected. Please select a project first.");return}p.value=!0,l.value="";try{const K=c.value.map(T=>{const Q=po(T.expense,T.year,T.label,m.value,b,T.department),ee=co(T.expense,b,T.department),J=T.department||Q.department;return{year:T.year,month:T.label,expense:T.expense,amount:parseFloat(T.newValue),department:J,department_location:Q.department_location,cost_type:Q.cost_type,hospitality_category:Q.hospitality_category,is_default_expense:ee}}),S=yield(yield fetch("/api/method/ex_forcast.api.expense_estimate.upsert_expense_items",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":de()},body:JSON.stringify({changes:K,project:P.project_name})})).json();if(((q=S.message)==null?void 0:q.status)==="success"){O.success("Changes saved successfully!"),u.value=!0,c.value=[];const T=yield h();m.value=T,a.value=ue(T)}else{const T=typeof((A=S.message)==null?void 0:A.message)=="string"?S.message.message:"Save failed.";O.error(T)}}catch(K){const I=typeof K.message=="string"?K.message:"Save failed.";O.error(I)}finally{p.value=!1}})}function mo(c,p,l){if(!p||!p.value||!p.value.rows){console.warn("addExpenseForm is not properly initialized");return}const m=p.value.rows[c];if(!m){console.warn(`Row at index ${c} not found`);return}let a=m.amountDisplay;a=a.replace(/[^\d.]/g,"");const u=a.split(".");if(u.length>2&&(a=u[0]+"."+u.slice(1).join("")),!a.includes(".")||u.length===2&&u[1].length===2){u.length===2&&u[1].length>2&&(a=u[0]+"."+u[1].substring(0,2));const g=(parseFloat(a)||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});if(g!==l.target.innerText){l.target.innerText=g;const x=document.createRange(),E=window.getSelection(),N=l.target.firstChild||l.target;x.setStart(N,N.textContent.length),x.collapse(!0),E.removeAllRanges(),E.addRange(x)}}else a!==l.target.innerText&&(l.target.innerText=a)}function fo(c,p){if(!p||!p.value||!p.value.rows){console.warn("addExpenseForm is not properly initialized");return}const l=p.value.rows[c];if(!l){console.warn(`Row at index ${c} not found`);return}const m=parseFloat(l.amountDisplay.replace(/[^\d.]/g,""))||0;l.amountDisplay=m.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),l.amount=m}function Ye(c){return["Cost of Beverage sales","Cost of Food sales"].includes(c)}function go({year:c,label:p,expense:l,event:m,originalExpenseData:a,changedCells:u,expenseData:h,isSaved:b,department:g=null}){var V,M,P,q;let x=m.target.innerText.replace(/,/g,"").trim();Ye(l)?(x=x.replace(/%/g,"").trim(),x===""&&(x="0.00"),x=((parseFloat(x)||0)/100).toFixed(4)):(x===""&&(x="0.00"),x=(parseFloat(x)||0).toFixed(2));let E="0.00";const U=(((M=(V=a.value)==null?void 0:V[c])==null?void 0:M[p])||[]).find(A=>A.expense===l&&(!g||A.department===g));if(U&&(E=parseFloat(U.amount).toFixed(2)),x!==E){b.value=!1;const A=u.value.findIndex(S=>S.year===c&&S.label===p&&S.expense===l);A!==-1?(u.value[A].newValue=x,g&&!u.value[A].department&&(u.value[A].department=g)):u.value.push({year:c,label:p,expense:l,newValue:x,department:g});const I=(((q=(P=h.value)==null?void 0:P[c])==null?void 0:q[p])||[]).find(S=>S.expense===l&&(!g||S.department===g));I&&(I.amount=parseFloat(x))}else u.value=u.value.filter(A=>!(A.year===c&&A.label===p&&A.expense===l)),u.value.length===0&&(b.value=!0)}function xo({year:c,label:p,expense:l,event:m}){let a=m.target.innerText;if(Ye(l)){a=a.replace(/[^\d.]/g,"");const u=a.split(".");u.length>2&&(a=u[0]+"."+u.slice(1).join("")),u.length===2&&u[1].length>2&&(a=u[0]+"."+u[1].substring(0,2));const b=(parseFloat(a)||0).toFixed(2);if(b!==m.target.innerText){m.target.innerText=b;const g=document.createRange(),x=window.getSelection(),E=m.target.firstChild||m.target;g.setStart(E,E.textContent.length),g.collapse(!0),x.removeAllRanges(),x.addRange(g)}}else{a=a.replace(/[^\d.]/g,"");const u=a.split(".");if(u.length>2&&(a=u[0]+"."+u.slice(1).join("")),!a.includes(".")||u.length===2&&u[1].length===2){u.length===2&&u[1].length>2&&(a=u[0]+"."+u[1].substring(0,2));const g=(parseFloat(a)||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});if(g!==m.target.innerText){m.target.innerText=g;const x=document.createRange(),E=m.target.firstChild||m.target;x.setStart(E,E.textContent.length),x.collapse(!0);const N=window.getSelection();N.removeAllRanges(),N.addRange(x)}}else a!==m.target.innerText&&(m.target.innerText=a)}}function bo({year:c,label:p,expense:l,event:m}){let a=m.target.innerText;if(Ye(l)){const b=a.replace(/%/g,"");m.target.innerText=b}else{const b=a.replace(/,/g,"");m.target.innerText=b}const u=document.createRange(),h=window.getSelection();u.selectNodeContents(m.target),h.removeAllRanges(),h.addRange(u)}function ho(c,p,l,m,a){let u=0;for(const h of p.locations)for(const b of h.expenses){const g=Re(c,b,l,m,a,p.department),x=parseFloat(g.toString().replace(/,/g,""));isNaN(x)||(u+=x)}return u.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}function et(c,p,l,m){const a=tt(m);let u=0;for(const h of p.locations)for(const b of h.expenses)for(const g of a){const x=Re(c,b,l,g,m,null),E=parseFloat(x.toString().replace(/,/g,""));isNaN(E)||(u+=E)}return u.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}function yo(c,p,l,m,a,u){return B(this,null,function*(){var N;const{year:h,month:b,rows:g}=c.value;if(!h||!b||g.length===0){a.error("Please select year, month, and add at least one expense.");return}const x=g.filter(U=>U.expense&&U.amount>0),E=yield Mt({year:h,month:b,expenses:x});E.success?(a.success(`Expense document created successfully: ${E.name}`),p.value=!1,l(),u&&(yield u()),m.value=!0):a.error("Failed to create document: "+(((N=E.error)==null?void 0:N.message)||E.error))})}const wo={class:"flex flex-col items-center justify-center h-96"},_o={class:"w-24 h-24 bg-gradient-to-br from-violet-100 to-violet-200 rounded-full flex items-center justify-center mb-6"},ko={__name:"ExpenseNoProjectSelectedState",setup(c){return(p,l)=>{const m=At("router-link");return n(),r("div",wo,[e("div",_o,[v(s(Zt),{class:"w-12 h-12 text-violet-600"})]),l[1]||(l[1]=e("h3",{class:"text-xl font-semibold text-gray-800 mb-2"},"No Project Selected",-1)),l[2]||(l[2]=e("p",{class:"text-gray-600 mb-6 text-center max-w-md"}," Please go to the Dashboard and select a project to view and manage expense data. ",-1)),v(m,{to:"/dashboard",class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-violet-500 to-violet-600 text-white rounded-lg hover:from-violet-600 hover:to-violet-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},{default:fe(()=>[v(s(ot),{class:"w-4 h-4"}),l[0]||(l[0]=_(" Go to Dashboard ",-1))]),_:1,__:[0]})])}}},Eo=ge(ko,[["__scopeId","data-v-354a2736"]]),So={class:"flex flex-col items-center justify-center h-96"},Co={class:"w-24 h-24 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center mb-6"},Fo={class:"text-gray-600 mb-6 text-center max-w-md"},jo={class:"font-semibold text-violet-600"},Ao={__name:"NoDataState",props:{project:{type:String,default:""}},emits:["add-expense"],setup(c){return(p,l)=>(n(),r("div",So,[e("div",Co,[v(s(Ve),{class:"w-12 h-12 text-blue-600"})]),l[4]||(l[4]=e("h3",{class:"text-xl font-semibold text-gray-800 mb-2"},"No Expense Data Found",-1)),e("p",Fo,[l[1]||(l[1]=_(" The project ",-1)),e("span",jo,F(c.project),1),l[2]||(l[2]=_(" doesn't have any expense data yet. ",-1))]),e("button",{onClick:l[0]||(l[0]=m=>p.$emit("add-expense")),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-violet-500 to-violet-600 text-white rounded-lg hover:from-violet-600 hover:to-violet-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[v(s(oe),{class:"w-4 h-4"}),l[3]||(l[3]=_(" Add First Expense ",-1))])]))}},Do=ge(Ao,[["__scopeId","data-v-7e3d9036"]]),To={class:"flex flex-col items-center justify-center min-h-[400px] bg-white border-2 border-dashed border-violet-300 rounded-xl shadow-sm"},Vo={class:"w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center mb-4"},Ro={class:"text-lg text-violet-700 font-semibold mb-2"},Yo={class:"text-gray-500 text-center max-w-md leading-relaxed text-sm"},$o={class:"mt-4 flex items-center gap-2 text-xs text-violet-600"},Lo={__name:"ExpenseNoYearsSelectedState",props:{fromYear:{type:String,default:""},toYear:{type:String,default:""}},setup(c){return(p,l)=>(n(),r("div",To,[e("div",Vo,[v(s(st),{class:"w-8 h-8 text-violet-500"})]),e("h3",Ro,F(c.fromYear&&!c.toYear?'Select "To Year"':!c.fromYear&&c.toYear?'Select "From Year"':"No Years Selected"),1),e("p",Yo,F(c.fromYear&&!c.toYear?"You have selected a From Year, now please select a To Year to display the expense table.":!c.fromYear&&c.toYear?"You have selected a To Year, now please select a From Year to display the expense table.":'Please select both "From Year" and "To Year" in the left panel to display the expense table.'),1),e("div",$o,[v(s(ot),{class:"w-3 h-3"}),l[0]||(l[0]=e("span",null,"Use the filters on the left to get started",-1))])]))}},No=ge(Lo,[["__scopeId","data-v-31be40da"]]),Uo={class:"flex"},Mo={class:"flex-1 min-h-screen bg-gradient-to-br from-white to-violet-50"},Io={class:"flex"},Oo={key:2,class:"text-violet-700 text-sm font-medium dark:text-white"},Po={class:"mb-8"},Bo={class:"flex items-center gap-3 mb-2"},zo={class:"w-12 h-12 bg-gradient-to-br from-violet-500 to-violet-600 rounded-xl flex items-center justify-center shadow-lg"},qo={class:"bg-white rounded-xl p-4 mb-6 border border-gray-200 shadow-sm"},Ko={class:"flex items-center justify-between"},Wo={class:"flex items-center gap-2"},Xo={key:0,class:"flex items-center gap-2 text-sm font-medium text-red-600 bg-red-50 px-3 py-2 rounded-lg border border-red-200"},Ho={key:1,class:"flex items-center gap-2 text-sm font-medium text-green-600 bg-green-50 px-3 py-2 rounded-lg border border-green-200"},Qo=["disabled"],Jo={key:1,class:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg cursor-not-allowed"},Zo={key:0,class:"mt-2 text-xs text-red-500 flex items-center gap-1"},Go={class:"mb-8"},es={class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},ts={class:"flex gap-2 mt-3"},os={class:"flex-1"},ss={class:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm"},as={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},ls={class:"space-y-4"},ns={class:"grid grid-cols-2 gap-3"},rs={class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},is=["value"],ds={class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},us=["value"],cs={class:"flex gap-2"},ps={class:"flex-1 p-4"},vs={key:0},ms={key:1},fs={key:2},gs={class:"mb-4"},xs={class:"flex items-center gap-2"},bs={class:"flex items-center gap-2"},hs={class:"w-6 h-6 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},ys={class:"mt-2"},ws={class:"bg-white rounded-lg border border-violet-200 shadow-sm overflow-hidden md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px]"},_s={class:"overflow-x-auto max-w-[100%] md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px]"},ks={class:"min-w-full w-max"},Es={class:"w-full"},Ss={class:"bg-gradient-to-r from-violet-600 to-violet-700 text-white"},Cs={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},Fs={class:"flex items-center gap-1"},js={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},As={class:"flex items-center gap-1"},Ds={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},Ts={class:"flex items-center gap-1"},Vs=["colspan","onClick"],Rs={class:"flex items-center justify-center gap-1"},Ys={class:"font-semibold"},$s={class:"bg-violet-500/90 text-xs"},Ls={class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},Ns={class:"flex items-center justify-center gap-1"},Us={key:1,class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},Ms={class:"flex items-center justify-center gap-1"},Is={class:"text-gray-700 bg-white text-sm"},Os={class:"bg-gradient-to-r from-violet-600 to-violet-700 border-b-2 border-violet-800"},Ps={colspan:"3",class:"px-3 py-3 font-bold text-white border-r border-violet-500"},Bs={class:"flex items-center gap-2"},zs={key:1,class:"px-1 py-1 text-center border border-violet-500 bg-violet-600"},qs={class:"bg-gradient-to-r from-violet-100 to-violet-200 border-b border-violet-300 dark:from-violet-800/40 dark:to-violet-700/40 dark:border-violet-600"},Ks={colspan:"3",class:"px-6 py-2 font-semibold text-violet-700 dark:text-white border-r border-violet-300 dark:border-violet-600"},Ws={class:"flex items-center gap-2"},Xs={key:1,class:"px-1 py-1 text-center border border-violet-300 bg-violet-100 dark:border-violet-600 dark:bg-violet-800/30"},Hs={class:"px-8 py-2 font-medium border-r border-violet-200 text-gray-600 dark:text-gray-300 dark:border-violet-700"},Qs={class:"flex items-center gap-1"},Js={class:"px-3 py-2 font-medium border-r border-violet-200 dark:border-violet-700"},Zs={class:"flex items-center justify-between gap-2"},Gs=["onClick"],ea={class:"px-3 py-2 font-medium border-r border-violet-200 text-gray-600"},ta={class:"flex items-center gap-1"},oa=["onInput","onFocus","onBlur"],sa={class:"text-xs"},aa={class:"px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50 dark:border-violet-700 dark:bg-violet-900/20"},la={class:"text-xs text-violet-700 dark:text-violet-300"},na={key:1,class:"px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50 dark:border-violet-700 dark:bg-violet-900/20"},ra={class:"text-xs text-violet-700 dark:text-violet-300"},ia={class:"bg-gradient-to-r from-violet-200 to-violet-300 border-y-2 border-violet-500"},da={colspan:"3",class:"px-3 py-2 font-bold text-violet-900 border-r border-violet-400"},ua={class:"flex items-center gap-1"},ca={class:"text-xs"},pa={class:"px-2 py-1 text-right border border-violet-400 bg-violet-200 font-bold text-violet-900 dark:border-violet-600 dark:bg-violet-800/30 dark:text-violet-200"},va={class:"text-xs"},ma={key:1,class:"px-2 py-1 text-right border border-violet-400 bg-violet-200 font-bold text-violet-900 dark:border-violet-600 dark:bg-violet-800/30 dark:text-violet-200"},fa={class:"text-xs"},ga={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm"},xa={class:"bg-white rounded-2xl shadow-2xl border border-violet-200 w-[95%] max-w-lg p-0 overflow-hidden"},ba={class:"flex items-center gap-3 px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},ha={class:"p-8 pt-6"},ya={key:0,class:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center gap-3"},wa={key:1,class:"space-y-4 max-h-[50vh] overflow-auto pr-2"},_a={class:"font-medium text-gray-700 flex items-center gap-2"},ka=["onUpdate:modelValue"],Ea={class:"flex justify-end gap-3 px-8 py-4 bg-gray-50 border-t border-violet-100"},Sa={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm"},Ca={class:"bg-white rounded-2xl shadow-2xl border border-violet-100 w-[95%] max-w-4xl max-h-[90vh] overflow-hidden flex flex-col"},Fa={class:"flex items-center justify-between px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},ja={class:"flex items-center gap-3"},Aa={class:"p-8 pb-0 space-y-6 overflow-y-auto max-h-[calc(90vh-140px)]"},Da={class:"grid grid-cols-2 gap-6"},Ta=["value"],Va=["value"],Ra={class:"mb-6"},Ya={class:"flex items-center gap-3"},$a={class:"w-8 h-8 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},La={class:"mt-3 space-y-4 p-4 bg-white border border-violet-200 rounded-lg shadow-sm"},Na={class:"flex items-center gap-3 mb-2"},Ua={class:"grid grid-cols-4 gap-3"},Ma=["value"],Ia=["disabled"],Oa={class:"space-y-4"},Pa={class:"space-y-4"},Ba={class:"flex items-center justify-between mb-4"},za={class:"text-lg font-semibold text-gray-800"},qa=["onClick","disabled"],Ka={class:"grid grid-cols-2 rounded-lg p-2 gap-6"},Wa=["onUpdate:modelValue"],Xa=["value"],Ha=["onUpdate:modelValue"],Qa=["value"],Ja=["onUpdate:modelValue"],Za=["value"],Ga=["onUpdate:modelValue"],el=["value"],tl=["onUpdate:modelValue","onInput","onBlur"],ol={class:"flex justify-between items-center pt-3 pb-3 border-t border-gray-200 bg-white sticky bottom-0"},sl={class:"flex gap-3"},al={__name:"Expense_Estimate",setup(c){const p=k([]),l=k("monthly"),m=k([]),a=k({}),u=k([]),h=k([]),b=k(!1),g=k({}),x=k([]),E=k(localStorage.getItem("hospitalityExperience")===null?!0:localStorage.getItem("hospitalityExperience")==="true"),N=k([]),U=k([]),V=k(!1),M=k({}),P=k(new Set),q=k([]),A=k(!1),K=k("");k(!1),k(null);const I=k(!1);k(""),k(!1);const S=k({account_name:"",account_number:"",parent_account:""}),T=k(!1),Q=k([]),ee=k(!1);k(""),k("");const J=k([]),Z=k([]),be=k(!1),he=Yt(),{fromYear:se,toYear:ae,advancedModes:W}=Dt(he),{setFromYear:ll,setToYear:nl,setAdvancedModes:at,clearYearSettings:lt,getFilteredToYears:nt}=he,ye=$t(),D=Se(()=>It(se.value,ae.value)),rt=Se(()=>nt(p.value)),it=Se(()=>Ot(a.value,D.value,h.value));function dt(i){const t=new Set(P.value);t.add(i),P.value=t,V.value=!1}function ut(){try{M.value&&Object.keys(M.value).length&&(a.value=ue(M.value)),P.value=new Set,V.value=!1,O.info("Restored to original")}catch(i){}}function ct(i){const t=P.value;return(i||[]).filter(o=>!t.has(o))}const H=i=>i==="Default"?["Default"]:tt(W.value[i]||l.value),$e=i=>u.value.length>0?zt(u.value,i):qt(a.value,i,D.value,h.value);te(D,()=>{D.value.forEach(i=>{W.value[i]||he.setAdvancedMode(i,l.value)})}),te(E,i=>{localStorage.setItem("hospitalityExperience",i)}),setInterval(()=>{const i=localStorage.getItem("hospitalityExperience"),t=i===null?!0:i==="true";E.value!==t&&(E.value=t)},1e3),te(L,(i,t)=>B(this,null,function*(){var o;if(i&&i!==t)try{const f=yield De();f.status==="success"&&(u.value=f.expenses);const d=yield re();d.status==="success"&&(h.value=d.defaultExpenses),a.value=yield ie(),!a.value.status&&((o=L.value)!=null&&o.project_name)&&_e(a.value,L.value.project_name),a.value.status?(M.value=a.value,m.value=[]):(M.value=ue(a.value),m.value=Te(a.value)),q.value=[],V.value=!0,O.success(`Switched to project: ${i.project_name}`);try{J.value=yield Ie(i.project_name)}catch(C){J.value=[]}try{const w=yield(yield fetch("/api/method/ex_forcast.api.payroll_department_location_list.get_payroll_department_location_list",{headers:{"X-Frappe-CSRF-Token":de()}})).json();w.message&&w.message.success?Z.value=(w.message.locations||[]).map(Y=>Y.department_location||Y.name):Z.value=[]}catch(C){Z.value=[]}}catch(f){console.error("Error loading project data:",f),O.error("Failed to load project data. Please try again.")}}),{immediate:!0}),te(()=>{var i;return(i=L.value)==null?void 0:i.project_name},(i,t)=>B(this,null,function*(){if(i&&i!==t)try{const o=yield re();o.status==="success"&&(h.value=o.defaultExpenses)}catch(o){console.error("Error loading default expenses for project:",o)}}),{immediate:!0}),te(b,i=>{i&&(g.value=Ee({},W.value))});function pt(){at(Ee({},g.value)),b.value=!1}function vt(){b.value=!1}Tt(()=>B(this,null,function*(){var i,t;try{yield Vt(),p.value=yield Wt();const o=yield De();if(o.status==="success"&&(u.value=o.expenses),L.value){const w=yield re();w.status==="success"&&(h.value=w.defaultExpenses)}a.value=yield ie(),a.value.status?(M.value=a.value,m.value=[]):(M.value=ue(a.value),m.value=Te(a.value)),x.value=((i=yield He())==null?void 0:i.map(w=>({label:w,value:w})))||[];const f=yield Qt();N.value=f.hospitality_category.map(w=>({label:w,value:w})),U.value=f.cost_type.map(w=>({label:w,value:w}));const C=yield(yield fetch("/api/v2/method/ex_forcast.api.account_list.get_group_accounts",{headers:{"X-Frappe-CSRF-Token":de()}})).json();if(C.data&&C.data.group_accounts&&(Q.value=C.data.group_accounts),L&&L.value&&L.value.project_name)try{J.value=yield Ie(L.value.project_name)}catch(w){J.value=[]}try{yield Jt();const Y=yield(yield fetch("/api/method/ex_forcast.api.payroll_department_location_list.get_payroll_department_location_list",{headers:{"X-Frappe-CSRF-Token":de()}})).json();Y.message&&Y.message.success?Z.value=(Y.message.locations||[]).map(Ne=>Ne.department_location||Ne.name):Z.value=[]}catch(w){Z.value=[]}if(V.value=!0,localStorage.getItem("showRefreshSuccess")==="true"&&(localStorage.removeItem("showRefreshSuccess"),O.success("Page refreshed successfully")),(t=L.value)!=null&&t.project_name){const w=yield re();w.status==="success"&&(h.value=w.defaultExpenses)}}catch(o){console.error("Error loading data:",o)}}));function mt(){lt(),V.value=!1}function ft({year:i,label:t,expense:o,event:f,department:d}){go({year:i,label:t,expense:o,event:f,originalExpenseData:M,changedCells:q,expenseData:a,isSaved:V,department:d})}const gt=(i,t)=>{R&&R.value&&R.value.rows&&mo(i,R,t)},xt=i=>{R&&R.value&&R.value.rows&&fo(i,R)},bt=()=>B(this,null,function*(){R&&R.value&&(yield yo(R,ve,Kt,V,O,()=>B(this,null,function*(){var o;const i=yield De();i.status==="success"&&(u.value=i.expenses),(o=L.value)!=null&&o.project_name&&(a.value=yield ie(),a.value.status||_e(a.value,L.value.project_name));const t=yield re();t.status==="success"&&(h.value=t.defaultExpenses),a.value=yield ie(),a.value.status||(M.value=ue(a.value),m.value=Te(a.value))})))}),ht=()=>B(this,null,function*(){var i;yield vo(q,A,K,a,M,V,ie,h.value),(i=L.value)!=null&&i.project_name&&!a.value.status&&_e(a.value,L.value.project_name)});te(V,i=>{i?window.removeEventListener("beforeunload",we):window.addEventListener("beforeunload",we)});function we(i){if(!V.value)return i.preventDefault(),i.returnValue="You have unsaved changes that may be discarded if not saved. Are you sure you want to leave?",i.returnValue}Rt(()=>{window.removeEventListener("beforeunload",we)});function _e(i,t){try{if(!i||!t)return;ye.clearCache(t,"Expense Assumptions");for(const[o,f]of Object.entries(i))for(const[d,C]of Object.entries(f))C.forEach(w=>{if(w.expense&&w.amount&&w.department){const Y=parseFloat(w.amount);Y>0&&(ye.setValue(t,"Expense Assumptions",w.expense,o,d,Y),ye.setValue(t,`Expense Assumptions:${w.department}`,w.expense,o,d,Y))}})}catch(o){console.error("Error caching expense data:",o)}}function Le(){localStorage.setItem("showRefreshSuccess","true"),window.location.reload()}function yt(){return B(this,null,function*(){var i;if(!(!S.value.account_name.trim()||!S.value.account_number.trim()||!S.value.parent_account)){T.value=!0;try{const o=yield(yield fetch("/api/v2/method/ex_forcast.api.account_list.create_account",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":de()},body:JSON.stringify({account_name:S.value.account_name.trim(),account_number:S.value.account_number.trim(),parent_account:S.value.parent_account})})).json();o.data&&o.data.success?(O.success(`Account '${S.value.account_name.trim()}' created successfully!`),S.value={account_name:"",account_number:"",parent_account:""},x.value=((i=yield He())==null?void 0:i.map(f=>({label:f,value:f})))||[]):O.error(o.data&&o.data.error||o.error||"Failed to create account.")}catch(t){O.error("Failed to create account.")}finally{T.value=!1}}})}function wt(i){const t=i.which?i.which:i.keyCode;t>31&&(t<48||t>57)&&i.preventDefault()}function _t(i){i.preventDefault();const o=(i.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");S.value.account_number+=o}function kt(i){S.value.account_number=i.target.value.replace(/[^0-9]/g,"")}function Et(){be.value=!0}function St(){be.value=!1}function ce(i){return["Cost of Beverage sales","Cost of Food sales"].includes(i)}function ke(i,t){return ce(t)?`${(parseFloat(i)*100).toFixed(2)}%`:i}return(i,t)=>(n(),r(y,null,[e("div",Uo,[v(Lt,{onOpenSettings:Et}),e("div",Mo,[e("div",Io,[e("div",{class:Oe(["bg-gradient-to-b from-white to-gray-50 border-r border-gray-200 min-h-screen flex flex-col shadow-sm transition-all duration-300",I.value?"w-14 p-2":"w-80 p-6"])},[e("button",{onClick:t[0]||(t[0]=o=>I.value=!I.value),class:"mb-4 flex items-center gap-2 px-2 py-1 bg-violet-100 hover:bg-violet-200 rounded transition-all dark:bg-violet-900/30 dark:hover:bg-violet-800/40"},[I.value?(n(),le(s(Qe),{key:1,class:"w-5 h-5 text-violet-700 dark:text-white"})):(n(),le(s(eo),{key:0,class:"w-5 h-5 text-violet-700 dark:text-white"})),I.value?X("",!0):(n(),r("span",Oo,"Collapse"))]),v(Ce,{name:"fade"},{default:fe(()=>[$(e("div",null,[e("div",Po,[e("div",Bo,[e("div",zo,[v(s(pe),{class:"w-7 h-7 mx-2 text-white"})]),t[16]||(t[16]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Expense Assumptions",-1))]),t[17]||(t[17]=e("p",{class:"text-sm text-gray-500"},"Manage and configure your expense data",-1))]),e("div",qo,[e("div",Ko,[e("div",Wo,[V.value?(n(),r("div",Ho,[v(s(Ae),{class:"w-4 h-4 text-green-600"}),t[19]||(t[19]=_(" All Saved ",-1))])):(n(),r("div",Xo,[v(s(ze),{class:"w-4 h-4 text-red-600"}),t[18]||(t[18]=_(" Unsaved ",-1))]))]),!A.value&&!V.value?(n(),r("button",{key:0,disabled:A.value,onClick:ht,class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-lg hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[v(s(to),{class:"w-4 h-4"}),t[20]||(t[20]=_(" Save ",-1))],8,Qo)):X("",!0),A.value?(n(),r("button",Jo,[v(s(oo),{class:"w-4 h-4 animate-spin"}),t[21]||(t[21]=_(" Saving... ",-1))])):X("",!0)]),K.value?(n(),r("span",Zo,[v(s(st),{class:"w-3 h-3"}),_(" "+F(K.value),1)])):X("",!0)]),e("div",Go,[e("h3",es,[v(s(oe),{class:"w-4 h-4 text-violet-600"}),t[22]||(t[22]=_(" Quick Actions ",-1))]),e("button",{onClick:t[1]||(t[1]=o=>ve.value=!0),class:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-violet-500 to-violet-600 text-white rounded-xl hover:from-violet-600 hover:to-violet-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 font-medium"},[v(s(oe),{class:"w-4 h-4"}),t[23]||(t[23]=_(" Add New Expense ",-1))]),e("div",ts,[e("button",{onClick:Le,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-violet-200 text-violet-700 dark:text-violet-300 rounded-lg hover:bg-violet-50 transition-all text-sm font-medium"},[v(s(Nt),{class:"w-4 h-4"}),t[24]||(t[24]=_(" Refresh ",-1))])])]),e("div",os,[e("div",ss,[e("h3",as,[v(s(so),{class:"w-5 h-5 text-violet-600"}),t[25]||(t[25]=_(" Year Range Filter ",-1))]),e("div",ls,[e("div",ns,[e("div",null,[e("label",rs,[v(s(je),{class:"w-3 h-3 text-gray-500"}),t[26]||(t[26]=_(" From Year ",-1))]),$(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>Pe(se)?se.value=o:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-sm"},[t[27]||(t[27]=e("option",{value:""},"Select Year",-1)),(n(!0),r(y,null,j(p.value,o=>(n(),r("option",{key:"from-"+o,value:o},F(o),9,is))),128))],512),[[z,s(se)]])]),e("div",null,[e("label",ds,[v(s(je),{class:"w-3 h-3 text-gray-500"}),t[28]||(t[28]=_(" To Year ",-1))]),$(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>Pe(ae)?ae.value=o:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-sm"},[t[29]||(t[29]=e("option",{value:""},"Select Year",-1)),(n(!0),r(y,null,j(rt.value,o=>(n(),r("option",{key:"to-"+o,value:o},F(o),9,us))),128))],512),[[z,s(ae)]])])]),e("div",cs,[e("button",{onClick:mt,class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all duration-200 text-sm font-medium"},[v(s(ne),{class:"w-4 h-4"}),t[30]||(t[30]=_(" Clear ",-1))]),e("button",{onClick:t[4]||(t[4]=o=>b.value=!0),class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-white border border-violet-500 text-violet-700 dark:text-violet-300 rounded-lg hover:bg-violet-50 transition-all duration-200 text-sm font-medium"},[v(s(qe),{class:"w-4 h-4"}),t[31]||(t[31]=_(" Advanced ",-1))])])])])])],512),[[Be,!I.value]])]),_:1})],2),e("div",ps,[a.value.status==="no_project_selected"?(n(),r("div",vs,[v(Eo)])):a.value.status==="no_data"&&(!h.value||h.value.length===0)?(n(),r("div",ms,[v(Do,{project:a.value.project,onAddExpense:t[5]||(t[5]=o=>ve.value=!0)},null,8,["project"])])):a.value.status==="error"?(n(),r("div",fs,[v(Gt,{message:a.value.message,onRetry:Le},null,8,["message"])])):D.value.length?(n(),r(y,{key:3},[e("div",gs,[e("div",xs,[e("div",bs,[e("div",hs,[v(s(Xt),{class:"w-3 h-3 text-white"})]),t[32]||(t[32]=e("h2",{class:"text-lg font-bold text-gray-800"},"Expense Overview",-1))])]),e("div",ys,[e("button",{onClick:ut,class:"inline-flex items-center gap-2 px-3 py-1.5 bg-gray-500 text-white rounded-md hover:bg-gray-600 text-sm font-medium shadow-sm"},[v(s(ao),{class:"w-4 h-4"}),t[33]||(t[33]=_(" Restore ",-1))])])]),e("div",ws,[e("div",_s,[e("div",ks,[e("table",Es,[e("thead",Ss,[e("tr",null,[e("th",Cs,[e("div",Fs,[v(s(Ze),{class:"w-3 h-3"}),t[34]||(t[34]=_(" Code ",-1))])]),e("th",js,[e("div",As,[v(s(Ve),{class:"w-3 h-3"}),t[35]||(t[35]=_(" Expense ",-1))])]),e("th",Ds,[e("div",Ts,[v(s(Ge),{class:"w-3 h-3"}),t[36]||(t[36]=_(" Cost Type ",-1))])]),(n(!0),r(y,null,j(D.value.length>0?D.value:["Default"],o=>(n(),r("th",{key:"header-"+o,colspan:s(G)(o)?1:H(o).length+1,class:"px-2 py-2 text-center border-x-2 border-white cursor-pointer select-none hover:bg-violet-700 transition-all duration-200 group text-sm dark:border-gray-700 dark:text-white",onClick:f=>s(Pt)(o),title:"Click to collapse/expand"},[e("div",Rs,[e("span",Ys,F(o==="Default"?"Default":o),1),s(G)(o)?(n(),le(s(Qe),{key:1,class:"w-3 h-3 transition-transform group-hover:scale-110"})):(n(),le(s(Ke),{key:0,class:"w-3 h-3 transition-transform group-hover:scale-110"}))])],8,Vs))),128))]),e("tr",$s,[(n(!0),r(y,null,j(D.value.length>0?D.value:["Default"],o=>(n(),r(y,{key:"months-"+o},[s(G)(o)?(n(),r("th",Us,[e("div",Ms,[v(s(pe),{class:"w-2 h-2"}),t[38]||(t[38]=_(" Total ",-1))])])):(n(),r(y,{key:0},[(n(!0),r(y,null,j(H(o),f=>(n(),r("th",{key:o+"-"+f,class:"px-2 py-1 text-center border border-violet-300 min-w-[100px] font-medium"},F(f),1))),128)),e("th",Ls,[e("div",Ns,[v(s(pe),{class:"w-2 h-2"}),t[37]||(t[37]=_(" Total ",-1))])])],64))],64))),128))])]),e("tbody",Is,[(n(!0),r(y,null,j(it.value,o=>(n(),r(y,{key:"department-"+o.department},[e("tr",Os,[e("td",Ps,[e("div",Bs,[v(s(lo),{class:"w-4 h-4"}),_(" "+F(o.department),1)])]),(n(!0),r(y,null,j(D.value.length>0?D.value:["Default"],f=>(n(),r(y,{key:"department-header-"+f},[s(G)(f)?(n(),r("td",zs)):(n(),r(y,{key:0},[(n(!0),r(y,null,j(H(f),d=>(n(),r("td",{key:"department-cell-"+f+"-"+d,class:"px-1 py-1 text-center border border-violet-500 bg-violet-600"}))),128)),t[39]||(t[39]=e("td",{class:"px-1 py-1 text-center border border-violet-500 bg-violet-600"},null,-1))],64))],64))),128))]),(n(!0),r(y,null,j(o.locations,f=>(n(),r(y,{key:"location-"+f.location},[e("tr",qs,[e("td",Ks,[e("div",Ws,[v(s(io),{class:"w-3 h-3 dark:text-white"}),_(" "+F(f.location),1)])]),(n(!0),r(y,null,j(D.value.length>0?D.value:["Default"],d=>(n(),r(y,{key:"location-header-"+d},[s(G)(d)?(n(),r("td",Xs)):(n(),r(y,{key:0},[(n(!0),r(y,null,j(H(d),C=>(n(),r("td",{key:"location-cell-"+d+"-"+C,class:"px-1 py-1 text-center border border-violet-300 bg-violet-100 dark:border-violet-600 dark:bg-violet-800/30"}))),128)),t[40]||(t[40]=e("td",{class:"px-1 py-1 text-center border border-violet-300 bg-violet-100 dark:border-violet-600 dark:bg-violet-800/30"},null,-1))],64))],64))),128))]),(n(!0),r(y,null,j(ct(f.expenses),d=>(n(),r("tr",{key:"expense-"+d,class:"even:bg-gray-50 hover:bg-violet-50 transition-all duration-200 border-b border-gray-100 dark:even:bg-gray-800 dark:hover:bg-violet-900/20 dark:border-gray-700"},[e("td",Hs,[e("div",Qs,[v(s(Ze),{class:"w-2 h-2 text-gray-400"}),_(" "+F($e(d).code),1)])]),e("td",Js,[e("div",Zs,[e("span",null,F(d),1),e("button",{onClick:C=>dt(d),class:"text-red-600 hover:text-red-700",title:"Delete expense"},[v(s(ne),{class:"w-4 h-4"})],8,Gs)])]),e("td",ea,[e("div",ta,[v(s(Ge),{class:"w-2 h-2 text-gray-400"}),_(" "+F($e(d).costType),1)])]),(n(!0),r(y,null,j(D.value.length>0?D.value:["Default"],C=>(n(),r(y,{key:"row-"+C+"-"+d},[s(G)(C)?(n(),r("td",na,[e("span",ra,F(C==="Default"?ce(d)?"0.00%":"0.00":ke(s(We)(a.value,d,C,s(W)[C]||l.value,H,o.department),d)),1)])):(n(),r(y,{key:0},[(n(!0),r(y,null,j(H(C),w=>(n(),r("td",{key:"cell-"+C+"-"+w,contenteditable:"true",class:"px-2 py-1 text-right border border-violet-200 hover:bg-violet-50 focus:bg-white dark:border-violet-700 dark:hover:bg-violet-900/20 dark:focus:bg-gray-700 focus:outline-none focus:ring-1 focus:ring-violet-500 focus:border-transparent transition-all duration-200",onInput:Y=>s(xo)({year:C,label:w,expense:d,event:Y}),onFocus:Y=>s(bo)({year:C,label:w,expense:d,event:Y}),onBlur:Y=>ft({year:C,label:w,expense:d,event:Y,department:o.department})},[e("span",sa,F(C==="Default"?ce(d)?"0.00%":"0.00":ke(s(Re)(a.value,d,C,w,s(W)[C]||l.value,o.department),d)),1)],40,oa))),128)),e("td",aa,[e("span",la,F(C==="Default"?ce(d)?"0.00%":"0.00":ke(s(We)(a.value,d,C,s(W)[C]||l.value,H,o.department),d)),1)])],64))],64))),128))]))),128))],64))),128)),e("tr",ia,[e("td",da,[e("div",ua,[v(s(pe),{class:"w-3 h-3"}),t[41]||(t[41]=_(" Department Total ",-1))])]),(n(!0),r(y,null,j(D.value.length>0?D.value:["Default"],f=>(n(),r(y,{key:"department-total-"+f},[s(G)(f)?(n(),r("td",ma,[e("span",fa,F(f==="Default"?"0.00":s(et)(a.value,o,f,s(W)[f]||l.value)),1)])):(n(),r(y,{key:0},[(n(!0),r(y,null,j(H(f),d=>(n(),r("td",{key:"department-total-cell-"+f+"-"+d,class:"px-2 py-1 text-right border border-violet-400 bg-violet-200 font-bold text-violet-900 dark:border-violet-600 dark:bg-violet-800/30 dark:text-violet-200"},[e("span",ca,F(f==="Default"?"0.00":s(ho)(a.value,o,f,d,s(W)[f]||l.value)),1)]))),128)),e("td",pa,[e("span",va,F(f==="Default"?"0.00":s(et)(a.value,o,f,s(W)[f]||l.value)),1)])],64))],64))),128))])],64))),128))])])])])])],64)):(n(),le(No,{key:4,"from-year":s(se),"to-year":s(ae)},null,8,["from-year","to-year"]))])])])]),v(Ce,{name:"fade"},{default:fe(()=>[b.value?(n(),r("div",ga,[e("div",xa,[e("div",ba,[v(s(qe),{class:"w-4 h-4 text-white"}),t[42]||(t[42]=e("h2",{class:"text-xl font-bold text-white"},"Advanced Display Mode Settings",-1))]),e("div",ha,[D.value.length?X("",!0):(n(),r("div",ya,[v(s(ze),{class:"w-4 h-4 text-yellow-600"}),t[43]||(t[43]=e("span",{class:"text-yellow-800 font-medium"},'Please select both \\"From Year\\" and \\"To Year\\" to configure advanced settings.',-1))])),D.value.length?(n(),r("div",wa,[(n(!0),r(y,null,j(D.value,o=>(n(),r("div",{key:"adv-"+o,class:"flex justify-between items-center border-b pb-2"},[e("span",_a,[v(s(je),{class:"w-3 h-3 text-violet-600"}),_(" "+F(o),1)]),$(e("select",{"onUpdate:modelValue":f=>g.value[o]=f,class:"px-6 py-2 border rounded-md focus:ring-violet-500"},t[44]||(t[44]=[e("option",{value:"monthly"},"Monthly",-1),e("option",{value:"quarterly"},"Quarterly",-1)]),8,ka),[[z,g.value[o]]])]))),128))])):X("",!0)]),e("div",Ea,[e("button",{onClick:vt,class:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 flex items-center gap-2"},[v(s(ne),{class:"w-4 h-4"}),t[45]||(t[45]=_(" Cancel ",-1))]),D.value.length?(n(),r("button",{key:0,onClick:pt,class:"px-4 py-2 rounded-md bg-violet-600 text-white hover:bg-violet-700 flex items-center gap-2"},[v(s(Ae),{class:"w-4 h-4"}),t[46]||(t[46]=_(" Apply ",-1))])):X("",!0)])])])):X("",!0)]),_:1}),v(Ce,{name:"fade"},{default:fe(()=>[s(ve)?(n(),r("div",Sa,[e("div",Ca,[e("div",Fa,[e("div",ja,[v(s(no),{class:"w-7 h-7 text-white"}),t[47]||(t[47]=e("div",null,[e("h2",{class:"text-2xl font-bold text-white"},"Add New Expense"),e("p",{class:"text-violet-100 mt-1 text-sm"},"Enter expense details for the selected period")],-1))]),e("button",{onClick:t[6]||(t[6]=(...o)=>s(me)&&s(me)(...o)),class:"text-violet-100 hover:text-white transition-colors p-2 rounded-full hover:bg-violet-600"},[v(s(ne),{class:"w-4 h-4"})])]),e("div",Aa,[e("div",Da,[e("div",null,[t[49]||(t[49]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Select Year",-1)),$(e("select",{"onUpdate:modelValue":t[7]||(t[7]=o=>s(R).year=o),class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[48]||(t[48]=e("option",{disabled:"",value:""},"Choose a year",-1)),(n(!0),r(y,null,j(p.value,o=>(n(),r("option",{key:"add-year-"+o,value:o},F(o),9,Ta))),128))],512),[[z,s(R).year]])]),e("div",null,[t[51]||(t[51]=e("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Select Month/Quarter",-1)),$(e("select",{"onUpdate:modelValue":t[8]||(t[8]=o=>s(R).month=o),class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[50]||(t[50]=e("option",{disabled:"",value:""},"Choose a month/quarter",-1)),(n(!0),r(y,null,j(s(Ht),o=>(n(),r("option",{key:"add-month-"+o,value:o},F(o),9,Va))),128))],512),[[z,s(R).month]])])]),e("div",Ra,[e("button",{onClick:t[9]||(t[9]=o=>ee.value=!ee.value),class:"w-full flex items-center justify-between p-4 bg-gradient-to-r from-violet-50 to-violet-100 border border-violet-200 rounded-lg hover:from-violet-100 hover:to-violet-200 transition-all duration-200"},[e("div",Ya,[e("div",$a,[v(s(oe),{class:"w-4 h-4 text-white"})]),t[52]||(t[52]=e("span",{class:"text-lg font-semibold text-violet-800"},"Quick Actions",-1))]),v(s(Ke),{class:Oe(["w-5 h-5 text-violet-600 transition-transform duration-200",ee.value?"rotate-180":""])},null,8,["class"])]),$(e("div",La,[e("div",null,[e("div",Na,[v(s(Ve),{class:"w-5 h-5 text-violet-600"}),t[53]||(t[53]=e("span",{class:"text-md font-semibold text-gray-700"},"Create New Expense",-1))]),e("div",Ua,[$(e("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>S.value.account_name=o),type:"text",placeholder:"Account Name",class:"px-4 py-2 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},null,512),[[Fe,S.value.account_name]]),$(e("input",{"onUpdate:modelValue":t[11]||(t[11]=o=>S.value.account_number=o),type:"text",placeholder:"Account Number",class:"px-4 py-2 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white",onKeypress:wt,onPaste:_t,onInput:kt},null,544),[[Fe,S.value.account_number]]),$(e("select",{"onUpdate:modelValue":t[12]||(t[12]=o=>S.value.parent_account=o),class:"px-4 py-2 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[54]||(t[54]=e("option",{value:""},"Parent Account",-1)),(n(!0),r(y,null,j(Q.value,o=>(n(),r("option",{key:o,value:o},F(o),9,Ma))),128))],512),[[z,S.value.parent_account]]),e("button",{disabled:T.value||!S.value.account_name.trim()||!S.value.account_number.trim()||!S.value.parent_account,onClick:yt,class:"px-4 py-2 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-all font-medium flex items-center justify-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed"},[v(s(oe),{class:"w-4 h-4"}),t[55]||(t[55]=_(" Create Account ",-1))],8,Ia)])])],512),[[Be,ee.value]])]),e("div",Oa,[t[65]||(t[65]=e("div",{class:"flex items-center gap-3"},[e("div",{class:"w-1 h-6 bg-gradient-to-b from-violet-500 to-violet-600 rounded-full"}),e("h3",{class:"text-lg font-semibold text-gray-800"},"Expense Items")],-1)),e("div",Pa,[(n(!0),r(y,null,j(s(R).rows,(o,f)=>(n(),r("div",{key:"expense-row-"+f,class:"bg-white hover:border-violet-200 rounded-lg p-6 hover:shadow-md border-2 transition-all"},[e("div",Ba,[e("h4",za,"Expense Entry "+F(f+1),1),e("button",{onClick:d=>s(Bt)(f),disabled:s(R).rows.length===1,class:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove entry"},[v(s(ro),{class:"w-5 h-5"})],8,qa)]),e("div",Ka,[e("div",null,[t[57]||(t[57]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Department",-1)),$(e("select",{"onUpdate:modelValue":d=>o.department=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[56]||(t[56]=e("option",{disabled:"",value:""},"Select Department",-1)),(n(!0),r(y,null,j(J.value,d=>(n(),r("option",{key:d,value:d},F(d),9,Xa))),128))],8,Wa),[[z,o.department]])]),e("div",null,[t[59]||(t[59]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Department Location",-1)),$(e("select",{"onUpdate:modelValue":d=>o.department_location=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[58]||(t[58]=e("option",{disabled:"",value:""},"Select Department Location",-1)),(n(!0),r(y,null,j(Z.value,d=>(n(),r("option",{key:d,value:d},F(d),9,Qa))),128))],8,Ha),[[z,o.department_location]])]),e("div",null,[t[61]||(t[61]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Expense Name",-1)),$(e("select",{"onUpdate:modelValue":d=>o.expense=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[60]||(t[60]=e("option",{disabled:"",value:""},"Select expense",-1)),(n(!0),r(y,null,j(x.value,d=>(n(),r("option",{key:d.value,value:d.value},F(d.label),9,Za))),128))],8,Ja),[[z,o.expense]])]),e("div",null,[t[63]||(t[63]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cost Type",-1)),$(e("select",{"onUpdate:modelValue":d=>o.costType=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[t[62]||(t[62]=e("option",{disabled:"",value:""},"Select Cost Type",-1)),(n(!0),r(y,null,j(U.value,d=>(n(),r("option",{key:d.value,value:d.value},F(d.label),9,el))),128))],8,Ga),[[z,o.costType]])]),e("div",null,[t[64]||(t[64]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Amount",-1)),$(e("input",{type:"text","onUpdate:modelValue":d=>o.amountDisplay=d,onKeypress:t[13]||(t[13]=(...d)=>s(Je)&&s(Je)(...d)),onInput:d=>gt(f,d),onBlur:d=>xt(f),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-left",placeholder:"0.00"},null,40,tl),[[Fe,o.amountDisplay]])])])]))),128))])]),e("div",ol,[e("button",{onClick:t[14]||(t[14]=(...o)=>s(Xe)&&s(Xe)(...o)),class:"flex items-center gap-2 px-4 py-2 bg-violet-500 text-white rounded-lg hover:bg-violet-600 transition-all font-medium"},[v(s(oe),{class:"w-5 h-5"}),t[66]||(t[66]=_(" Add Row ",-1))]),e("div",sl,[e("button",{onClick:t[15]||(t[15]=(...o)=>s(me)&&s(me)(...o)),class:"px-6 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium flex items-center gap-2"},[v(s(ne),{class:"w-5 h-5"}),t[67]||(t[67]=_(" Cancel ",-1))]),e("button",{onClick:bt,class:"px-6 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-all font-medium flex items-center gap-2"},[v(s(Ae),{class:"w-5 h-5"}),t[68]||(t[68]=_(" Submit ",-1))])])])])])])):X("",!0)]),_:1}),v(Ut,{"is-visible":be.value,onClose:St},null,8,["is-visible"])],64))}},Yl=ge(al,[["__scopeId","data-v-142430d3"]]);export{Yl as default};
