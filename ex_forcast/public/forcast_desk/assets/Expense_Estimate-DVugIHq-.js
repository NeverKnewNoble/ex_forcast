var St=Object.defineProperty;var Ue=Object.getOwnPropertySymbols;var Ct=Object.prototype.hasOwnProperty,Ft=Object.prototype.propertyIsEnumerable;var Me=(c,p,r)=>p in c?St(c,p,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[p]=r,_e=(c,p)=>{for(var r in p||(p={}))Ct.call(p,r)&&Me(c,r,p[r]);if(Ue)for(var r of Ue(p))Ft.call(p,r)&&Me(c,r,p[r]);return c};var B=(c,p,r)=>new Promise((v,a)=>{var u=g=>{try{b(r.next(g))}catch(x){a(x)}},h=g=>{try{b(r.throw(g))}catch(x){a(x)}},b=g=>g.done?v(g.value):Promise.resolve(g.value).then(u,h);b((r=r.apply(c,p)).next())});import{n as L,x as de,_ as Ve,c as n,o as l,b as t,e as m,u as s,d as _,t as F,h as k,y as jt,z as ke,A as te,B as Ie,k as At,l as Dt,m as Tt,q as Oe,j as le,i as X,w as Ee,C as $,D as Pe,F as y,p as j,E as z,G as Be,T as Se,H as Ce}from"./index-BIpqQg-E.js";import{u as Vt,a as Rt,C as Fe}from"./useCalculationCache-DkZ9LNnt.js";import{a as O,A as Yt,_ as $t,C as pe,T as ze,b as je,R as Lt,X as ne,c as qe,d as He,S as Nt}from"./SettingsModal-D7WL2FQ8.js";import{g as Re,a as tt,c as Ut,b as Mt,d as It,s as ve,t as Ot,i as G,e as We,f as me,h as R,r as Pt,j as Xe,k as Bt,l as zt,m as qt}from"./advanced_settings-CVlbyBV3.js";import{l as Ae,a as re,b as ie,e as De,c as Ht}from"./data_service-t5rpoGjF.js";import{c as ue,T as Wt}from"./cloneDeep-BkZb2F5J.js";import{m as Xt}from"./filter_utils-BPZXPN_G.js";import{g as Ke,a as Kt}from"./expense_options-iRSEo5el.js";import{l as Qt}from"./payroll_data_service-DEklhpoX.js";import{N as Jt,E as Zt}from"./ErrorState-JdKZ35nU.js";import{c as fe}from"./createLucideIcon-kAk0qIkv.js";import{P as oe}from"./plus-Di_w3kXB.js";import{C as ot,a as Qe}from"./circle-alert-E5qO7GEh.js";import{a as Je}from"./index-D6kn7qs4.js";import{C as Gt}from"./chevron-left-BxnzBkFS.js";import{S as eo}from"./save-BrPmbZM9.js";import{L as to}from"./loader-circle-ENVircU2.js";import{F as oo}from"./funnel-BM2GTKJy.js";import{R as so,T as ao}from"./trash-2-ChqSeYHk.js";import{B as lo}from"./building-Di2670mc.js";import{C as no}from"./circle-plus-BpCFvGiq.js";import"./zap-Bj2OpKAw.js";/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=fe("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ro=fe("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=fe("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=fe("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);//! Helper function to find expense details from data
function io(c,p,r,v){var b;const u=(((b=c==null?void 0:c[r])==null?void 0:b[v])||[]).find(g=>g.expense===p);if(u)return{department:u.department||"",department_location:u.department_location||"",hospitality_category:u.hospitality_category||"",cost_type:u.cost_type||""};const h=(c==null?void 0:c[r])||{};for(const g in h){const E=(h[g]||[]).find(N=>N.expense===p);if(E)return{department:E.department||"",department_location:E.department_location||"",hospitality_category:E.hospitality_category||"",cost_type:E.cost_type||""}}for(const g in c){const x=c[g]||{};for(const E in x){const U=(x[E]||[]).find(V=>V.expense===p);if(U)return{department:U.department||"",department_location:U.department_location||"",hospitality_category:U.hospitality_category||"",cost_type:U.cost_type||""}}}return{department:"",department_location:"",hospitality_category:"",cost_type:""}}//! Helper function to check if an expense is a default expense
function uo(c,p,r=null){if(!Array.isArray(p)||typeof p.some!="function")return console.warn("defaultExpenses is not an array:",p),!1;try{return r?p.some(v=>v.expense===c&&v.department===r):p.some(v=>v.expense===c)}catch(v){return console.error("Error checking if expense is default:",v),!1}}//! Helper function to get expense details from either default expenses or regular expense data
function co(c,p,r,v,a,u=null){let h;if(u?h=a.find(g=>g.expense===c&&g.department===u):h=a.find(g=>g.expense===c),h)return{department:h.department||"",department_location:h.department_location||"",cost_type:h.cost_type||"",hospitality_category:h.hospitality_category||""};const b=io(v,c,p,r);return{department:b.department||"",department_location:b.department_location||"",cost_type:b.cost_type||"",hospitality_category:b.hospitality_category||""}}function po(g,x,E,N,U,V,M){return B(this,arguments,function*(c,p,r,v,a,u,h,b=[]){var q,A;if(c.value.length===0)return;Array.isArray(b)||(console.warn("defaultExpenses is not an array, converting to empty array:",b),b=[]);const P=L.value;if(!P){O.error("No project selected. Please select a project first.");return}p.value=!0,r.value="";try{const H=c.value.map(T=>{const Q=co(T.expense,T.year,T.label,v.value,b,T.department),ee=uo(T.expense,b,T.department),J=T.department||Q.department;return{year:T.year,month:T.label,expense:T.expense,amount:parseFloat(T.newValue),department:J,department_location:Q.department_location,cost_type:Q.cost_type,hospitality_category:Q.hospitality_category,is_default_expense:ee}}),S=yield(yield fetch("/api/method/ex_forcast.api.expense_estimate.upsert_expense_items",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":de()},body:JSON.stringify({changes:H,project:P.project_name})})).json();if(((q=S.message)==null?void 0:q.status)==="success"){O.success("Changes saved successfully!"),u.value=!0,c.value=[];const T=yield h();v.value=T,a.value=ue(T)}else{const T=typeof((A=S.message)==null?void 0:A.message)=="string"?S.message.message:"Save failed.";O.error(T)}}catch(H){const I=typeof H.message=="string"?H.message:"Save failed.";O.error(I)}finally{p.value=!1}})}function vo(c,p,r){if(!p||!p.value||!p.value.rows){console.warn("addExpenseForm is not properly initialized");return}const v=p.value.rows[c];if(!v){console.warn(`Row at index ${c} not found`);return}let a=v.amountDisplay;a=a.replace(/[^\d.]/g,"");const u=a.split(".");if(u.length>2&&(a=u[0]+"."+u.slice(1).join("")),!a.includes(".")||u.length===2&&u[1].length===2){u.length===2&&u[1].length>2&&(a=u[0]+"."+u[1].substring(0,2));const g=(parseFloat(a)||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});if(g!==r.target.innerText){r.target.innerText=g;const x=document.createRange(),E=window.getSelection(),N=r.target.firstChild||r.target;x.setStart(N,N.textContent.length),x.collapse(!0),E.removeAllRanges(),E.addRange(x)}}else a!==r.target.innerText&&(r.target.innerText=a)}function mo(c,p){if(!p||!p.value||!p.value.rows){console.warn("addExpenseForm is not properly initialized");return}const r=p.value.rows[c];if(!r){console.warn(`Row at index ${c} not found`);return}const v=parseFloat(r.amountDisplay.replace(/[^\d.]/g,""))||0;r.amountDisplay=v.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),r.amount=v}function Ye(c){return["Cost of Beverage sales","Cost of Food sales"].includes(c)}function fo({year:c,label:p,expense:r,event:v,originalExpenseData:a,changedCells:u,expenseData:h,isSaved:b,department:g=null}){var V,M,P,q;let x=v.target.innerText.replace(/,/g,"").trim();Ye(r)?(x=x.replace(/%/g,"").trim(),x===""&&(x="0.00"),x=((parseFloat(x)||0)/100).toFixed(4)):(x===""&&(x="0.00"),x=(parseFloat(x)||0).toFixed(2));let E="0.00";const U=(((M=(V=a.value)==null?void 0:V[c])==null?void 0:M[p])||[]).find(A=>A.expense===r&&(!g||A.department===g));if(U&&(E=parseFloat(U.amount).toFixed(2)),x!==E){b.value=!1;const A=u.value.findIndex(S=>S.year===c&&S.label===p&&S.expense===r);A!==-1?(u.value[A].newValue=x,g&&!u.value[A].department&&(u.value[A].department=g)):u.value.push({year:c,label:p,expense:r,newValue:x,department:g});const I=(((q=(P=h.value)==null?void 0:P[c])==null?void 0:q[p])||[]).find(S=>S.expense===r&&(!g||S.department===g));I&&(I.amount=parseFloat(x))}else u.value=u.value.filter(A=>!(A.year===c&&A.label===p&&A.expense===r)),u.value.length===0&&(b.value=!0)}function go({year:c,label:p,expense:r,event:v}){let a=v.target.innerText;if(Ye(r)){a=a.replace(/[^\d.]/g,"");const u=a.split(".");u.length>2&&(a=u[0]+"."+u.slice(1).join("")),u.length===2&&u[1].length>2&&(a=u[0]+"."+u[1].substring(0,2));const b=(parseFloat(a)||0).toFixed(2);if(b!==v.target.innerText){v.target.innerText=b;const g=document.createRange(),x=window.getSelection(),E=v.target.firstChild||v.target;g.setStart(E,E.textContent.length),g.collapse(!0),x.removeAllRanges(),x.addRange(g)}}else{a=a.replace(/[^\d.]/g,"");const u=a.split(".");if(u.length>2&&(a=u[0]+"."+u.slice(1).join("")),!a.includes(".")||u.length===2&&u[1].length===2){u.length===2&&u[1].length>2&&(a=u[0]+"."+u[1].substring(0,2));const g=(parseFloat(a)||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});if(g!==v.target.innerText){v.target.innerText=g;const x=document.createRange(),E=v.target.firstChild||v.target;x.setStart(E,E.textContent.length),x.collapse(!0);const N=window.getSelection();N.removeAllRanges(),N.addRange(x)}}else a!==v.target.innerText&&(v.target.innerText=a)}}function xo({year:c,label:p,expense:r,event:v}){let a=v.target.innerText;if(Ye(r)){const b=a.replace(/%/g,"");v.target.innerText=b}else{const b=a.replace(/,/g,"");v.target.innerText=b}const u=document.createRange(),h=window.getSelection();u.selectNodeContents(v.target),h.removeAllRanges(),h.addRange(u)}function bo(c,p,r,v,a){let u=0;for(const h of p.locations)for(const b of h.expenses){const g=Re(c,b,r,v,a,p.department),x=parseFloat(g.toString().replace(/,/g,""));isNaN(x)||(u+=x)}return u.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}function et(c,p,r,v){const a=tt(v);let u=0;for(const h of p.locations)for(const b of h.expenses)for(const g of a){const x=Re(c,b,r,g,v,null),E=parseFloat(x.toString().replace(/,/g,""));isNaN(E)||(u+=E)}return u.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}function ho(c,p,r,v,a,u){return B(this,null,function*(){var N;const{year:h,month:b,rows:g}=c.value;if(!h||!b||g.length===0){a.error("Please select year, month, and add at least one expense.");return}const x=g.filter(U=>U.expense&&U.amount>0),E=yield Ut({year:h,month:b,expenses:x});E.success?(a.success(`Expense document created successfully: ${E.name}`),p.value=!1,r(),u&&(yield u()),v.value=!0):a.error("Failed to create document: "+(((N=E.error)==null?void 0:N.message)||E.error))})}const yo={class:"flex flex-col items-center justify-center h-96"},wo={class:"w-24 h-24 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center mb-6"},_o={class:"text-gray-600 mb-6 text-center max-w-md"},ko={class:"font-semibold text-violet-600"},Eo={__name:"NoDataState",props:{project:{type:String,default:""}},emits:["add-expense"],setup(c){return(p,r)=>(l(),n("div",yo,[t("div",wo,[m(s(Te),{class:"w-12 h-12 text-blue-600"})]),r[4]||(r[4]=t("h3",{class:"text-xl font-semibold text-gray-800 mb-2"},"No Expense Data Found",-1)),t("p",_o,[r[1]||(r[1]=_(" The project ",-1)),t("span",ko,F(c.project),1),r[2]||(r[2]=_(" doesn't have any expense data yet. ",-1))]),t("button",{onClick:r[0]||(r[0]=v=>p.$emit("add-expense")),class:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-violet-500 to-violet-600 text-white rounded-lg hover:from-violet-600 hover:to-violet-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[m(s(oe),{class:"w-4 h-4"}),r[3]||(r[3]=_(" Add First Expense ",-1))])]))}},So=Ve(Eo,[["__scopeId","data-v-7e3d9036"]]),Co={class:"flex flex-col items-center justify-center min-h-[400px] bg-white border-2 border-dashed border-violet-300 rounded-xl shadow-sm"},Fo={class:"w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center mb-4"},jo={class:"text-lg text-violet-700 font-semibold mb-2"},Ao={class:"text-gray-500 text-center max-w-md leading-relaxed text-sm"},Do={class:"mt-4 flex items-center gap-2 text-xs text-violet-600"},To={__name:"NoYearsSelectedState",props:{fromYear:{type:String,default:""},toYear:{type:String,default:""}},setup(c){return(p,r)=>(l(),n("div",Co,[t("div",Fo,[m(s(ot),{class:"w-8 h-8 text-violet-500"})]),t("h3",jo,F(c.fromYear&&!c.toYear?'Select "To Year"':!c.fromYear&&c.toYear?'Select "From Year"':"No Years Selected"),1),t("p",Ao,F(c.fromYear&&!c.toYear?"You have selected a From Year, now please select a To Year to display the expense table.":!c.fromYear&&c.toYear?"You have selected a To Year, now please select a From Year to display the expense table.":'Please select both "From Year" and "To Year" in the left panel to display the expense table.'),1),t("div",Do,[m(s(Yt),{class:"w-3 h-3"}),r[0]||(r[0]=t("span",null,"Use the filters on the left to get started",-1))])]))}},Vo=Ve(To,[["__scopeId","data-v-741a36b9"]]),Ro={class:"flex"},Yo={class:"flex-1 min-h-screen bg-gradient-to-br from-white to-violet-50"},$o={class:"flex"},Lo={key:2,class:"text-violet-700 text-sm font-medium dark:text-white"},No={class:"mb-8"},Uo={class:"flex items-center gap-3 mb-2"},Mo={class:"w-12 h-12 bg-gradient-to-br from-violet-500 to-violet-600 rounded-xl flex items-center justify-center shadow-lg"},Io={class:"bg-white rounded-xl p-4 mb-6 border border-gray-200 shadow-sm"},Oo={class:"flex items-center justify-between"},Po={class:"flex items-center gap-2"},Bo={key:0,class:"flex items-center gap-2 text-sm font-medium text-red-600 bg-red-50 px-3 py-2 rounded-lg border border-red-200"},zo={key:1,class:"flex items-center gap-2 text-sm font-medium text-green-600 bg-green-50 px-3 py-2 rounded-lg border border-green-200"},qo=["disabled"],Ho={key:1,class:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg cursor-not-allowed"},Wo={key:0,class:"mt-2 text-xs text-red-500 flex items-center gap-1"},Xo={class:"mb-8"},Ko={class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},Qo={class:"flex gap-2 mt-3"},Jo={class:"flex-1"},Zo={class:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm"},Go={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},es={class:"space-y-4"},ts={class:"grid grid-cols-2 gap-3"},os={class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},ss=["value"],as={class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},ls=["value"],ns={class:"flex gap-2"},rs={class:"flex-1 p-4"},is={key:0},ds={key:1},us={key:2},cs={class:"mb-4"},ps={class:"flex items-center gap-2"},vs={class:"flex items-center gap-2"},ms={class:"w-6 h-6 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},fs={class:"mt-2"},gs={class:"bg-white rounded-lg border border-violet-200 shadow-sm overflow-hidden md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px]"},xs={class:"overflow-x-auto max-w-[100%] md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px]"},bs={class:"min-w-full w-max"},hs={class:"w-full"},ys={class:"bg-gradient-to-r from-violet-600 to-violet-700 text-white"},ws={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},_s={class:"flex items-center gap-1"},ks={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},Es={class:"flex items-center gap-1"},Ss={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},Cs={class:"flex items-center gap-1"},Fs=["colspan","onClick"],js={class:"flex items-center justify-center gap-1"},As={class:"font-semibold"},Ds={class:"bg-violet-500/90 text-xs"},Ts={class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},Vs={class:"flex items-center justify-center gap-1"},Rs={key:1,class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},Ys={class:"flex items-center justify-center gap-1"},$s={class:"text-gray-700 bg-white text-sm"},Ls={class:"bg-gradient-to-r from-violet-600 to-violet-700 border-b-2 border-violet-800"},Ns={colspan:"3",class:"px-3 py-3 font-bold text-white border-r border-violet-500"},Us={class:"flex items-center gap-2"},Ms={key:1,class:"px-1 py-1 text-center border border-violet-500 bg-violet-600"},Is={class:"bg-gradient-to-r from-violet-100 to-violet-200 border-b border-violet-300 dark:from-violet-800/40 dark:to-violet-700/40 dark:border-violet-600"},Os={colspan:"3",class:"px-6 py-2 font-semibold text-violet-700 dark:text-white border-r border-violet-300 dark:border-violet-600"},Ps={class:"flex items-center gap-2"},Bs={key:1,class:"px-1 py-1 text-center border border-violet-300 bg-violet-100 dark:border-violet-600 dark:bg-violet-800/30"},zs={class:"px-8 py-2 font-medium border-r border-violet-200 text-gray-600 dark:text-gray-300 dark:border-violet-700"},qs={class:"flex items-center gap-1"},Hs={class:"px-3 py-2 font-medium border-r border-violet-200 dark:border-violet-700"},Ws={class:"flex items-center justify-between gap-2"},Xs=["onClick"],Ks={class:"px-3 py-2 font-medium border-r border-violet-200 text-gray-600"},Qs={class:"flex items-center gap-1"},Js=["onInput","onFocus","onBlur"],Zs={class:"text-xs"},Gs={class:"px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50 dark:border-violet-700 dark:bg-violet-900/20"},ea={class:"text-xs text-violet-700 dark:text-violet-300"},ta={key:1,class:"px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50 dark:border-violet-700 dark:bg-violet-900/20"},oa={class:"text-xs text-violet-700 dark:text-violet-300"},sa={class:"bg-gradient-to-r from-violet-200 to-violet-300 border-y-2 border-violet-500"},aa={colspan:"3",class:"px-3 py-2 font-bold text-violet-900 border-r border-violet-400"},la={class:"flex items-center gap-1"},na={class:"text-xs"},ra={class:"px-2 py-1 text-right border border-violet-400 bg-violet-200 font-bold text-violet-900 dark:border-violet-600 dark:bg-violet-800/30 dark:text-violet-200"},ia={class:"text-xs"},da={key:1,class:"px-2 py-1 text-right border border-violet-400 bg-violet-200 font-bold text-violet-900 dark:border-violet-600 dark:bg-violet-800/30 dark:text-violet-200"},ua={class:"text-xs"},ca={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm"},pa={class:"bg-white rounded-2xl shadow-2xl border border-violet-200 w-[95%] max-w-lg p-0 overflow-hidden"},va={class:"flex items-center gap-3 px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},ma={class:"p-8 pt-6"},fa={key:0,class:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center gap-3"},ga={key:1,class:"space-y-4 max-h-[50vh] overflow-auto pr-2"},xa={class:"font-medium text-gray-700 flex items-center gap-2"},ba=["onUpdate:modelValue"],ha={class:"flex justify-end gap-3 px-8 py-4 bg-gray-50 border-t border-violet-100"},ya={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm"},wa={class:"bg-white rounded-2xl shadow-2xl border border-violet-100 w-[95%] max-w-4xl max-h-[90vh] overflow-hidden flex flex-col"},_a={class:"flex items-center justify-between px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},ka={class:"flex items-center gap-3"},Ea={class:"p-8 pb-0 space-y-6 overflow-y-auto max-h-[calc(90vh-140px)]"},Sa={class:"grid grid-cols-2 gap-6"},Ca=["value"],Fa=["value"],ja={class:"mb-6"},Aa={class:"flex items-center gap-3"},Da={class:"w-8 h-8 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},Ta={class:"mt-3 space-y-4 p-4 bg-white border border-violet-200 rounded-lg shadow-sm"},Va={class:"flex items-center gap-3 mb-2"},Ra={class:"grid grid-cols-4 gap-3"},Ya=["value"],$a=["disabled"],La={class:"space-y-4"},Na={class:"space-y-4"},Ua={class:"flex items-center justify-between mb-4"},Ma={class:"text-lg font-semibold text-gray-800"},Ia=["onClick","disabled"],Oa={class:"grid grid-cols-2 rounded-lg p-2 gap-6"},Pa=["onUpdate:modelValue"],Ba=["value"],za=["onUpdate:modelValue"],qa=["value"],Ha=["onUpdate:modelValue"],Wa=["value"],Xa=["onUpdate:modelValue"],Ka=["value"],Qa=["onUpdate:modelValue","onInput","onBlur"],Ja={class:"flex justify-between items-center pt-3 pb-3 border-t border-gray-200 bg-white sticky bottom-0"},Za={class:"flex gap-3"},Ga={__name:"Expense_Estimate",setup(c){const p=k([]),r=k("monthly"),v=k([]),a=k({}),u=k([]),h=k([]),b=k(!1),g=k({}),x=k([]),E=k(localStorage.getItem("hospitalityExperience")===null?!0:localStorage.getItem("hospitalityExperience")==="true"),N=k([]),U=k([]),V=k(!1),M=k({}),P=k(new Set),q=k([]),A=k(!1),H=k("");k(!1),k(null);const I=k(!1);k(""),k(!1);const S=k({account_name:"",account_number:"",parent_account:""}),T=k(!1),Q=k([]),ee=k(!1);k(""),k("");const J=k([]),Z=k([]),ge=k(!1),xe=Vt(),{fromYear:se,toYear:ae,advancedModes:W}=jt(xe),{setFromYear:el,setToYear:tl,setAdvancedModes:st,clearYearSettings:at,getFilteredToYears:lt}=xe,be=Rt(),D=ke(()=>Mt(se.value,ae.value)),nt=ke(()=>lt(p.value)),rt=ke(()=>It(a.value,D.value,h.value));function it(i){const e=new Set(P.value);e.add(i),P.value=e,V.value=!1}function dt(){try{M.value&&Object.keys(M.value).length&&(a.value=ue(M.value)),P.value=new Set,V.value=!1,O.info("Restored to original")}catch(i){}}function ut(i){const e=P.value;return(i||[]).filter(o=>!e.has(o))}const K=i=>i==="Default"?["Default"]:tt(W.value[i]||r.value),$e=i=>u.value.length>0?Bt(u.value,i):zt(a.value,i,D.value,h.value);te(D,()=>{D.value.forEach(i=>{W.value[i]||xe.setAdvancedMode(i,r.value)})}),te(E,i=>{localStorage.setItem("hospitalityExperience",i)}),setInterval(()=>{const i=localStorage.getItem("hospitalityExperience"),e=i===null?!0:i==="true";E.value!==e&&(E.value=e)},1e3),te(L,(i,e)=>B(this,null,function*(){var o;if(i&&i!==e)try{const f=yield Ae();f.status==="success"&&(u.value=f.expenses);const d=yield re();d.status==="success"&&(h.value=d.defaultExpenses),a.value=yield ie(),!a.value.status&&((o=L.value)!=null&&o.project_name)&&ye(a.value,L.value.project_name),a.value.status?(M.value=a.value,v.value=[]):(M.value=ue(a.value),v.value=De(a.value)),q.value=[],V.value=!0,O.success(`Switched to project: ${i.project_name}`);try{J.value=yield Ie(i.project_name)}catch(C){J.value=[]}try{const w=yield(yield fetch("/api/method/ex_forcast.api.payroll_department_location_list.get_payroll_department_location_list",{headers:{"X-Frappe-CSRF-Token":de()}})).json();w.message&&w.message.success?Z.value=(w.message.locations||[]).map(Y=>Y.department_location||Y.name):Z.value=[]}catch(C){Z.value=[]}}catch(f){console.error("Error loading project data:",f),O.error("Failed to load project data. Please try again.")}}),{immediate:!0}),te(()=>{var i;return(i=L.value)==null?void 0:i.project_name},(i,e)=>B(this,null,function*(){if(i&&i!==e)try{const o=yield re();o.status==="success"&&(h.value=o.defaultExpenses)}catch(o){console.error("Error loading default expenses for project:",o)}}),{immediate:!0}),te(b,i=>{i&&(g.value=_e({},W.value))});function ct(){st(_e({},g.value)),b.value=!1}function pt(){b.value=!1}At(()=>B(this,null,function*(){var i,e;try{yield Dt(),p.value=yield Ht();const o=yield Ae();if(o.status==="success"&&(u.value=o.expenses),L.value){const w=yield re();w.status==="success"&&(h.value=w.defaultExpenses)}a.value=yield ie(),a.value.status?(M.value=a.value,v.value=[]):(M.value=ue(a.value),v.value=De(a.value)),x.value=((i=yield Ke())==null?void 0:i.map(w=>({label:w,value:w})))||[];const f=yield Kt();N.value=f.hospitality_category.map(w=>({label:w,value:w})),U.value=f.cost_type.map(w=>({label:w,value:w}));const C=yield(yield fetch("/api/v2/method/ex_forcast.api.account_list.get_group_accounts",{headers:{"X-Frappe-CSRF-Token":de()}})).json();if(C.data&&C.data.group_accounts&&(Q.value=C.data.group_accounts),L&&L.value&&L.value.project_name)try{J.value=yield Ie(L.value.project_name)}catch(w){J.value=[]}try{yield Qt();const Y=yield(yield fetch("/api/method/ex_forcast.api.payroll_department_location_list.get_payroll_department_location_list",{headers:{"X-Frappe-CSRF-Token":de()}})).json();Y.message&&Y.message.success?Z.value=(Y.message.locations||[]).map(Ne=>Ne.department_location||Ne.name):Z.value=[]}catch(w){Z.value=[]}if(V.value=!0,localStorage.getItem("showRefreshSuccess")==="true"&&(localStorage.removeItem("showRefreshSuccess"),O.success("Page refreshed successfully")),(e=L.value)!=null&&e.project_name){const w=yield re();w.status==="success"&&(h.value=w.defaultExpenses)}}catch(o){console.error("Error loading data:",o)}}));function vt(){at(),V.value=!1}function mt({year:i,label:e,expense:o,event:f,department:d}){fo({year:i,label:e,expense:o,event:f,originalExpenseData:M,changedCells:q,expenseData:a,isSaved:V,department:d})}const ft=(i,e)=>{R&&R.value&&R.value.rows&&vo(i,R,e)},gt=i=>{R&&R.value&&R.value.rows&&mo(i,R)},xt=()=>B(this,null,function*(){R&&R.value&&(yield ho(R,ve,qt,V,O,()=>B(this,null,function*(){var o;const i=yield Ae();i.status==="success"&&(u.value=i.expenses),(o=L.value)!=null&&o.project_name&&(a.value=yield ie(),a.value.status||ye(a.value,L.value.project_name));const e=yield re();e.status==="success"&&(h.value=e.defaultExpenses),a.value=yield ie(),a.value.status||(M.value=ue(a.value),v.value=De(a.value))})))}),bt=()=>B(this,null,function*(){var i;yield po(q,A,H,a,M,V,ie,h.value),(i=L.value)!=null&&i.project_name&&!a.value.status&&ye(a.value,L.value.project_name)});te(V,i=>{i?window.removeEventListener("beforeunload",he):window.addEventListener("beforeunload",he)});function he(i){if(!V.value)return i.preventDefault(),i.returnValue="You have unsaved changes that may be discarded if not saved. Are you sure you want to leave?",i.returnValue}Tt(()=>{window.removeEventListener("beforeunload",he)});function ye(i,e){try{if(!i||!e)return;be.clearCache(e,"Expense Assumptions");for(const[o,f]of Object.entries(i))for(const[d,C]of Object.entries(f))C.forEach(w=>{if(w.expense&&w.amount&&w.department){const Y=parseFloat(w.amount);Y>0&&(be.setValue(e,"Expense Assumptions",w.expense,o,d,Y),be.setValue(e,`Expense Assumptions:${w.department}`,w.expense,o,d,Y))}})}catch(o){console.error("Error caching expense data:",o)}}function Le(){localStorage.setItem("showRefreshSuccess","true"),window.location.reload()}function ht(){return B(this,null,function*(){var i;if(!(!S.value.account_name.trim()||!S.value.account_number.trim()||!S.value.parent_account)){T.value=!0;try{const o=yield(yield fetch("/api/v2/method/ex_forcast.api.account_list.create_account",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":de()},body:JSON.stringify({account_name:S.value.account_name.trim(),account_number:S.value.account_number.trim(),parent_account:S.value.parent_account})})).json();o.data&&o.data.success?(O.success(`Account '${S.value.account_name.trim()}' created successfully!`),S.value={account_name:"",account_number:"",parent_account:""},x.value=((i=yield Ke())==null?void 0:i.map(f=>({label:f,value:f})))||[]):O.error(o.data&&o.data.error||o.error||"Failed to create account.")}catch(e){O.error("Failed to create account.")}finally{T.value=!1}}})}function yt(i){const e=i.which?i.which:i.keyCode;e>31&&(e<48||e>57)&&i.preventDefault()}function wt(i){i.preventDefault();const o=(i.clipboardData||window.clipboardData).getData("text").replace(/[^0-9]/g,"");S.value.account_number+=o}function _t(i){S.value.account_number=i.target.value.replace(/[^0-9]/g,"")}function kt(){ge.value=!0}function Et(){ge.value=!1}function ce(i){return["Cost of Beverage sales","Cost of Food sales"].includes(i)}function we(i,e){return ce(e)?`${(parseFloat(i)*100).toFixed(2)}%`:i}return(i,e)=>(l(),n(y,null,[t("div",Ro,[m($t,{onOpenSettings:kt}),t("div",Yo,[t("div",$o,[t("div",{class:Oe(["bg-gradient-to-b from-white to-gray-50 border-r border-gray-200 min-h-screen flex flex-col shadow-sm transition-all duration-300",I.value?"w-14 p-2":"w-80 p-6"])},[t("button",{onClick:e[0]||(e[0]=o=>I.value=!I.value),class:"mb-4 flex items-center gap-2 px-2 py-1 bg-violet-100 hover:bg-violet-200 rounded transition-all dark:bg-violet-900/30 dark:hover:bg-violet-800/40"},[I.value?(l(),le(s(Qe),{key:1,class:"w-5 h-5 text-violet-700 dark:text-white"})):(l(),le(s(Gt),{key:0,class:"w-5 h-5 text-violet-700 dark:text-white"})),I.value?X("",!0):(l(),n("span",Lo,"Collapse"))]),m(Se,{name:"fade"},{default:Ee(()=>[$(t("div",null,[t("div",No,[t("div",Uo,[t("div",Mo,[m(s(pe),{class:"w-7 h-7 mx-2 text-white"})]),e[16]||(e[16]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Expense Assumptions",-1))]),e[17]||(e[17]=t("p",{class:"text-sm text-gray-500"},"Manage and configure your expense data",-1))]),t("div",Io,[t("div",Oo,[t("div",Po,[V.value?(l(),n("div",zo,[m(s(je),{class:"w-4 h-4 text-green-600"}),e[19]||(e[19]=_(" All Saved ",-1))])):(l(),n("div",Bo,[m(s(ze),{class:"w-4 h-4 text-red-600"}),e[18]||(e[18]=_(" Unsaved ",-1))]))]),!A.value&&!V.value?(l(),n("button",{key:0,disabled:A.value,onClick:bt,class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-lg hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[m(s(eo),{class:"w-4 h-4"}),e[20]||(e[20]=_(" Save ",-1))],8,qo)):X("",!0),A.value?(l(),n("button",Ho,[m(s(to),{class:"w-4 h-4 animate-spin"}),e[21]||(e[21]=_(" Saving... ",-1))])):X("",!0)]),H.value?(l(),n("span",Wo,[m(s(ot),{class:"w-3 h-3"}),_(" "+F(H.value),1)])):X("",!0)]),t("div",Xo,[t("h3",Ko,[m(s(oe),{class:"w-4 h-4 text-violet-600"}),e[22]||(e[22]=_(" Quick Actions ",-1))]),t("button",{onClick:e[1]||(e[1]=o=>ve.value=!0),class:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-violet-500 to-violet-600 text-white rounded-xl hover:from-violet-600 hover:to-violet-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 font-medium"},[m(s(oe),{class:"w-4 h-4"}),e[23]||(e[23]=_(" Add New Expense ",-1))]),t("div",Qo,[t("button",{onClick:Le,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-violet-200 text-violet-700 dark:text-violet-300 rounded-lg hover:bg-violet-50 transition-all text-sm font-medium"},[m(s(Lt),{class:"w-4 h-4"}),e[24]||(e[24]=_(" Refresh ",-1))])])]),t("div",Jo,[t("div",Zo,[t("h3",Go,[m(s(oo),{class:"w-5 h-5 text-violet-600"}),e[25]||(e[25]=_(" Year Range Filter ",-1))]),t("div",es,[t("div",ts,[t("div",null,[t("label",os,[m(s(Fe),{class:"w-3 h-3 text-gray-500"}),e[26]||(e[26]=_(" From Year ",-1))]),$(t("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>Pe(se)?se.value=o:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-sm"},[e[27]||(e[27]=t("option",{value:""},"Select Year",-1)),(l(!0),n(y,null,j(p.value,o=>(l(),n("option",{key:"from-"+o,value:o},F(o),9,ss))),128))],512),[[z,s(se)]])]),t("div",null,[t("label",as,[m(s(Fe),{class:"w-3 h-3 text-gray-500"}),e[28]||(e[28]=_(" To Year ",-1))]),$(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>Pe(ae)?ae.value=o:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-sm"},[e[29]||(e[29]=t("option",{value:""},"Select Year",-1)),(l(!0),n(y,null,j(nt.value,o=>(l(),n("option",{key:"to-"+o,value:o},F(o),9,ls))),128))],512),[[z,s(ae)]])])]),t("div",ns,[t("button",{onClick:vt,class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all duration-200 text-sm font-medium"},[m(s(ne),{class:"w-4 h-4"}),e[30]||(e[30]=_(" Clear ",-1))]),t("button",{onClick:e[4]||(e[4]=o=>b.value=!0),class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-white border border-violet-500 text-violet-700 dark:text-violet-300 rounded-lg hover:bg-violet-50 transition-all duration-200 text-sm font-medium"},[m(s(qe),{class:"w-4 h-4"}),e[31]||(e[31]=_(" Advanced ",-1))])])])])])],512),[[Be,!I.value]])]),_:1})],2),t("div",rs,[a.value.status==="no_project_selected"?(l(),n("div",is,[m(Jt)])):a.value.status==="no_data"&&(!h.value||h.value.length===0)?(l(),n("div",ds,[m(So,{project:a.value.project,onAddExpense:e[5]||(e[5]=o=>ve.value=!0)},null,8,["project"])])):a.value.status==="error"?(l(),n("div",us,[m(Zt,{message:a.value.message,onRetry:Le},null,8,["message"])])):D.value.length?(l(),n(y,{key:3},[t("div",cs,[t("div",ps,[t("div",vs,[t("div",ms,[m(s(Wt),{class:"w-3 h-3 text-white"})]),e[32]||(e[32]=t("h2",{class:"text-lg font-bold text-gray-800"},"Expense Overview",-1))])]),t("div",fs,[t("button",{onClick:dt,class:"inline-flex items-center gap-2 px-3 py-1.5 bg-gray-500 text-white rounded-md hover:bg-gray-600 text-sm font-medium shadow-sm"},[m(s(so),{class:"w-4 h-4"}),e[33]||(e[33]=_(" Restore ",-1))])])]),t("div",gs,[t("div",xs,[t("div",bs,[t("table",hs,[t("thead",ys,[t("tr",null,[t("th",ws,[t("div",_s,[m(s(Ze),{class:"w-3 h-3"}),e[34]||(e[34]=_(" Code ",-1))])]),t("th",ks,[t("div",Es,[m(s(Te),{class:"w-3 h-3"}),e[35]||(e[35]=_(" Expense ",-1))])]),t("th",Ss,[t("div",Cs,[m(s(Ge),{class:"w-3 h-3"}),e[36]||(e[36]=_(" Cost Type ",-1))])]),(l(!0),n(y,null,j(D.value.length>0?D.value:["Default"],o=>(l(),n("th",{key:"header-"+o,colspan:s(G)(o)?1:K(o).length+1,class:"px-2 py-2 text-center border-x-2 border-white cursor-pointer select-none hover:bg-violet-700 transition-all duration-200 group text-sm dark:border-gray-700 dark:text-white",onClick:f=>s(Ot)(o),title:"Click to collapse/expand"},[t("div",js,[t("span",As,F(o==="Default"?"Default":o),1),s(G)(o)?(l(),le(s(Qe),{key:1,class:"w-3 h-3 transition-transform group-hover:scale-110"})):(l(),le(s(He),{key:0,class:"w-3 h-3 transition-transform group-hover:scale-110"}))])],8,Fs))),128))]),t("tr",Ds,[(l(!0),n(y,null,j(D.value.length>0?D.value:["Default"],o=>(l(),n(y,{key:"months-"+o},[s(G)(o)?(l(),n("th",Rs,[t("div",Ys,[m(s(pe),{class:"w-2 h-2"}),e[38]||(e[38]=_(" Total ",-1))])])):(l(),n(y,{key:0},[(l(!0),n(y,null,j(K(o),f=>(l(),n("th",{key:o+"-"+f,class:"px-2 py-1 text-center border border-violet-300 min-w-[100px] font-medium"},F(f),1))),128)),t("th",Ts,[t("div",Vs,[m(s(pe),{class:"w-2 h-2"}),e[37]||(e[37]=_(" Total ",-1))])])],64))],64))),128))])]),t("tbody",$s,[(l(!0),n(y,null,j(rt.value,o=>(l(),n(y,{key:"department-"+o.department},[t("tr",Ls,[t("td",Ns,[t("div",Us,[m(s(lo),{class:"w-4 h-4"}),_(" "+F(o.department),1)])]),(l(!0),n(y,null,j(D.value.length>0?D.value:["Default"],f=>(l(),n(y,{key:"department-header-"+f},[s(G)(f)?(l(),n("td",Ms)):(l(),n(y,{key:0},[(l(!0),n(y,null,j(K(f),d=>(l(),n("td",{key:"department-cell-"+f+"-"+d,class:"px-1 py-1 text-center border border-violet-500 bg-violet-600"}))),128)),e[39]||(e[39]=t("td",{class:"px-1 py-1 text-center border border-violet-500 bg-violet-600"},null,-1))],64))],64))),128))]),(l(!0),n(y,null,j(o.locations,f=>(l(),n(y,{key:"location-"+f.location},[t("tr",Is,[t("td",Os,[t("div",Ps,[m(s(ro),{class:"w-3 h-3 dark:text-white"}),_(" "+F(f.location),1)])]),(l(!0),n(y,null,j(D.value.length>0?D.value:["Default"],d=>(l(),n(y,{key:"location-header-"+d},[s(G)(d)?(l(),n("td",Bs)):(l(),n(y,{key:0},[(l(!0),n(y,null,j(K(d),C=>(l(),n("td",{key:"location-cell-"+d+"-"+C,class:"px-1 py-1 text-center border border-violet-300 bg-violet-100 dark:border-violet-600 dark:bg-violet-800/30"}))),128)),e[40]||(e[40]=t("td",{class:"px-1 py-1 text-center border border-violet-300 bg-violet-100 dark:border-violet-600 dark:bg-violet-800/30"},null,-1))],64))],64))),128))]),(l(!0),n(y,null,j(ut(f.expenses),d=>(l(),n("tr",{key:"expense-"+d,class:"even:bg-gray-50 hover:bg-violet-50 transition-all duration-200 border-b border-gray-100 dark:even:bg-gray-800 dark:hover:bg-violet-900/20 dark:border-gray-700"},[t("td",zs,[t("div",qs,[m(s(Ze),{class:"w-2 h-2 text-gray-400"}),_(" "+F($e(d).code),1)])]),t("td",Hs,[t("div",Ws,[t("span",null,F(d),1),t("button",{onClick:C=>it(d),class:"text-red-600 hover:text-red-700",title:"Delete expense"},[m(s(ne),{class:"w-4 h-4"})],8,Xs)])]),t("td",Ks,[t("div",Qs,[m(s(Ge),{class:"w-2 h-2 text-gray-400"}),_(" "+F($e(d).costType),1)])]),(l(!0),n(y,null,j(D.value.length>0?D.value:["Default"],C=>(l(),n(y,{key:"row-"+C+"-"+d},[s(G)(C)?(l(),n("td",ta,[t("span",oa,F(C==="Default"?ce(d)?"0.00%":"0.00":we(s(We)(a.value,d,C,s(W)[C]||r.value,K,o.department),d)),1)])):(l(),n(y,{key:0},[(l(!0),n(y,null,j(K(C),w=>(l(),n("td",{key:"cell-"+C+"-"+w,contenteditable:"true",class:"px-2 py-1 text-right border border-violet-200 hover:bg-violet-50 focus:bg-white dark:border-violet-700 dark:hover:bg-violet-900/20 dark:focus:bg-gray-700 focus:outline-none focus:ring-1 focus:ring-violet-500 focus:border-transparent transition-all duration-200",onInput:Y=>s(go)({year:C,label:w,expense:d,event:Y}),onFocus:Y=>s(xo)({year:C,label:w,expense:d,event:Y}),onBlur:Y=>mt({year:C,label:w,expense:d,event:Y,department:o.department})},[t("span",Zs,F(C==="Default"?ce(d)?"0.00%":"0.00":we(s(Re)(a.value,d,C,w,s(W)[C]||r.value,o.department),d)),1)],40,Js))),128)),t("td",Gs,[t("span",ea,F(C==="Default"?ce(d)?"0.00%":"0.00":we(s(We)(a.value,d,C,s(W)[C]||r.value,K,o.department),d)),1)])],64))],64))),128))]))),128))],64))),128)),t("tr",sa,[t("td",aa,[t("div",la,[m(s(pe),{class:"w-3 h-3"}),e[41]||(e[41]=_(" Department Total ",-1))])]),(l(!0),n(y,null,j(D.value.length>0?D.value:["Default"],f=>(l(),n(y,{key:"department-total-"+f},[s(G)(f)?(l(),n("td",da,[t("span",ua,F(f==="Default"?"0.00":s(et)(a.value,o,f,s(W)[f]||r.value)),1)])):(l(),n(y,{key:0},[(l(!0),n(y,null,j(K(f),d=>(l(),n("td",{key:"department-total-cell-"+f+"-"+d,class:"px-2 py-1 text-right border border-violet-400 bg-violet-200 font-bold text-violet-900 dark:border-violet-600 dark:bg-violet-800/30 dark:text-violet-200"},[t("span",na,F(f==="Default"?"0.00":s(bo)(a.value,o,f,d,s(W)[f]||r.value)),1)]))),128)),t("td",ra,[t("span",ia,F(f==="Default"?"0.00":s(et)(a.value,o,f,s(W)[f]||r.value)),1)])],64))],64))),128))])],64))),128))])])])])])],64)):(l(),le(Vo,{key:4,"from-year":s(se),"to-year":s(ae)},null,8,["from-year","to-year"]))])])])]),m(Se,{name:"fade"},{default:Ee(()=>[b.value?(l(),n("div",ca,[t("div",pa,[t("div",va,[m(s(qe),{class:"w-4 h-4 text-white"}),e[42]||(e[42]=t("h2",{class:"text-xl font-bold text-white"},"Advanced Display Mode Settings",-1))]),t("div",ma,[D.value.length?X("",!0):(l(),n("div",fa,[m(s(ze),{class:"w-4 h-4 text-yellow-600"}),e[43]||(e[43]=t("span",{class:"text-yellow-800 font-medium"},'Please select both \\"From Year\\" and \\"To Year\\" to configure advanced settings.',-1))])),D.value.length?(l(),n("div",ga,[(l(!0),n(y,null,j(D.value,o=>(l(),n("div",{key:"adv-"+o,class:"flex justify-between items-center border-b pb-2"},[t("span",xa,[m(s(Fe),{class:"w-3 h-3 text-violet-600"}),_(" "+F(o),1)]),$(t("select",{"onUpdate:modelValue":f=>g.value[o]=f,class:"px-6 py-2 border rounded-md focus:ring-violet-500"},e[44]||(e[44]=[t("option",{value:"monthly"},"Monthly",-1),t("option",{value:"quarterly"},"Quarterly",-1)]),8,ba),[[z,g.value[o]]])]))),128))])):X("",!0)]),t("div",ha,[t("button",{onClick:pt,class:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 flex items-center gap-2"},[m(s(ne),{class:"w-4 h-4"}),e[45]||(e[45]=_(" Cancel ",-1))]),D.value.length?(l(),n("button",{key:0,onClick:ct,class:"px-4 py-2 rounded-md bg-violet-600 text-white hover:bg-violet-700 flex items-center gap-2"},[m(s(je),{class:"w-4 h-4"}),e[46]||(e[46]=_(" Apply ",-1))])):X("",!0)])])])):X("",!0)]),_:1}),m(Se,{name:"fade"},{default:Ee(()=>[s(ve)?(l(),n("div",ya,[t("div",wa,[t("div",_a,[t("div",ka,[m(s(no),{class:"w-7 h-7 text-white"}),e[47]||(e[47]=t("div",null,[t("h2",{class:"text-2xl font-bold text-white"},"Add New Expense"),t("p",{class:"text-violet-100 mt-1 text-sm"},"Enter expense details for the selected period")],-1))]),t("button",{onClick:e[6]||(e[6]=(...o)=>s(me)&&s(me)(...o)),class:"text-violet-100 hover:text-white transition-colors p-2 rounded-full hover:bg-violet-600"},[m(s(ne),{class:"w-4 h-4"})])]),t("div",Ea,[t("div",Sa,[t("div",null,[e[49]||(e[49]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Select Year",-1)),$(t("select",{"onUpdate:modelValue":e[7]||(e[7]=o=>s(R).year=o),class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[e[48]||(e[48]=t("option",{disabled:"",value:""},"Choose a year",-1)),(l(!0),n(y,null,j(p.value,o=>(l(),n("option",{key:"add-year-"+o,value:o},F(o),9,Ca))),128))],512),[[z,s(R).year]])]),t("div",null,[e[51]||(e[51]=t("label",{class:"block text-sm font-semibold text-gray-700 mb-2"},"Select Month/Quarter",-1)),$(t("select",{"onUpdate:modelValue":e[8]||(e[8]=o=>s(R).month=o),class:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[e[50]||(e[50]=t("option",{disabled:"",value:""},"Choose a month/quarter",-1)),(l(!0),n(y,null,j(s(Xt),o=>(l(),n("option",{key:"add-month-"+o,value:o},F(o),9,Fa))),128))],512),[[z,s(R).month]])])]),t("div",ja,[t("button",{onClick:e[9]||(e[9]=o=>ee.value=!ee.value),class:"w-full flex items-center justify-between p-4 bg-gradient-to-r from-violet-50 to-violet-100 border border-violet-200 rounded-lg hover:from-violet-100 hover:to-violet-200 transition-all duration-200"},[t("div",Aa,[t("div",Da,[m(s(oe),{class:"w-4 h-4 text-white"})]),e[52]||(e[52]=t("span",{class:"text-lg font-semibold text-violet-800"},"Quick Actions",-1))]),m(s(He),{class:Oe(["w-5 h-5 text-violet-600 transition-transform duration-200",ee.value?"rotate-180":""])},null,8,["class"])]),$(t("div",Ta,[t("div",null,[t("div",Va,[m(s(Te),{class:"w-5 h-5 text-violet-600"}),e[53]||(e[53]=t("span",{class:"text-md font-semibold text-gray-700"},"Create New Expense",-1))]),t("div",Ra,[$(t("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>S.value.account_name=o),type:"text",placeholder:"Account Name",class:"px-4 py-2 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},null,512),[[Ce,S.value.account_name]]),$(t("input",{"onUpdate:modelValue":e[11]||(e[11]=o=>S.value.account_number=o),type:"text",placeholder:"Account Number",class:"px-4 py-2 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white",onKeypress:yt,onPaste:wt,onInput:_t},null,544),[[Ce,S.value.account_number]]),$(t("select",{"onUpdate:modelValue":e[12]||(e[12]=o=>S.value.parent_account=o),class:"px-4 py-2 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[e[54]||(e[54]=t("option",{value:""},"Parent Account",-1)),(l(!0),n(y,null,j(Q.value,o=>(l(),n("option",{key:o,value:o},F(o),9,Ya))),128))],512),[[z,S.value.parent_account]]),t("button",{disabled:T.value||!S.value.account_name.trim()||!S.value.account_number.trim()||!S.value.parent_account,onClick:ht,class:"px-4 py-2 bg-violet-600 text-white rounded-lg hover:bg-violet-700 transition-all font-medium flex items-center justify-center gap-2 disabled:opacity-60 disabled:cursor-not-allowed"},[m(s(oe),{class:"w-4 h-4"}),e[55]||(e[55]=_(" Create Account ",-1))],8,$a)])])],512),[[Be,ee.value]])]),t("div",La,[e[65]||(e[65]=t("div",{class:"flex items-center gap-3"},[t("div",{class:"w-1 h-6 bg-gradient-to-b from-violet-500 to-violet-600 rounded-full"}),t("h3",{class:"text-lg font-semibold text-gray-800"},"Expense Items")],-1)),t("div",Na,[(l(!0),n(y,null,j(s(R).rows,(o,f)=>(l(),n("div",{key:"expense-row-"+f,class:"bg-white hover:border-violet-200 rounded-lg p-6 hover:shadow-md border-2 transition-all"},[t("div",Ua,[t("h4",Ma,"Expense Entry "+F(f+1),1),t("button",{onClick:d=>s(Pt)(f),disabled:s(R).rows.length===1,class:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove entry"},[m(s(ao),{class:"w-5 h-5"})],8,Ia)]),t("div",Oa,[t("div",null,[e[57]||(e[57]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Department",-1)),$(t("select",{"onUpdate:modelValue":d=>o.department=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[e[56]||(e[56]=t("option",{disabled:"",value:""},"Select Department",-1)),(l(!0),n(y,null,j(J.value,d=>(l(),n("option",{key:d,value:d},F(d),9,Ba))),128))],8,Pa),[[z,o.department]])]),t("div",null,[e[59]||(e[59]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Department Location",-1)),$(t("select",{"onUpdate:modelValue":d=>o.department_location=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[e[58]||(e[58]=t("option",{disabled:"",value:""},"Select Department Location",-1)),(l(!0),n(y,null,j(Z.value,d=>(l(),n("option",{key:d,value:d},F(d),9,qa))),128))],8,za),[[z,o.department_location]])]),t("div",null,[e[61]||(e[61]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Expense Name",-1)),$(t("select",{"onUpdate:modelValue":d=>o.expense=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[e[60]||(e[60]=t("option",{disabled:"",value:""},"Select expense",-1)),(l(!0),n(y,null,j(x.value,d=>(l(),n("option",{key:d.value,value:d.value},F(d.label),9,Wa))),128))],8,Ha),[[z,o.expense]])]),t("div",null,[e[63]||(e[63]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Cost Type",-1)),$(t("select",{"onUpdate:modelValue":d=>o.costType=d,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white"},[e[62]||(e[62]=t("option",{disabled:"",value:""},"Select Cost Type",-1)),(l(!0),n(y,null,j(U.value,d=>(l(),n("option",{key:d.value,value:d.value},F(d.label),9,Ka))),128))],8,Xa),[[z,o.costType]])]),t("div",null,[e[64]||(e[64]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Amount",-1)),$(t("input",{type:"text","onUpdate:modelValue":d=>o.amountDisplay=d,onKeypress:e[13]||(e[13]=(...d)=>s(Je)&&s(Je)(...d)),onInput:d=>ft(f,d),onBlur:d=>gt(f),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-white text-left",placeholder:"0.00"},null,40,Qa),[[Ce,o.amountDisplay]])])])]))),128))])]),t("div",Ja,[t("button",{onClick:e[14]||(e[14]=(...o)=>s(Xe)&&s(Xe)(...o)),class:"flex items-center gap-2 px-4 py-2 bg-violet-500 text-white rounded-lg hover:bg-violet-600 transition-all font-medium"},[m(s(oe),{class:"w-5 h-5"}),e[66]||(e[66]=_(" Add Row ",-1))]),t("div",Za,[t("button",{onClick:e[15]||(e[15]=(...o)=>s(me)&&s(me)(...o)),class:"px-6 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all font-medium flex items-center gap-2"},[m(s(ne),{class:"w-5 h-5"}),e[67]||(e[67]=_(" Cancel ",-1))]),t("button",{onClick:xt,class:"px-6 py-2 bg-black text-white rounded-lg hover:bg-gray-800 transition-all font-medium flex items-center gap-2"},[m(s(je),{class:"w-5 h-5"}),e[68]||(e[68]=_(" Submit ",-1))])])])])])])):X("",!0)]),_:1}),m(Nt,{"is-visible":ge.value,onClose:Et},null,8,["is-visible"])],64))}},Cl=Ve(Ga,[["__scopeId","data-v-2d9b3939"]]);export{Cl as default};
