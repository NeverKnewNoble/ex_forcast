var v=Object.defineProperty;var d=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable;var E=(e,o,t)=>o in e?v(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,m=(e,o)=>{for(var t in o||(o={}))A.call(o,t)&&E(e,t,o[t]);if(d)for(var t of d(o))_.call(o,t)&&E(e,t,o[t]);return e};var x=(e,o,t)=>new Promise((a,r)=>{var s=u=>{try{n(t.next(u))}catch(i){r(i)}},c=u=>{try{n(t.throw(u))}catch(i){r(i)}},n=u=>u.done?a(u.value):Promise.resolve(u.value).then(s,c);n((t=t.apply(e,o)).next())});import{h as p,O as J,q as M}from"./index-DSYnFDpC.js";function N(e,o){const t=parseInt(e),a=parseInt(o);if(!t||!a||t>a)return[];const r=[];for(let s=t;s<=a;s++)r.push(s);return r}const C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],O=["Jan-Mar","Apr-Jun","Jul-Sep","Oct-Dec"];function Y(e){return e==="monthly"?C:O}const F={"Jan-Mar":["Jan","Feb","Mar"],"Apr-Jun":["Apr","May","Jun"],"Jul-Sep":["Jul","Aug","Sep"],"Oct-Dec":["Oct","Nov","Dec"]},S=p(!1),y=p({year:"",month:"",rows:[{expense:"",amount:0,amountDisplay:"",category:"",costType:""}]});function k(){y.value.rows.push({expense:"",amount:0,amountDisplay:"",category:"",costType:""})}function P(e){y.value.rows.length>1&&y.value.rows.splice(e,1)}function T(){y.value={year:"",month:"",rows:[{expense:"",amount:0,amountDisplay:"",category:"",costType:""}]}}function R(){T(),S.value=!1}const L=J({url:"frappe.client.insert",makeParams({doctype:e,doc:o}){return{doc:m({doctype:e},o)}}});function I(a){return x(this,arguments,function*({year:e,month:o,expenses:t}){const r=M.value;if(!r)throw new Error("No project selected. Please select a project first.");const s=t.map(n=>m(m({expense_name:n.expense,amount:n.amount},n.category&&{hospitality_category:n.category}),n.costType&&{cost_type:n.costType})),c={year:e,month:o,project:r.project_name,expense_items:s};try{return{success:!0,name:(yield L.submit({doctype:"Expense Assumptions",doc:c})).name}}catch(n){return console.error("Error creating expense document:",n),console.error("Error details:",{message:n.message,stack:n.stack,response:n.response}),{success:!1,error:n}}})}const f=p(new Set);function B(e){f.value.has(e)?f.value.delete(e):f.value.add(e)}function G(e){return f.value.has(e)}function V(e){const o=new Map;e.forEach(r=>{const s=r.hospitality_category||"Other";o.has(s)||o.set(s,[]),o.get(s).push(r)});const t=[],a=[];for(const[r,s]of o){const c=s.map(n=>n.expense_name).sort();r==="Other"?a.push({category:"Other",expenses:c}):t.push({category:r,expenses:c})}return t.sort((r,s)=>r.category.localeCompare(s.category)),a.length>0&&t.push(...a),t}function z(e,o){const t=new Map;o.forEach(s=>{const c=e[s]||{};for(const n in c)c[n].forEach(u=>{const i=u.hospitality_category||"Other";t.has(i)||t.set(i,new Set),t.get(i).add(u.expense)})});const a=[],r=[];for(const[s,c]of t)s==="Other"?r.push({category:"Other",expenses:[...c].sort()}):a.push({category:s,expenses:[...c].sort()});return a.sort((s,c)=>s.category.localeCompare(c.category)),r.length>0&&a.push(...r),a}function H(e,o,t){for(const a of t){const r=e[a]||{};for(const s in r){const c=r[s].find(n=>n.expense===o);if(c)return{code:c.code||"",costType:c.cost_type||"",hospitalityCategory:c.hospitality_category||""}}}return{code:"",costType:"",hospitalityCategory:""}}function K(e,o){const t=e.find(a=>a.expense_name===o);return t?{code:t.code||"",costType:t.cost_type||"",hospitalityCategory:t.hospitality_category||""}:{code:"",costType:"",hospitalityCategory:""}}function j(e,o,t,a,r="monthly"){var s,c,n;if(r==="quarterly"&&F[a]){const i=(((s=e==null?void 0:e[t])==null?void 0:s[a])||[]).find(g=>g.expense===o);if(i)return parseFloat(i.amount).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});let l=0;for(const g of F[a]){const h=(((c=e==null?void 0:e[t])==null?void 0:c[g])||[]).find(w=>w.expense===o);h&&(l+=parseFloat(h.amount)||0)}return l.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}else{const i=(((n=e==null?void 0:e[t])==null?void 0:n[a])||[]).find(l=>l.expense===o);return i?parseFloat(i.amount).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"}}function Q(e,o,t,a,r){const s=r(t);let c=0;for(const n of s){const u=j(e,o,t,n,a),i=parseFloat(u.toString().replace(/,/g,""));isNaN(i)||(c+=i)}return c.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}p(!1);p({});export{j as a,N as b,I as c,V as d,z as e,Q as f,Y as g,R as h,G as i,y as j,k,K as l,H as m,T as n,P as r,S as s,B as t};
