var S=(g,e,r)=>new Promise((o,n)=>{var p=f=>{try{u(r.next(f))}catch(v){n(v)}},m=f=>{try{u(r.throw(f))}catch(v){n(v)}},u=f=>f.done?o(f.value):Promise.resolve(f.value).then(p,m);u((r=r.apply(g,e)).next())});import{_ as nt,c as P,i as B,o as j,b as t,e as b,u as x,F as K,x as z,v as w,E as R,h as F,l as I,m as kt,n as St,p as Ct,q as st,t as H,j as rt,w as Tt,B as T,d as _,O as Dt,T as $t,C as U,N as Ut,a as Ft}from"./index-ZSaFeStz.js";import{X as Et,_ as At,W as X,T as Ot,b as Nt,R as Rt,h as Vt,d as Bt,c as D}from"./SettingsModal-CkmocsMj.js";import{c as lt}from"./createLucideIcon-Diyw-P4a.js";import{C as Lt}from"./chevron-left-DEHdKNR-.js";import{a as Mt,C as It}from"./circle-alert-CRlonPQM.js";import{S as Ht}from"./save-DIHTh90y.js";import{L as qt}from"./loader-circle-C7JmCli_.js";import{P as ot}from"./plus-CeYa1GKE.js";import{C as Kt}from"./chart-column-CRvhJrkA.js";import{T as at}from"./trash-CE4lk39x.js";import"./zap-C5sVj9GT.js";/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=lt("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-vue-next v0.513.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=lt("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),Xt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center"},zt={class:"relative z-10 w-full max-w-md bg-white rounded-xl shadow-2xl border border-violet-200"},Wt={class:"px-5 py-4 border-b border-gray-200 flex items-center justify-between"},Gt={class:"flex items-center gap-2"},Yt={class:"p-5 space-y-4"},Qt=["value"],Zt={key:0,class:"mt-2 text-xs text-amber-700 bg-amber-50 border border-amber-200 px-2 py-1 rounded"},te=["value"],ee=["value"],se={class:"px-5 py-4 border-t border-gray-200 flex items-center justify-end gap-2 bg-gray-50 rounded-b-xl"},re={__name:"NewProjectModal",props:{isVisible:{type:Boolean,default:!1},newProjectName:{type:String,default:""},availableProjects:{type:Array,default:()=>[]},selectedExistingProject:{type:String,default:""},duplicateProject:{type:Boolean,default:!1}},emits:["close","confirm","refresh","update:newProjectName","update:selectedExistingProject"],setup(g){return(e,r)=>g.isVisible?(j(),P("div",Xt,[r[10]||(r[10]=t("div",{class:"absolute inset-0 bg-black/30"},null,-1)),t("div",zt,[t("div",Wt,[t("div",Gt,[b(x(W),{class:"w-5 h-5 text-violet-600"}),r[6]||(r[6]=t("h3",{class:"text-base font-semibold text-gray-800"},"Create or Add Existing Project",-1))]),t("button",{onClick:r[0]||(r[0]=o=>e.$emit("close")),class:"text-gray-400 hover:text-gray-600"},[b(x(Et),{class:"w-5 h-5"})])]),t("div",Yt,[t("div",null,[r[7]||(r[7]=t("label",{class:"text-sm font-medium text-gray-700"},"Create Your Project",-1)),t("input",{value:g.newProjectName,onInput:r[1]||(r[1]=o=>e.$emit("update:newProjectName",o.target.value)),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-transparent",placeholder:"Type a new name or select existing"},null,40,Qt),g.duplicateProject?(j(),P("p",Zt,"A project with this name already exists. Please select it below.")):B("",!0)]),t("div",null,[r[9]||(r[9]=t("label",{class:"text-sm font-medium text-gray-700"},"Select Existing Project",-1)),t("select",{value:g.selectedExistingProject,onChange:r[2]||(r[2]=o=>e.$emit("update:selectedExistingProject",o.target.value)),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-transparent bg-white"},[r[8]||(r[8]=t("option",{value:""},"-- Select a project --",-1)),(j(!0),P(K,null,z(g.availableProjects,o=>(j(),P("option",{key:o.name,value:o.name},w(o.project_name),9,ee))),128))],40,te),t("button",{onClick:r[3]||(r[3]=o=>e.$emit("refresh")),class:"mt-2 text-xs text-violet-700 hover:text-violet-900 underline",type:"button"},"Refresh list")])]),t("div",se,[t("button",{onClick:r[4]||(r[4]=o=>e.$emit("close")),class:"px-4 py-2 rounded-md border border-gray-300 text-gray-700 hover:bg-gray-100"},"Cancel"),t("button",{onClick:r[5]||(r[5]=o=>e.$emit("confirm")),class:"px-4 py-2 rounded-md bg-gradient-to-r from-violet-600 to-violet-700 text-white hover:from-violet-700 hover:to-violet-800"},"Add")])])])):B("",!0)}},oe=nt(re,[["__scopeId","data-v-74cd7ed6"]]),ae=["Not Started","In Progress","Complete","Needs Review","Approved","Overdue","On Hold"];class L{constructor(e={}){this.id=e.id||null,this.task=e.task||"",this.project_name=e.project_name||"",this.isSubtask=e.isSubtask||!1,this.description=e.description||"",this.status=e.status||"Not Started",this.plannedStartDate=e.plannedStartDate||"",this.actualStartDate=e.actualStartDate||"",this.endDate=e.endDate||"",this.hr=parseFloat(e.hr)||0,this.ratePerHr=parseFloat(e.ratePerHr)||0,this.units=parseFloat(e.units)||0,this.ratePerUnit=parseFloat(e.ratePerUnit)||0,this.travel=parseFloat(e.travel)||0,this.equipment=parseFloat(e.equipment)||0,this.misc=parseFloat(e.misc)||0,this.budget=parseFloat(e.budget)||0,this._addComputedProperties()}_addComputedProperties(){Object.defineProperty(this,"totalLabor",{get(){return this.hr*this.ratePerHr},enumerable:!0,configurable:!0}),Object.defineProperty(this,"totalMaterials",{get(){return this.units*this.ratePerUnit},enumerable:!0,configurable:!0}),Object.defineProperty(this,"actual",{get(){return this.totalLabor+this.totalMaterials+this.travel+this.equipment+this.misc},enumerable:!0,configurable:!0}),Object.defineProperty(this,"underOver",{get(){return this.actual-this.budget},enumerable:!0,configurable:!0})}validate(){const e=[];return this.task.trim()||e.push("Task name is required"),this.hr<0&&e.push("Labor hours cannot be negative"),this.ratePerHr<0&&e.push("Rate per hour cannot be negative"),this.units<0&&e.push("Material units cannot be negative"),this.ratePerUnit<0&&e.push("Rate per unit cannot be negative"),this.travel<0&&e.push("Travel cost cannot be negative"),this.equipment<0&&e.push("Equipment cost cannot be negative"),this.misc<0&&e.push("Miscellaneous cost cannot be negative"),this.budget<0&&e.push("Budget amount cannot be negative"),ae.includes(this.status)||e.push("Invalid task status"),e}toApiFormat(){return{id:this.id,task:this.task,project_name:this.project_name,description:this.description,status:this.status,plannedStartDate:this.plannedStartDate,actualStartDate:this.actualStartDate,endDate:this.endDate,hr:this.hr,ratePerHr:this.ratePerHr,units:this.units,ratePerUnit:this.ratePerUnit,travel:this.travel,equipment:this.equipment,misc:this.misc,budget:this.budget}}static fromApiData(e){return new L(e)}static createEmpty(){return new L}}class A{constructor(e={}){this.id=e.id,this.name=e.name||"",this.totalBudget=parseFloat(e.total_budget)||0,this.totalActual=parseFloat(e.total_actual)||0,this.variance=parseFloat(e.variance)||0,this.tasks=(e.tasks||[]).map(r=>r instanceof L?r:new L(r)),this._addComputedProperties()}_addComputedProperties(){Object.defineProperty(this,"subtotalLabor",{get(){return this.tasks.reduce((e,r)=>e+r.totalLabor,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalMaterials",{get(){return this.tasks.reduce((e,r)=>e+r.totalMaterials,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalTravel",{get(){return this.tasks.reduce((e,r)=>e+r.travel,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalEquipment",{get(){return this.tasks.reduce((e,r)=>e+r.equipment,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalMisc",{get(){return this.tasks.reduce((e,r)=>e+r.misc,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalBudget",{get(){return this.tasks.reduce((e,r)=>e+r.budget,0)},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalActual",{get(){return this.subtotalLabor+this.subtotalMaterials+this.subtotalTravel+this.subtotalEquipment+this.subtotalMisc},enumerable:!0,configurable:!0}),Object.defineProperty(this,"subtotalUnderOver",{get(){return this.subtotalActual-this.subtotalBudget},enumerable:!0,configurable:!0})}addTask(e={}){e.id||(e.id=`task-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),e.project_name||(e.project_name=this.tasks.length>0&&this.tasks[0].project_name?this.tasks[0].project_name:this.name);const r=new L(e);return this.tasks.push(r),r}removeTask(e){const r=this.tasks.findIndex(o=>o.id===e);return r>-1?this.tasks.splice(r,1)[0]:null}getTask(e){return this.tasks.find(r=>r.id===e)}validate(){const e=[];return this.name.trim()||e.push("Project name is required"),this.tasks.forEach((r,o)=>{const n=r.validate();n.length>0&&e.push(`Task ${o+1}: ${n.join(", ")}`)}),e}toApiFormat(){const e=this.id&&this.id.startsWith("project-")&&this.id.includes("-"),r=this.tasks.length>0&&this.tasks[0].project_name?this.tasks[0].project_name:this.name;return{project_id:e?null:this.id,project_name:r,tasks:this.tasks.map(o=>o.toApiFormat())}}static fromApiData(e){return new A(e)}static createEmpty(e=""){const r=`project-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,o=new A({id:r,name:e});return o.addTask(),o}}class ne{constructor(e={}){this.projectCount=e.project_count||0,this.taskCount=e.task_count||0,this.totalBudget=parseFloat(e.total_budget)||0,this.totalActual=parseFloat(e.total_actual)||0,this.totalVariance=parseFloat(e.total_variance)||0}get variancePercentage(){return this.totalBudget===0?0:this.totalVariance/this.totalBudget*100}get isOverBudget(){return this.totalVariance>0}get budgetUtilization(){return this.totalBudget===0?0:this.totalActual/this.totalBudget*100}}const le={formatCurrency(g){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(g||0)},formatNumber(g){return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(g||0)},calculatePercentage(g,e){return e===0?0:g/e*100},validateDateRange(g,e){return!g||!e?!0:new Date(g)<=new Date(e)},getStatusColor(g){return{"Not Started":"gray","In Progress":"blue",Complete:"green","Needs Review":"yellow",Approved:"green",Overdue:"red","On Hold":"orange"}[g]||"gray"},sortTasksByStatus(g){const e={Overdue:1,"In Progress":2,"Needs Review":3,"On Hold":4,"Not Started":5,Approved:6,Complete:7};return[...g].sort((r,o)=>{const n=e[r.status]||999,p=e[o.status]||999;return n-p})}},E={baseUrl:"/api/method/ex_forcast.api.construction_budget_api",endpoints:{display:"construction_budget_display",upsert:"upsert_construction_budget",delete:"delete_construction_budget_project",summary:"get_construction_budget_summary",listProjects:"list_projects"}};class ie{constructor(){this.projects=[],this.isLoading=!1,this.error=null,this.lastSync=null,this.cachedProjectOptions=[]}fetchData(e=null){return S(this,null,function*(){try{this.isLoading=!0,this.error=null;const r=`${E.baseUrl}.${E.endpoints.display}?project=${e||""}`,o=yield fetch(r,{headers:{"X-Frappe-CSRF-Token":R()}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const n=yield o.json(),p=n.message||n;if(p.success)return this.projects=p.data.map(m=>{const u=A.fromApiData(m);return(u.id===null||u.id===void 0)&&(u.id=`project-${Date.now()}-${Math.random().toString(36).substr(2,9)}`),u}),this.lastSync=new Date,this.projects;throw new Error(p.error||"Failed to fetch construction budget data")}catch(r){throw this.error=r.message,console.error("Error fetching construction budget data:",r),r}finally{this.isLoading=!1}})}fetchAvailableProjects(e="",r=100){return S(this,null,function*(){try{const o=`${E.baseUrl}.${E.endpoints.listProjects}?search=${encodeURIComponent(e)}&limit=${r}`,p=yield(yield fetch(o,{headers:{"X-Frappe-CSRF-Token":R()}})).json(),m=p.message||p;if(!m.success)throw new Error(m.error||"Failed to load projects");return this.cachedProjectOptions=m.data||[],this.cachedProjectOptions}catch(o){throw console.error("Failed to fetch available Projects:",o),o}})}saveData(e,r=null){return S(this,null,function*(){try{this.isLoading=!0,this.error=null;const o=[];if(e.forEach((v,$)=>{const c=v.validate();c.length>0&&o.push(`Project ${$+1}: ${c.join(", ")}`)}),o.length>0)throw new Error(`Validation failed: ${o.join("; ")}`);const p={changes:e.map(v=>v.toApiFormat()),project:r},u=yield(yield fetch(`${E.baseUrl}.${E.endpoints.upsert}`,{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":R()},body:JSON.stringify(p)})).json(),f=u.message||u;if(f.success)return f.results&&Array.isArray(f.results)&&f.results.forEach((v,$)=>{v.name&&e[$]&&(e[$].id=v.name)}),this.projects=e,this.lastSync=new Date,f.results;throw new Error(f.error||"Failed to save construction budget data")}catch(o){throw this.error=o.message,console.error("Error saving construction budget data:",o),o}finally{this.isLoading=!1}})}deleteProject(e){return S(this,null,function*(){try{this.isLoading=!0,this.error=null;const o=yield(yield fetch(`${E.baseUrl}.${E.endpoints.delete}`,{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":R()},body:JSON.stringify({project_id:e})})).json(),n=o.message||o;if(n.success)return this.projects=this.projects.filter(p=>p.id!==e),this.lastSync=new Date,!0;throw new Error(n.error||"Failed to delete project")}catch(r){throw this.error=r.message,console.error("Error deleting project:",r),r}finally{this.isLoading=!1}})}getSummary(e=null){return S(this,null,function*(){try{const o=yield(yield fetch(`${E.baseUrl}.${E.endpoints.summary}?project=${e||""}`,{headers:{"X-Frappe-CSRF-Token":R()}})).json();if(o.success)return new ne(o.data);throw new Error(o.error||"Failed to fetch summary")}catch(r){throw console.error("Error fetching summary:",r),r}})}createProject(e){const r=A.createEmpty(e);return this.projects.push(r),r}addTaskToProject(e,r={}){const o=this.projects.find(n=>n.id===e);if(o)return o.addTask(r);throw new Error("Project not found")}removeTaskFromProject(e,r){const o=this.projects.find(n=>n.id===e);if(o)return o.removeTask(r);throw new Error("Project not found")}getProject(e){return this.projects.find(r=>r.id===e)}getAllProjects(){return this.projects.forEach(e=>{(e.id===null||e.id===void 0)&&(e.id=`project-${Date.now()}-${Math.random().toString(36).substr(2,9)}`)}),this.projects}getTotals(){const e=this.projects.filter(m=>m.tasks&&m.tasks.length>0),r=e.reduce((m,u)=>m+u.tasks.length,0),o=e.reduce((m,u)=>m+u.subtotalBudget,0),n=e.reduce((m,u)=>m+u.subtotalActual,0),p=n-o;return{totalTasks:r,totalBudget:o,totalActual:n,totalVariance:p}}exportData(e="json"){switch(e.toLowerCase()){case"json":return JSON.stringify(this.projects,null,2);case"csv":return this._exportToCSV();case"excel":return this._exportToExcel();default:throw new Error(`Unsupported export format: ${e}`)}}_exportToCSV(){const r=[["Project Name","Task Name","Description","Status","Planned Start Date","Actual Start Date","End Date","Labor Hours","Rate per Hour","Total Labor Cost","Material Units","Rate per Unit","Total Material Cost","Travel Cost","Equipment Cost","Miscellaneous Cost","Budget Amount","Actual Cost","Under/Over Budget"].join(",")];return this.projects.forEach(o=>{o.tasks.forEach(n=>{const p=[`"${o.name}"`,`"${n.task}"`,`"${n.description}"`,`"${n.status}"`,n.plannedStartDate,n.actualStartDate,n.endDate,n.hr,n.ratePerHr,n.totalLabor,n.units,n.ratePerUnit,n.totalMaterials,n.travel,n.equipment,n.misc,n.budget,n.actual,n.underOver];r.push(p.join(","))})}),r.join(`
`)}_exportToExcel(){return this._exportToCSV()}importData(e,r="json"){try{let o=[];switch(r.toLowerCase()){case"json":o=JSON.parse(e).map(n=>A.fromApiData(n));break;case"csv":o=this._importFromCSV(e);break;default:throw new Error(`Unsupported import format: ${r}`)}return o.forEach((n,p)=>{const m=n.validate();if(m.length>0)throw new Error(`Import validation failed for project ${p+1}: ${m.join(", ")}`)}),this.projects=o,o}catch(o){throw console.error("Error importing data:",o),o}}_importFromCSV(e){const r=e.split(`
`),o=r[0].split(",").map(p=>p.replace(/"/g,"").trim()),n=new Map;for(let p=1;p<r.length;p++){const m=r[p].split(",").map(c=>c.replace(/"/g,"").trim()),u={};o.forEach((c,J)=>{u[c]=m[J]||""});const f=u["Project Name"];n.has(f)||n.set(f,A.createEmpty(f));const v=n.get(f),$={task:u["Task Name"],description:u.Description,status:u.Status,plannedStartDate:u["Planned Start Date"],actualStartDate:u["Actual Start Date"],endDate:u["End Date"],hr:parseFloat(u["Labor Hours"])||0,ratePerHr:parseFloat(u["Rate per Hour"])||0,units:parseFloat(u["Material Units"])||0,ratePerUnit:parseFloat(u["Rate per Unit"])||0,travel:parseFloat(u["Travel Cost"])||0,equipment:parseFloat(u["Equipment Cost"])||0,misc:parseFloat(u["Miscellaneous Cost"])||0,budget:parseFloat(u["Budget Amount"])||0};v.addTask($)}return Array.from(n.values())}clearData(){this.projects=[],this.error=null,this.lastSync=null}hasUnsavedChanges(){return!1}testApiConnection(){return S(this,null,function*(){try{const r=yield(yield fetch(`${E.baseUrl}.test_construction_budget_api`,{headers:{"X-Frappe-CSRF-Token":R()}})).json();return(r.message||r).success}catch(e){return console.error("API Test Error:",e),!1}})}getStatus(){return{isLoading:this.isLoading,error:this.error,lastSync:this.lastSync,projectCount:this.projects.length,hasUnsavedChanges:this.hasUnsavedChanges()}}}const N=new ie,de={class:"flex"},ue={class:"flex-1 min-h-screen bg-gradient-to-br from-white to-violet-50"},ce={class:"flex"},pe={key:2,class:"text-violet-700 text-sm font-medium dark:text-white"},me={class:"mb-8"},he={class:"flex items-center gap-3 mb-2"},be={class:"w-12 h-12 bg-gradient-to-br from-violet-500 to-violet-600 rounded-xl flex items-center justify-center shadow-lg"},ge={class:"bg-white rounded-xl p-4 mb-6 border border-gray-200 shadow-sm"},fe={class:"flex items-center justify-between"},xe={class:"flex items-center gap-2"},ve={key:0,class:"flex items-center gap-2 text-sm font-medium text-red-600 bg-red-50 px-3 py-2 rounded-lg border border-red-200"},ye={key:1,class:"flex items-center gap-2 text-sm font-medium text-green-600 bg-green-50 px-3 py-2 rounded-lg border border-green-200"},we=["disabled"],je={key:1,class:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg cursor-not-allowed"},_e={key:0,class:"mt-2 text-xs text-red-500 flex items-center gap-1"},Pe={class:"mb-8"},ke={class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},Se={class:"flex gap-2"},Ce={class:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm"},Te={class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},De={class:"space-y-3"},$e={class:"flex justify-between items-center"},Ue={class:"font-semibold text-violet-600"},Fe={class:"flex justify-between items-center"},Ee={class:"font-semibold text-violet-600"},Ae={class:"flex justify-between items-center"},Oe={class:"font-semibold text-green-600"},Ne={class:"flex justify-between items-center"},Re={class:"font-semibold text-blue-600"},Ve={class:"flex justify-between items-center"},Be={class:"flex-1 p-4 min-w-0"},Le={class:"flex items-center gap-2 mb-4"},Me={class:"w-6 h-6 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},Ie={key:0,class:"bg-white rounded-lg border border-violet-200 shadow-sm p-12"},He={class:"text-center"},qe={class:"w-24 h-24 bg-gradient-to-br from-violet-100 to-violet-200 rounded-full flex items-center justify-center mx-auto mb-6"},Ke={key:1,class:"bg-white rounded-2xl border border-gray-200 shadow-xl overflow-hidden md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px] dark:bg-gray-800 dark:border-gray-600"},Je={class:"overflow-x-auto max-w-[100%] md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px]"},Xe={class:"min-w-full"},ze={class:"w-full"},We={class:"bg-white divide-y divide-gray-100"},Ge={class:"bg-gradient-to-r from-slate-50 to-gray-50 border-b-2 border-slate-200 hover:from-slate-100 hover:to-gray-100 transition-all duration-200"},Ye={class:"px-6 py-4 text-sm text-slate-800",colspan:18},Qe={class:"flex items-center justify-between"},Ze={class:"flex items-center gap-3 text-black"},ts=["value","onInput"],es={class:"flex items-center gap-2"},ss=["onClick"],rs=["onClick"],os=["onDragstart","onDrop"],as={class:"p-0 text-sm"},ns={class:"flex items-center gap-2 pr-2"},ls={class:"cursor-grab text-gray-400 hover:text-gray-600 active:cursor-grabbing px-2"},is=["onUpdate:modelValue","onBlur"],ds=["onClick"],us={class:"p-0 text-sm text-gray-600"},cs=["onUpdate:modelValue"],ps={class:"p-0 text-sm"},ms=["onUpdate:modelValue"],hs={class:"p-0 text-sm"},bs=["onUpdate:modelValue"],gs={class:"p-0 text-sm"},fs=["onUpdate:modelValue"],xs={class:"p-0 text-sm"},vs=["onUpdate:modelValue"],ys={class:"p-0 text-sm"},ws=["onUpdate:modelValue"],js={class:"p-0 text-sm"},_s=["onUpdate:modelValue"],Ps={class:"px-2 py-3 text-sm font-medium text-violet-700 text-right"},ks={class:"p-0 text-sm"},Ss=["onUpdate:modelValue"],Cs={class:"p-0 text-sm"},Ts=["onUpdate:modelValue"],Ds={class:"px-2 py-3 text-sm font-medium text-violet-700 text-right"},$s={class:"p-0 text-sm"},Us=["onUpdate:modelValue"],Fs={class:"p-0 text-sm"},Es=["onUpdate:modelValue"],As={class:"p-0 text-sm"},Os=["onUpdate:modelValue"],Ns={class:"p-0 text-sm"},Rs=["onUpdate:modelValue"],Vs={class:"px-2 py-3 text-sm font-medium text-violet-700 text-right"},Bs={class:"border-t-2 border-slate-300 bg-gradient-to-r from-slate-100 to-gray-100 font-bold shadow-lg"},Ls={class:"px-4 py-4 text-sm text-blue-800 bg-blue-50/80 border border-blue-200/50 text-right font-semibold"},Ms={class:"px-4 py-4 text-sm text-emerald-800 bg-emerald-50/80 border border-emerald-200/50 text-right font-semibold"},Is={class:"px-4 py-4 text-sm text-amber-800 bg-amber-50/80 border border-amber-200/50 text-right font-semibold"},Hs={class:"px-4 py-4 text-sm text-amber-800 bg-amber-50/80 border border-amber-200/50 text-right font-semibold"},qs={class:"px-4 py-4 text-sm text-amber-800 bg-amber-50/80 border border-amber-200/50 text-right font-semibold"},Ks={class:"px-4 py-4 text-sm text-purple-800 bg-purple-50/80 border border-purple-200/50 text-right font-semibold"},Js={class:"px-4 py-4 text-sm text-purple-800 bg-purple-50/80 border border-purple-200/50 text-right font-semibold"},Xs={__name:"project_budget_revenue",setup(g){const e=F(!1),r=F(!0),o=F(!1),n=F(""),p=F(!1),m=F(!1),u=F(""),f=F([]),v=F(""),$=F(!1),c=F([]),J=I(()=>V.value.reduce((l,s)=>l+s.tasks.length,0)),G=I(()=>V.value.reduce((l,s)=>l+s.subtotalBudget,0)),Y=I(()=>V.value.reduce((l,s)=>l+s.subtotalActual,0)),Q=I(()=>Y.value-G.value),V=I(()=>c.value.filter(l=>l.tasks&&l.tasks.length>0)),Z=(l=!1)=>S(this,null,function*(){var s;try{o.value=!0;const a=(s=st.value)==null?void 0:s.project_name;(l||N.getAllProjects().length===0)&&(yield N.fetchData()),c.value=[...N.getAllProjects()],r.value=!0,n.value=""}catch(a){console.error("Load data error:",a),n.value=a.message,D.error(`Failed to load data: ${a.message}`)}finally{o.value=!1}}),C=l=>le.formatCurrency(l),y=()=>{r.value=!1,n.value="",c.value=[...c.value]},O=l=>{const s=String.fromCharCode(l.which);/[0-9.]/.test(s)||l.preventDefault()},it=()=>S(this,null,function*(){o.value=!0,n.value="";try{yield N.saveData(c.value),r.value=!0,D.success("Construction budget saved successfully")}catch(l){n.value=l.message,D.error(`Failed to save changes: ${l.message}`)}finally{o.value=!1}}),dt=l=>{const s=c.value.find(a=>a.id===l);s?(s.addTask(),c.value=[...c.value],y()):console.error("Project not found with ID:",l)},ut=(l,s)=>S(this,null,function*(){if(confirm("Are you sure you want to delete this task?"))try{s&&s!==null&&s!==void 0&&(yield ct(s));const a=c.value.find(h=>h.id===l);a&&(a.removeTask(s),c.value=[...c.value],y(),D.success("Task deleted successfully"))}catch(a){D.error(`Failed to delete task: ${a.message}`)}}),ct=l=>S(this,null,function*(){try{const s=yield fetch("/api/method/ex_forcast.api.construction_budget_api.delete_construction_budget_task",{method:"POST",headers:{"Content-Type":"application/json","X-Frappe-CSRF-Token":R()},body:JSON.stringify({task_id:l})});if(!s.ok){const i=yield s.text();throw new Error(`HTTP error! status: ${s.status} - ${i}`)}const a=yield s.json(),h=a.message||a;if(!h.success)throw new Error(h.error||"Failed to delete task");return a}catch(s){throw console.error("Error deleting task from database:",s),s}}),pt=(l,s)=>{const a=l.target.value;y(),s.name=a||`PROJECT ${s.id}`,s.tasks.length>0&&(s.tasks[0].project_name=a||s.name),c.value=[...c.value]},mt=(l,s,a)=>{try{const h=c.value.find(i=>i.id===l);if(h){const i=h.tasks.find(k=>k.id===s);i&&(i.task=a||"Untitled Task",c.value=[...c.value],y())}}catch(h){D.error(`Failed to update task name: ${h.message}`)}},tt=()=>{const l=c.value.length+1;u.value=`PROJECT ${l}`,m.value=!0,$.value=!1,v.value="",et()},ht=()=>{const l=(u.value||"").trim(),s=new Set(c.value.flatMap(k=>k.tasks&&k.tasks[0]?[String(k.tasks[0].project_name).toLowerCase()]:[]));if(l&&s.has(l.toLowerCase())){$.value=!0,D.warning("Project already exists. Please select it from the dropdown.");return}if(v.value){const k=f.value.find(Pt=>Pt.name===v.value),d=k?k.project_name||k.name:v.value,M=A.createEmpty(d);M.tasks.length>0&&(M.tasks[0].project_name=d),c.value.push(M),c.value=[...c.value],m.value=!1,u.value="",v.value="",$.value=!1,y();return}const a=c.value.length+1,h=l||`PROJECT ${a}`,i=A.createEmpty(h);i.tasks.length>0&&(i.tasks[0].project_name=h),c.value.push(i),c.value=[...c.value],m.value=!1,u.value="",$.value=!1,y()},bt=()=>{m.value=!1,u.value="",v.value="",$.value=!1},gt=()=>S(this,null,function*(){try{yield Z(!0),D.success("Data refreshed successfully")}catch(l){D.error(`Failed to refresh data: ${l.message}`)}}),ft=()=>{try{const l=N.exportData("csv"),s=new Blob([l],{type:"text/csv"}),a=window.URL.createObjectURL(s),h=document.createElement("a");h.href=a,h.download=`construction_budget_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(a),D.success("Data exported successfully")}catch(l){D.error(`Failed to export data: ${l.message}`)}},et=()=>S(this,null,function*(){try{f.value=yield N.fetchAvailableProjects()}catch(l){D.error(`Failed to load existing projects: ${l.message}`)}}),xt=l=>S(this,null,function*(){if(confirm("Delete this Construction Budget Project and all its tasks? This cannot be undone."))try{yield N.deleteProject(l),c.value=c.value.filter(a=>a.id!==l),c.value=[...c.value],D.success("Project deleted successfully")}catch(a){D.error(`Failed to delete project: ${a.message}`)}}),q=F({projectId:null,fromIndex:null}),vt=(l,s)=>{q.value={projectId:l,fromIndex:s}},yt=(l,s)=>{const{projectId:a,fromIndex:h}=q.value||{};if(!(a===null||h===null)){if(a!==l){q.value={projectId:null,fromIndex:null};return}try{const i=c.value.find(M=>M.id===l);if(!i||!i.tasks)return;const k=i.tasks;if(h===s)return;const[d]=k.splice(h,1);k.splice(s,0,d),c.value=[...c.value],y()}finally{q.value={projectId:null,fromIndex:null}}}},wt=l=>{l.preventDefault()},jt=()=>{p.value=!0},_t=()=>{p.value=!1};return kt(()=>S(this,null,function*(){try{yield St()}catch(l){}yield N.testApiConnection(),yield Z()})),Ct(st,(l,s)=>S(this,null,function*(){const a=l==null?void 0:l.project_name,h=s==null?void 0:s.project_name})),(l,s)=>(j(),P("div",de,[b(At,{onOpenSettings:jt}),t("div",ue,[t("div",ce,[t("div",{class:H(["bg-gradient-to-b from-white to-gray-50 border-r border-gray-200 min-h-screen flex flex-col shadow-sm transition-all duration-300",e.value?"w-14 p-2":"w-80 p-6"])},[t("button",{onClick:s[0]||(s[0]=a=>e.value=!e.value),class:"mb-4 flex items-center gap-2 px-2 py-1 bg-violet-100 hover:bg-violet-200 rounded transition-all dark:bg-violet-900/30 dark:hover:bg-violet-800/40"},[e.value?(j(),rt(x(Mt),{key:1,class:"w-5 h-5 text-violet-700 dark:text-white"})):(j(),rt(x(Lt),{key:0,class:"w-5 h-5 text-violet-700 dark:text-white"})),e.value?B("",!0):(j(),P("span",pe,"Collapse"))]),b($t,{name:"fade"},{default:Tt(()=>[T(t("div",null,[t("div",me,[t("div",he,[t("div",be,[b(x(X),{class:"w-7 h-7 mx-2 text-white"})]),s[11]||(s[11]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Project Budget",-1))]),s[12]||(s[12]=t("p",{class:"text-sm text-gray-500"},"Manage and track your construction project budget",-1))]),t("div",ge,[t("div",fe,[t("div",xe,[r.value?(j(),P("div",ye,[b(x(Nt),{class:"w-4 h-4 text-green-600"}),s[14]||(s[14]=_(" All Saved ",-1))])):(j(),P("div",ve,[b(x(Ot),{class:"w-4 h-4 text-red-600"}),s[13]||(s[13]=_(" Unsaved ",-1))]))]),!o.value&&!r.value?(j(),P("button",{key:0,disabled:o.value,onClick:it,class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-lg hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[b(x(Ht),{class:"w-4 h-4"}),s[15]||(s[15]=_(" Save ",-1))],8,we)):B("",!0),o.value?(j(),P("button",je,[b(x(qt),{class:"w-4 h-4 animate-spin"}),s[16]||(s[16]=_(" Saving... ",-1))])):B("",!0)]),n.value?(j(),P("span",_e,[b(x(It),{class:"w-3 h-3"}),_(" "+w(n.value),1)])):B("",!0)]),t("div",Pe,[t("h3",ke,[b(x(ot),{class:"w-4 h-4 text-violet-600"}),s[17]||(s[17]=_(" Quick Actions ",-1))]),t("button",{onClick:tt,class:"inline-flex items-center justify-center w-full gap-2 mb-2 px-6 py-3 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-xl hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform font-medium"},[b(x(W),{class:"w-5 h-5"}),s[18]||(s[18]=_(" Add New Project ",-1))]),t("div",Se,[t("button",{onClick:gt,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-violet-200 text-violet-700 rounded-lg hover:bg-violet-50 transition-all text-sm font-medium"},[b(x(Rt),{class:"w-4 h-4"}),s[19]||(s[19]=_(" Refresh ",-1))]),t("button",{onClick:ft,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-green-200 text-green-700 rounded-lg hover:bg-green-50 transition-all text-sm font-medium"},[b(x(Vt),{class:"w-4 h-4"}),s[20]||(s[20]=_(" Export ",-1))])])]),t("div",Ce,[t("h3",Te,[b(x(Kt),{class:"w-5 h-5 text-violet-600"}),s[21]||(s[21]=_(" Project Summary ",-1))]),t("div",De,[t("div",$e,[s[22]||(s[22]=t("span",{class:"text-sm text-gray-600"},"Total Projects:",-1)),t("span",Ue,w(V.value.length),1)]),t("div",Fe,[s[23]||(s[23]=t("span",{class:"text-sm text-gray-600"},"Total Tasks:",-1)),t("span",Ee,w(J.value),1)]),t("div",Ae,[s[24]||(s[24]=t("span",{class:"text-sm text-gray-600"},"Total Budget:",-1)),t("span",Oe,w(C(G.value)),1)]),t("div",Ne,[s[25]||(s[25]=t("span",{class:"text-sm text-gray-600"},"Total Actual:",-1)),t("span",Re,w(C(Y.value)),1)]),t("div",Ve,[s[26]||(s[26]=t("span",{class:"text-sm text-gray-600"},"Variance:",-1)),t("span",{class:H(["font-semibold",Q.value>=0?"text-red-600":"text-green-600"])},w(C(Q.value)),3)])])])],512),[[Dt,!e.value]])]),_:1})],2),t("div",Be,[t("div",Le,[t("div",Me,[b(x(X),{class:"w-3 h-3 text-white"})]),s[27]||(s[27]=t("h2",{class:"text-lg font-bold text-gray-800"},"Project Budgets and Revenue Overview",-1))]),V.value.length===0?(j(),P("div",Ie,[t("div",He,[t("div",qe,[b(x(X),{class:"w-12 h-12 text-violet-600"})]),s[29]||(s[29]=t("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"No Projects Yet",-1)),s[30]||(s[30]=t("p",{class:"text-gray-600 mb-8 max-w-md mx-auto"}," Get started by creating your first construction project. You can add tasks, track budgets, and monitor progress all in one place. ",-1)),t("button",{onClick:tt,class:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-xl hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 font-medium"},[b(x(W),{class:"w-5 h-5"}),s[28]||(s[28]=_(" Create Your First Project ",-1))])])])):(j(),P("div",Ke,[t("div",Je,[t("div",Xe,[t("table",ze,[s[40]||(s[40]=t("thead",{class:"bg-violet-500 text-white shadow-lg"},[t("tr",{class:"border-b border-white/20"},[t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-96"},"Task"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-[400px]"},"Description"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-72"},"Status"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-48"},"Planned Start Date"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-48"},"Actual Start Date"),t("th",{class:"px-6 py-4 text-left text-sm font-bold text-white uppercase tracking-wider w-40"},"End Date"),t("th",{colspan:"3",class:"px-6 py-4 text-center text-sm font-bold uppercase tracking-wider border-l-2 border-r-2 border-white/30 bg-violet-500"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-2 h-2 bg-violet-200 rounded-full"}),_(" Labor ")])]),t("th",{colspan:"3",class:"px-6 py-4 text-center text-sm font-bold uppercase tracking-wider border-l-2 border-r-2 border-white/30 bg-violet-500"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-2 h-2 bg-violet-200 rounded-full"}),_(" Materials ")])]),t("th",{colspan:"3",class:"px-6 py-4 text-center text-sm font-bold uppercase tracking-wider border-l-2 border-r-2 border-white/30 bg-violet-500"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-2 h-2 bg-violet-200 rounded-full"}),_(" Fixed ")])]),t("th",{colspan:"3",class:"px-6 py-4 text-center text-sm font-bold uppercase tracking-wider border-l-2 border-r-2 border-white/30 bg-violet-500"},[t("div",{class:"flex items-center justify-center gap-2"},[t("div",{class:"w-2 h-2 bg-violet-200 rounded-full"}),_(" Balance ")])])]),t("tr",{class:"bg-violet-500 text-white border-b border-white/20"},[t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-6 py-3 text-left text-xs font-semibold tracking-wider"}),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-64"},"HR"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-72"},"/HR"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-56"},"Total Labor"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Units"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-56"},"/Units"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-60"},"Total Materials"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Travel"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-60"},"Equipment/Space"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Misc."),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Budget"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-52"},"Actual"),t("th",{class:"px-4 py-3 text-center text-xs font-semibold border border-violet-400/30 bg-violet-500/20 w-56"},"Under/Over")])],-1)),t("tbody",We,[(j(!0),P(K,null,z(V.value,(a,h)=>(j(),P(K,{key:`project-${a.id}`},[t("tr",Ge,[t("td",Ye,[t("div",Qe,[t("div",Ze,[s[31]||(s[31]=t("div",{class:"w-3 h-3 bg-gradient-to-r from-violet-500 to-purple-500 rounded-full"},null,-1)),t("input",{value:a.tasks.length>0&&a.tasks[0].project_name,onInput:i=>pt(i,a),type:"text",class:"font-bold text-lg bg-transparent border-0 focus:ring-2 focus:ring-violet-500 focus:bg-white focus:shadow-sm px-2 py-1 rounded transition-all duration-200 min-w-0 flex-1",placeholder:"Project name"},null,40,ts)]),t("div",es,[t("button",{onClick:i=>dt(a.id),class:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-lg hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},[b(x(ot),{class:"w-4 h-4"}),s[32]||(s[32]=_(" Add Task ",-1))],8,ss),t("button",{onClick:i=>xt(a.id),class:"inline-flex items-center gap-2 px-3 py-2 border border-red-200 text-red-700 rounded-lg hover:bg-red-50 transition-all text-sm font-medium",title:"Delete this project and its tasks"},[b(x(at),{class:"w-4 h-4"}),s[33]||(s[33]=_(" Delete Project Tasks ",-1))],8,rs)])])])]),(j(!0),P(K,null,z(a.tasks,(i,k)=>(j(),P("tr",{key:`task-${a.id}-${i.id||k}`,class:"transition-all duration-200 h-12 align-middle hover:bg-slate-50/50 border-b border-gray-100",draggable:!0,onDragstart:d=>vt(a.id,k),onDragover:wt,onDrop:d=>yt(a.id,k)},[t("td",as,[t("div",ns,[t("span",ls,[b(x(Jt),{class:"w-4 h-4"})]),T(t("input",{"onUpdate:modelValue":d=>i.task=d,type:"text",class:H(["flex-1 h-full px-4 py-0 border-0 bg-transparent text-sm focus:ring-2 focus:ring-violet-500 focus:bg-white focus:shadow-sm font-medium transition-all duration-200",i.isSubtask?"pl-8 text-gray-600":"text-gray-900"]),placeholder:"Enter task name",onInput:y,onBlur:d=>mt(a.id,i.id,i.task)},null,42,is),[[U,i.task]]),t("button",{type:"button",class:"shrink-0 inline-flex items-center justify-center w-8 h-8 rounded-md text-red-600 hover:text-white hover:bg-red-600 transition-colors",onClick:d=>ut(a.id,i.id),title:"Delete task"},[b(x(at),{class:"w-4 h-4"})],8,ds)])]),t("td",us,[T(t("input",{"onUpdate:modelValue":d=>i.description=d,type:"text",class:"w-full h-full px-4 py-0 border-0 bg-transparent text-sm focus:ring-2 focus:ring-violet-500 focus:bg-white focus:shadow-sm transition-all duration-200",placeholder:"Enter description",onInput:y},null,40,cs),[[U,i.description]])]),t("td",ps,[T(t("select",{"onUpdate:modelValue":d=>i.status=d,class:"w-full h-full px-4 py-0 border-0 bg-transparent text-sm focus:ring-2 focus:ring-violet-500 focus:bg-white focus:shadow-sm transition-all duration-200",onChange:y},s[34]||(s[34]=[Ft('<option value="Not Started" data-v-d6396d5d>Not Started</option><option value="In Progress" data-v-d6396d5d>In Progress</option><option value="Complete" data-v-d6396d5d>Complete</option><option value="Needs Review" data-v-d6396d5d>Needs Review</option><option value="Approved" data-v-d6396d5d>Approved</option><option value="Overdue" data-v-d6396d5d>Overdue</option><option value="On Hold" data-v-d6396d5d>On Hold</option>',7)]),40,ms),[[Ut,i.status]])]),t("td",hs,[T(t("input",{"onUpdate:modelValue":d=>i.plannedStartDate=d,type:"date",class:"w-full h-full px-2 py-0 border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,bs),[[U,i.plannedStartDate]])]),t("td",gs,[T(t("input",{"onUpdate:modelValue":d=>i.actualStartDate=d,type:"date",class:"w-full h-full px-2 py-0 border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,fs),[[U,i.actualStartDate]])]),t("td",xs,[T(t("input",{"onUpdate:modelValue":d=>i.endDate=d,type:"date",class:"w-full h-full px-2 py-0 border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,vs),[[U,i.endDate]])]),t("td",ys,[T(t("input",{"onUpdate:modelValue":d=>i.hr=d,type:"number",step:"0.1",onKeypress:s[1]||(s[1]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,ws),[[U,i.hr,void 0,{number:!0}]])]),t("td",js,[T(t("input",{"onUpdate:modelValue":d=>i.ratePerHr=d,type:"number",step:"0.01",onKeypress:s[2]||(s[2]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-violet-500 focus:border-transparent",onInput:y},null,40,_s),[[U,i.ratePerHr,void 0,{number:!0}]])]),t("td",Ps,w(C(i.totalLabor)),1),t("td",ks,[T(t("input",{"onUpdate:modelValue":d=>i.units=d,type:"number",step:"0.1",onKeypress:s[3]||(s[3]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:y},null,40,Ss),[[U,i.units,void 0,{number:!0}]])]),t("td",Cs,[T(t("input",{"onUpdate:modelValue":d=>i.ratePerUnit=d,type:"number",step:"0.01",onKeypress:s[4]||(s[4]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:y},null,40,Ts),[[U,i.ratePerUnit,void 0,{number:!0}]])]),t("td",Ds,w(C(i.totalMaterials)),1),t("td",$s,[T(t("input",{"onUpdate:modelValue":d=>i.travel=d,type:"number",step:"0.01",onKeypress:s[5]||(s[5]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent",onInput:y},null,40,Us),[[U,i.travel,void 0,{number:!0}]])]),t("td",Fs,[T(t("input",{"onUpdate:modelValue":d=>i.equipment=d,type:"number",step:"0.01",onKeypress:s[6]||(s[6]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent",onInput:y},null,40,Es),[[U,i.equipment,void 0,{number:!0}]])]),t("td",As,[T(t("input",{"onUpdate:modelValue":d=>i.misc=d,type:"number",step:"0.01",onKeypress:s[7]||(s[7]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-green-500 focus:border-transparent",onInput:y},null,40,Os),[[U,i.misc,void 0,{number:!0}]])]),t("td",Ns,[T(t("input",{"onUpdate:modelValue":d=>i.budget=d,type:"number",step:"0.01",onKeypress:s[8]||(s[8]=d=>O(d)),class:"w-full h-full px-2 py-0 text-right border-0 bg-transparent rounded-none text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent",onInput:y},null,40,Rs),[[U,i.budget,void 0,{number:!0}]])]),t("td",Vs,w(C(i.actual)),1),t("td",{class:H(["px-2 py-3 text-sm font-medium text-right",i.underOver>=0?"text-red-50 bg-red-600":"text-green-50 bg-green-600"])},w(C(i.underOver)),3)],40,os))),128)),t("tr",Bs,[s[35]||(s[35]=t("td",{class:"px-6 py-4 text-sm text-slate-800 border border-slate-300 font-bold",colspan:6},[t("div",{class:"flex items-center gap-2"},[t("div",{class:"w-2 h-2 bg-slate-600 rounded-full"}),_(" SUBTOTAL ")])],-1)),s[36]||(s[36]=t("td",{class:"px-4 py-4 text-sm text-blue-800 bg-blue-50/80 border border-blue-200/50"},null,-1)),s[37]||(s[37]=t("td",{class:"px-4 py-4 text-sm text-blue-800 bg-blue-50/80 border border-blue-200/50"},null,-1)),t("td",Ls,w(C(a.subtotalLabor)),1),s[38]||(s[38]=t("td",{class:"px-4 py-4 text-sm text-emerald-800 bg-emerald-50/80 border border-emerald-200/50"},null,-1)),s[39]||(s[39]=t("td",{class:"px-4 py-4 text-sm text-emerald-800 bg-emerald-50/80 border border-emerald-200/50"},null,-1)),t("td",Ms,w(C(a.subtotalMaterials)),1),t("td",Is,w(C(a.subtotalTravel)),1),t("td",Hs,w(C(a.subtotalEquipment)),1),t("td",qs,w(C(a.subtotalMisc)),1),t("td",Ks,w(C(a.subtotalBudget)),1),t("td",Js,w(C(a.subtotalActual)),1),t("td",{class:H(["px-4 py-4 text-sm font-bold text-right border border-gray-200/50",a.subtotalUnderOver>=0?"text-red-800 bg-red-50/80":"text-green-800 bg-green-50/80"])},w(C(a.subtotalUnderOver)),3)])],64))),128))])])])])]))])])]),b(Bt,{"is-visible":p.value,onClose:_t},null,8,["is-visible"]),b(oe,{"is-visible":m.value,"new-project-name":u.value,"available-projects":f.value,"selected-existing-project":v.value,"duplicate-project":$.value,"onUpdate:newProjectName":s[9]||(s[9]=a=>u.value=a),"onUpdate:selectedExistingProject":s[10]||(s[10]=a=>v.value=a),onRefresh:et,onConfirm:ht,onClose:bt},null,8,["is-visible","new-project-name","available-projects","selected-existing-project","duplicate-project"])]))}},nr=nt(Xs,[["__scopeId","data-v-d6396d5d"]]);export{nr as default};
