var M=Object.defineProperty,I=Object.defineProperties;var v=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var S=(e,t,n)=>t in e?M(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,V=(e,t)=>{for(var n in t||(t={}))y.call(t,n)&&S(e,n,t[n]);if(N)for(var n of N(t))O.call(t,n)&&S(e,n,t[n]);return e},w=(e,t)=>I(e,v(t));//! Utility: Get visible years between from and to (inclusive)
function Y(e,t){const n=parseInt(e),s=parseInt(t);if(!n||!s||n>s)return[];const u=[];for(let r=n;r<=s;r++)u.push(r);return u}//! Utility: Get column labels for display mode
const R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],B=["Jan-Mar","Apr-Jun","Jul-Sep","Oct-Dec"];function j(e){return e==="monthly"?R:B}//! Utility: Get amount for a specific field, year, and label (month/quarter)
function E(e,t,n,s,u="monthly"){var r,o,l;if(u==="quarterly"&&["Jan-Mar","Apr-Jun","Jul-Sep","Oct-Dec"].includes(s)){const i=(((r=e==null?void 0:e[n])==null?void 0:r[s])||[]).find(m=>m.expense===t);if(i)return Number(i.amount)||0;const c={"Jan-Mar":["Jan","Feb","Mar"],"Apr-Jun":["Apr","May","Jun"],"Jul-Sep":["Jul","Aug","Sep"],"Oct-Dec":["Oct","Nov","Dec"]};let f=0;for(const m of c[s]){const x=(((o=e==null?void 0:e[n])==null?void 0:o[m])||[]).find(h=>h.expense===t);x&&(f+=Number(x.amount)||0)}return f}else{const i=(((l=e==null?void 0:e[n])==null?void 0:l[s])||[]).find(c=>c.expense===t);return i&&Number(i.amount)||0}}//! Utility: Calculate total for a field in a year
function k(e,t,n,s,u){const r=u(n);let o=0;for(const l of r)o+=E(e,t,n,l,s);return o}//! Safe number conversion utility
function C(e){return typeof e=="number"?e:e==null||e===""?0:Number(e)}//! Handler for cell edits (banquet-specific)
function U({year:e,label:t,expense:n,event:s,originalBanquetData:u,changedCells:r,banquetData:o,isSaved:l,isComponentReady:p}){var x,h,A,T;if(!p||!p.value){console.warn("Component not ready yet, skipping cell edit");return}if(!r||!r.value){console.error("changedCells ref is undefined");return}if(!o){console.error("banquetData is undefined");return}if(!l){console.error("isSaved ref is undefined");return}if(!u||!u.value){console.error("originalBanquetData ref is undefined");return}let i=s.target.innerText.replace(/,/g,"").trim();i===""&&(i="0.00"),i=(parseFloat(i)||0).toFixed(2);let f="0.00";const J=(((h=(x=u.value)==null?void 0:x[e])==null?void 0:h[t])||[]).find(d=>d.expense===n);if(J&&(f=parseFloat(J.amount).toFixed(2)),i!==f){l.value=!1;const d=r.value.findIndex(g=>g.year===e&&g.label===t&&g.expense===n);d!==-1?r.value[d].newValue=i:r.value.push({year:e,label:t,expense:n,newValue:i}),o[e]||(o[e]={});let a=o[e][t]||[];const F=a.findIndex(g=>g.expense===n);F!==-1?a=[...a.slice(0,F),w(V({},a[F]),{amount:parseFloat(i)}),...a.slice(F+1)]:a=[...a,{expense:n,amount:parseFloat(i)}],o[e][t]=a,(T=(A=o==null?void 0:o[e])==null?void 0:A[t])==null||T.find(g=>g.expense===n)}else r.value=r.value.filter(d=>!(d.year===e&&d.label===t&&d.expense===n)),r.value.length===0&&(l.value=!0)}//! Handler for cell input (banquet-specific, real-time formatting)
function z({year:e,label:t,expense:n,event:s,banquetData:u}){let r=s.target.innerText;r=r.replace(/[^\d.]/g,"");const o=r.split(".");if(o.length>2&&(r=o[0]+"."+o.slice(1).join("")),!r.includes(".")||o.length===2&&o[1].length===2){o.length===2&&o[1].length>2&&(r=o[0]+"."+o[1].substring(0,2));const i=(parseFloat(r)||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2});if(i!==s.target.innerText){s.target.innerText=i;const c=document.createRange(),f=window.getSelection(),m=s.target.firstChild||s.target;c.setStart(m,m.textContent.length),c.collapse(!0),f.removeAllRanges(),f.addRange(c)}}else r!==s.target.innerText&&(s.target.innerText=r)}//! Handler for cell focus (banquet-specific, show raw value for editing)
function G({year:e,label:t,expense:n,event:s}){const r=s.target.innerText.replace(/,/g,"");s.target.innerText=r;const o=document.createRange(),l=window.getSelection();o.selectNodeContents(s.target),l.removeAllRanges(),l.addRange(o)}export{G as a,j as b,k as c,U as d,E as e,Y as g,z as h,C as t};
