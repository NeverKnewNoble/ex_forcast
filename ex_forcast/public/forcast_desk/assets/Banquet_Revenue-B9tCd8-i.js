var tt=Object.defineProperty,ot=Object.defineProperties;var at=Object.getOwnPropertyDescriptors;var xe=Object.getOwnPropertySymbols;var st=Object.prototype.hasOwnProperty,rt=Object.prototype.propertyIsEnumerable;var _e=(s,r,n)=>r in s?tt(s,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[r]=n,Z=(s,r)=>{for(var n in r||(r={}))st.call(r,n)&&_e(s,n,r[n]);if(xe)for(var n of xe(r))rt.call(r,n)&&_e(s,n,r[n]);return s},we=(s,r)=>ot(s,at(r));var P=(s,r,n)=>new Promise((m,_)=>{var L=q=>{try{E(n.next(q))}catch(N){_(N)}},j=q=>{try{E(n.throw(q))}catch(N){_(N)}},E=q=>q.done?m(q.value):Promise.resolve(q.value).then(L,j);E((n=n.apply(s,r)).next())});import{_ as he,c as u,o as i,b as e,e as h,u as c,r as nt,t as A,w as oe,h as k,M as lt,y as it,z as de,A as Q,n as b,k as ct,l as dt,m as ut,q as D,j as H,i as C,C as J,d as x,D as ke,F as w,p as Y,E as ue,G as vt,T as ve,H as mt}from"./index-BwGj6WF3.js";import{C as Ne,a as pt,u as gt}from"./useCalculationCache-CShkTzc7.js";import{A as Fe,a as S,_ as ht,H as bt,T as me,R as ft,F as xt,d as _t,c as ye,X as Ce,b as je,S as wt}from"./SettingsModal-CjiElTAA.js";import{t as y,g as kt,h as yt,a as Ct,b as jt,c as qt,d as At}from"./index-CPVubr0e.js";import{t as Bt,i as U}from"./advanced_settings-B1nQQWYi.js";import{c as St}from"./data_service-DGAZvnHQ.js";import{C as De,a as qe}from"./circle-alert-CNXa3P42.js";import{c as ee,T as Nt}from"./cloneDeep-Wc6Rfcfh.js";import{C as Ft}from"./chevron-left-BbO7ydmM.js";import"./createLucideIcon-TLygUmUt.js";import"./zap-js4DRfLO.js";function Le(s){return y(s.pax)*y(s.avg_food_check)}function Ye(s){return y(s.pax)*y(s.avg_liquor_check)}function Ee(s){return y(s.pax)*y(s.avg_soft_drinks_check)}function Re(s){return y(s.events)*y(s.avg_hall_space_charges_check)}const Ae=["food","liquor","soft_drinks","hall_space_charges"],Dt=["gross","net_amount","advance_bal","amount_per_event","amount_per_pax","avg_pax_per_event"],Lt=["events","pax","avg_food_check","avg_liquor_check","avg_soft_drinks_check","avg_hall_space_charges_check"];function ae(s,r=[]){let n=0;for(const m of Ae)switch(m){case"food":n+=Le(s);break;case"liquor":n+=Ye(s);break;case"soft_drinks":n+=Ee(s);break;case"hall_space_charges":n+=Re(s);break}for(const m of r)!Ae.includes(m)&&!Dt.includes(m)&&!Lt.includes(m)&&(n+=y(s[m]));return n}function Yt(s,r=[]){return ae(s,r)-y(s.advance_bal||0)}function Et(s){const r=y(s.events);return r===0?0:ae(s)/r}function Rt(s){const r=y(s.pax);return r===0?0:ae(s)/r}function Pt(s){const r=y(s.events);return r===0?0:y(s.pax)/r}const Tt=["events","pax"];function te(s,r){return Tt.includes(s)?r===0||r==="0"||r===0||r==="0.00"?"0":isNaN(r)?r:Number(r).toLocaleString(void 0,{maximumFractionDigits:0}):!isNaN(r)&&r!==""&&r!==null?Number(r).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):r}const Be=[{code:"events",label:"Events"},{code:"pax",label:"Number of persons (Pax)"},{code:"avg_food_check",label:"Average food check"},{code:"avg_liquor_check",label:"Average liquor check"},{code:"avg_soft_drinks_check",label:"Average soft drinks check"},{code:"avg_hall_space_charges_check",label:"Average hall/Space charges check"},{code:"food",label:"Food"},{code:"liquor",label:"Liquor"},{code:"soft_drinks",label:"Soft Drinks"},{code:"hall_space_charges",label:"Hall/Space Charges"},{code:"outside_service_food_catering",label:"Outside Service Food Catering"},{code:"outside_service_beverage_catering",label:"Outside Service Beverage Catering"},{code:"tobacco",label:"Tobacco"},{code:"non_fnb",label:"Non F&B"},{code:"others",label:"Others"},{code:"gross",label:"Gross"},{code:"advance_bal",label:"Advance(Bal)"},{code:"net_amount",label:"Net Amount"},{code:"amount_per_event",label:"Amount / Event*"},{code:"amount_per_pax",label:"Amount per Pax*"},{code:"avg_pax_per_event",label:"Average Pax/Event"}],Pe="/api/method/ex_forcast.api.call_and_save_banquet_revenue";function pe(s=null){return P(this,null,function*(){try{let r=`${Pe}.banquet_revenue_display`;s&&(r+=`?project=${encodeURIComponent(s)}`);const n=yield fetch(r);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const m=yield n.json();if(m.error)throw new Error(m.error);return m.message||m}catch(r){throw console.error("Error loading Banquet revenue data:",r),r}})}function Vt(s,r=null){return P(this,null,function*(){var n;try{const m=new FormData;m.append("changes",JSON.stringify(s)),r&&m.append("project",r);const _=yield fetch(`${Pe}.upsert_banquet_revenue_items`,{method:"POST",body:m});if(!_.ok){const j=yield _.text();throw new Error(`HTTP error! status: ${_.status}, response: ${j}`)}const L=yield _.json();if(((n=L.message)==null?void 0:n.status)==="error")throw new Error(L.message.message);return L}catch(m){throw console.error("Error saving Banquet revenue changes:",m),m}})}function ge(s){const r={};for(const n in s){r[n]={};for(const m in s[n])r[n][m]=(s[n][m]||[]).map(_=>we(Z({},_),{expense:_.banquet_detail}))}return r}const Mt={class:"flex flex-col items-center justify-center min-h-[400px] bg-white border-2 border-dashed border-violet-300 rounded-xl shadow-sm"},$t={class:"w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center mb-4"},It={class:"mt-4 flex items-center gap-2 text-xs text-violet-600"},Ot={__name:"NoProjectSelectedState",setup(s){return(r,n)=>(i(),u("div",Mt,[e("div",$t,[h(c(De),{class:"w-8 h-8 text-violet-500"})]),n[1]||(n[1]=e("h3",{class:"text-lg text-violet-700 font-semibold mb-2"},"No Project Selected",-1)),n[2]||(n[2]=e("p",{class:"text-gray-500 text-center max-w-md leading-relaxed text-sm"}," Please select a project from the dashboard to view and manage banquet revenue assumptions. ",-1)),e("div",It,[h(c(Fe),{class:"w-3 h-3"}),n[0]||(n[0]=e("span",null,"Use the project selector in the dashboard to get started",-1))])]))}},Se=he(Ot,[["__scopeId","data-v-0dccb20b"]]),Ht={class:"flex flex-col items-center justify-center min-h-[400px] bg-white border-2 border-dashed border-violet-300 rounded-xl shadow-sm"},Ut={class:"w-16 h-16 bg-violet-100 rounded-full flex items-center justify-center mb-4"},zt={class:"text-lg text-violet-700 font-semibold mb-2"},Gt={class:"text-gray-500 text-center max-w-md leading-relaxed text-sm"},Qt={class:"mt-4 flex items-center gap-2 text-xs text-violet-600"},Jt={class:"mt-6"},Kt={__name:"NoYearsSelectedState",props:{fromYear:{type:String,default:""},toYear:{type:String,default:""}},setup(s){return(r,n)=>{const m=nt("router-link");return i(),u("div",Ht,[e("div",Ut,[h(c(De),{class:"w-8 h-8 text-violet-500"})]),e("h3",zt,A(s.fromYear&&!s.toYear?'Select "To Year"':!s.fromYear&&s.toYear?'Select "From Year"':"No Years Selected"),1),e("p",Gt,A(s.fromYear&&!s.toYear?"You have selected a From Year, now please select a To Year to display the banquet table.":!s.fromYear&&s.toYear?"You have selected a To Year, now please select a From Year to display the banquet table.":'Please select both "From Year" and "To Year" in the left panel to display the banquet table.'),1),e("div",Qt,[h(c(Fe),{class:"w-3 h-3"}),n[0]||(n[0]=e("span",null,"Use the filters on the left to get started",-1))]),e("div",Jt,[h(m,{to:"/expense_estimate",class:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-to-r from-violet-600 to-violet-700 text-white hover:from-violet-700 hover:to-violet-800 shadow"},{default:oe(()=>[h(c(Ne),{class:"w-4 h-4"}),n[1]||(n[1]=e("span",null,"Set Years in Expense",-1))]),_:1,__:[1]})])])}}},Wt=he(Kt,[["__scopeId","data-v-2d7bd34f"]]),Xt={class:"flex"},Zt={class:"flex-1 min-h-screen bg-gradient-to-br from-white to-violet-50"},eo={class:"flex"},to={key:2,class:"text-violet-700 text-sm font-medium dark:text-white"},oo={class:"mb-8"},ao={class:"flex items-center gap-3 mb-2"},so={class:"w-12 h-12 bg-gradient-to-br from-violet-500 to-violet-600 rounded-xl flex items-center justify-center shadow-lg"},ro={class:"bg-white rounded-xl p-4 mb-6 border border-gray-200 shadow-sm"},no={class:"flex items-center justify-between"},lo={class:"flex items-center gap-2"},io={key:0,class:"flex items-center gap-2 text-sm font-medium text-red-600 bg-red-50 px-3 py-2 rounded-lg border border-red-200"},co={key:1,class:"flex items-center gap-2 text-sm font-medium text-green-600 bg-green-50 px-3 py-2 rounded-lg border border-green-200"},uo=["disabled"],vo={key:1,class:"flex items-center gap-2 px-4 py-2 bg-gray-500 text-white rounded-lg cursor-not-allowed"},mo={key:0,class:"mt-2 text-xs text-red-500 flex items-center gap-1"},po={class:"mb-8"},go={key:0,class:"mb-4"},ho={class:"flex items-center gap-2 p-4 bg-red-100 border border-red-200 rounded text-red-800 text-sm"},bo={class:"flex gap-2 mt-3"},fo={class:"flex-1"},xo={class:"bg-white rounded-xl p-5 border border-gray-200 shadow-sm"},_o={class:"space-y-4"},wo={class:"grid grid-cols-2 gap-3"},ko=["value"],yo=["value"],Co={class:"flex gap-2"},jo={class:"flex-1 p-4"},qo={class:"mb-4"},Ao={class:"flex items-center gap-2"},Bo={class:"w-6 h-6 bg-gradient-to-br from-violet-500 to-violet-600 rounded-lg flex items-center justify-center"},So={class:"flex gap-2 mt-2"},No=["disabled"],Fo={class:"bg-white rounded-lg border border-violet-200 shadow-sm overflow-hidden md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px] dark:bg-gray-800 dark:border-gray-600"},Do={class:"overflow-x-auto max-w-[100%] md:max-w-[1800px] lg:max-w-[1800px] xl:max-w-[2000px] 2xl:max-w-[2000px]"},Lo={class:"min-w-full w-max"},Yo={class:"w-full"},Eo={class:"bg-gradient-to-r from-violet-600 to-violet-700 text-white"},Ro={rowspan:"2",class:"px-3 py-2 text-left align-middle border-r border-violet-400 font-semibold text-sm"},Po={class:"flex items-center gap-1"},To=["colspan","onClick"],Vo={class:"flex items-center justify-center gap-1"},Mo={class:"font-semibold"},$o={class:"bg-violet-500/90 text-xs"},Io={key:1,class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},Oo={class:"text-gray-700 bg-white text-sm dark:text-gray-200 dark:bg-gray-800"},Ho={class:"flex items-center gap-1"},Uo={key:0,class:"px-2 py-0.5 rounded bg-violet-100 text-violet-700 text-[10px] font-semibold border border-violet-200 align-middle whitespace-nowrap dark:bg-violet-800/30 dark:text-violet-200 dark:border-violet-600"},zo={key:1,class:"px-2 py-0.5 rounded bg-green-100 text-green-700 text-[10px] font-semibold border border-green-200 align-middle whitespace-nowrap dark:bg-green-800/30 dark:text-green-200 dark:border-green-600"},Go=["onClick"],Qo={class:"text-xs"},Jo=["onInput","onFocus","onBlur"],Ko={class:"text-xs"},Wo={key:0},Xo=["colspan"],Zo={key:1},ea=["colspan"],ta={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm"},oa={class:"bg-white rounded-2xl shadow-2xl border border-violet-200 w-[95%] max-w-lg p-0 overflow-hidden"},aa={class:"flex items-center gap-3 px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},sa={class:"p-8 pt-6"},ra={key:0,class:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center gap-3"},na={key:1,class:"space-y-4 max-h-[50vh] overflow-auto pr-2"},la={class:"font-medium text-gray-700 flex items-center gap-2"},ia=["onUpdate:modelValue"],ca={class:"flex justify-end gap-3 px-8 py-4 bg-gray-50 border-t border-violet-100"},da={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm"},ua={class:"bg-white rounded-2xl shadow-2xl border border-violet-200 w-[95%] max-w-md p-0 overflow-hidden"},va={class:"flex items-center gap-3 px-8 py-6 bg-gradient-to-r from-violet-600 to-violet-700"},ma={class:"p-8 pt-6"},pa={key:0,class:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg flex items-center gap-3"},ga={key:1,class:"mb-4"},ha={class:"flex justify-end gap-3 px-8 py-4 bg-gray-50 border-t border-violet-100"},ba=["disabled"],fa={__name:"Banquet_Revenue",setup(s){const r=k([]),n=k("monthly"),m=lt({}),_=k(!1),L=k({}),j=k(!1),E=k({}),q=k([]),N=k(!1),V=k(""),M=k(!1),se=k(!1),K=k(!1),$=k(""),R=k([]),W=k([]),re=k(!1),F=pt(),ne=gt(),{fromYear:z,toYear:G,advancedModes:I}=it(ne),{setFromYear:xa,setToYear:_a,setAdvancedModes:Te,clearYearSettings:Ve,getFilteredToYears:Me}=ne,B=de(()=>kt(z.value,G.value)),$e=de(()=>Me(r.value)),O=l=>jt(I.value[l]||n.value);Q(B,()=>{B.value.forEach(l=>{I.value[l]||ne.setAdvancedMode(l,n.value)})}),Q(m,(l,t)=>{var o;if(b.value&&b.value.project_name){const d=b.value.project_name;["Food","Liquor","Soft Drinks","Hall Space Charges","Gross","Net Amount","Amount Per Event","Amount Per Pax","Avg Pax Per Event","Tobacco","Non F&B","Others"].forEach(v=>{var f,a;(a=(f=F.cache[d])==null?void 0:f["Banquet Revenue Assumptions"])!=null&&a[v]&&delete F.cache[d]["Banquet Revenue Assumptions"][v]}),(o=F.cache[d])!=null&&o["Banquet Revenue Assumptions"]&&Object.keys(F.cache[d]["Banquet Revenue Assumptions"]).forEach(v=>{(v.toLowerCase().includes("outside")||v.toLowerCase().includes("catering")||v.toLowerCase().includes("tobacco")||v.toLowerCase().includes("non")||v.toLowerCase().includes("fnb")||v.toLowerCase().includes("others")||R.value.some(f=>f.code===v))&&delete F.cache[d]["Banquet Revenue Assumptions"][v]})}},{deep:!0,immediate:!0}),Q(_,l=>{l&&(L.value=Z({},I.value))});function Ie(){Te(Z({},L.value)),_.value=!1}function Oe(){_.value=!1}function He(){re.value=!0}function Ue(){re.value=!1}function ze(){K.value=!1}function Ge(){return P(this,null,function*(){if($.value){if(!b.value){S.error("Please select a project first");return}try{if(!(yield fetch("/api/resource/Banquet Details",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({banquet_detail:$.value,project:b.value.project_name})})).ok)throw new Error("Failed to create");$.value="",K.value=!1,yield X(),S.success("Banquet detail added")}catch(l){S.error("Failed to add banquet detail")}}})}function X(){return P(this,null,function*(){try{if(!b.value){R.value=[];return}const t=yield(yield fetch(`/api/resource/Banquet Details?fields=["name","banquet_detail"]&filters=[["project","=","${b.value.project_name}"]]&limit_page_length=1000`)).json();R.value=(t.data||[]).map(o=>({code:o.name,label:o.banquet_detail}))}catch(l){S.error("Failed to load banquet details")}})}ct(()=>P(this,null,function*(){try{if(yield dt(),yield new Promise(l=>setTimeout(l,100)),r.value=yield St(),b.value){const l=(yield pe(b.value.project_name))||{},t=ge(l);Object.assign(m,t)}else m.value={status:"no_project_selected",message:"No project selected"};E.value=ee(m),j.value=!0,se.value=!0,yield X(),localStorage.getItem("showRefreshSuccess")==="true"&&(localStorage.removeItem("showRefreshSuccess"),S.success("Page refreshed successfully"))}catch(l){console.error("Error loading data:",l)}})),Q(b,(l,t)=>P(this,null,function*(){if(l)try{const o=(yield pe(l.project_name))||{},d=ge(o);Object.assign(m,d),E.value=ee(m),q.value=[],j.value=!0,V.value="",yield X(),S.success(`Switched to project: ${l.project_name}`)}catch(o){console.error("Error reloading Banquet revenue data for new project:",o),S.error("Failed to load project data. Please try again.")}else m.value={status:"no_project_selected",message:"No project selected"},E.value=ee(m),q.value=[],j.value=!0,V.value="",R.value=[]}),{deep:!0});function Qe(){Ve(),j.value=!1}function Je({year:l,label:t,expense:o,event:d}){At({year:l,label:t,expense:o,event:d,originalBanquetData:E,changedCells:q,banquetData:m,isSaved:j,isComponentReady:se})}const Ke=()=>P(this,null,function*(){var l,t;try{N.value=!0,V.value="";const o=q.value.map(f=>({year:f.year,month:f.label,banquet_detail:f.expense,amount:f.newValue}));if(o.length===0){N.value=!1;return}const d=yield Vt(o,(l=b.value)==null?void 0:l.project_name),p=(yield pe((t=b.value)==null?void 0:t.project_name))||{},v=ge(p);return Object.assign(m,v),E.value=ee(m),q.value=[],j.value=!0,S.success("Changes saved successfully"),N.value=!1,d}catch(o){V.value=o.message||"Failed to save changes",S.error(V.value),N.value=!1}});Q(j,l=>{l?window.removeEventListener("beforeunload",le):window.addEventListener("beforeunload",le)});function le(l){if(!j.value)return l.preventDefault(),l.returnValue="You have unsaved changes that may be discarded if not saved. Are you sure you want to leave?",l.returnValue}ut(()=>{window.removeEventListener("beforeunload",le)});function We(){var l;if(b.value&&b.value.project_name){const t=b.value.project_name;(l=F.cache[t])!=null&&l["Banquet Revenue Assumptions"]&&(["Food","Liquor","Soft Drinks","Hall Space Charges","Gross","Net Amount","Amount Per Event","Amount Per Pax","Avg Pax Per Event","Tobacco","Non F&B","Others"].forEach(d=>{F.cache[t]["Banquet Revenue Assumptions"][d]&&delete F.cache[t]["Banquet Revenue Assumptions"][d]}),Object.keys(F.cache[t]["Banquet Revenue Assumptions"]).forEach(d=>{(d.toLowerCase().includes("outside")||d.toLowerCase().includes("catering")||d.toLowerCase().includes("tobacco")||d.toLowerCase().includes("non")||d.toLowerCase().includes("fnb")||d.toLowerCase().includes("others")||R.value.some(p=>p.code===d))&&delete F.cache[t]["Banquet Revenue Assumptions"][d]}))}localStorage.setItem("showRefreshSuccess","true"),window.location.reload()}function Xe(l,t,o){var p;const d={};for(const v of ce.value){const a=(((p=l==null?void 0:l[t])==null?void 0:p[o])||[]).find(g=>g.expense===v.code);d[v.code]=a&&Number(a.amount)||0}return y(d.pax)>0||y(d.avg_food_check)>0,d}function ie(l,t,o,d,p="monthly"){var fe;const v=Xe(l,o,d),f=ce.value.map(T=>T.code),a={projectName:(fe=b.value)==null?void 0:fe.project_name,calculationCache:F,year:o,label:d};if(["food","liquor","soft_drinks","hall_space_charges","gross","net_amount","amount_per_event","amount_per_pax","avg_pax_per_event"].includes(t)&&a.projectName&&a.calculationCache){const T=a.calculationCache.getValue(a.projectName,"Banquet Revenue Assumptions",t,a.year,a.label);if(T!=null&&T>0)return T}let g;switch(t){case"food":g=Le(v),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions","Food",a.year,a.label,g);break;case"liquor":g=Ye(v),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions","Liquor",a.year,a.label,g);break;case"soft_drinks":g=Ee(v),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions","Soft Drinks",a.year,a.label,g);break;case"hall_space_charges":g=Re(v),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions","Hall Space Charges",a.year,a.label,g);break;case"gross":g=ae(v,f),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions","Gross",a.year,a.label,g);break;case"net_amount":g=Yt(v,f),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions","Net Amount",a.year,a.label,g);break;case"amount_per_event":g=Et(v),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions","Amount Per Event",a.year,a.label,g);break;case"amount_per_pax":g=Rt(v),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions","Amount Per Pax",a.year,a.label,g);break;case"avg_pax_per_event":g=Pt(v),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions","Avg Pax Per Event",a.year,a.label,g);break;default:g=qt(l,t,o,d,p),a.projectName&&a.calculationCache&&a.year&&a.label&&g>0&&(["outside_service_food_catering","outside_service_beverage_catering","tobacco","non_fnb","others"].includes(t)||t.toLowerCase().includes("outside")||t.toLowerCase().includes("catering")||t.toLowerCase().includes("tobacco")||t.toLowerCase().includes("non")||t.toLowerCase().includes("fnb")||t.toLowerCase().includes("others")||R.value.some(T=>T.code===t))&&a.calculationCache.setValue(a.projectName,"Banquet Revenue Assumptions",t,a.year,a.label,g)}return g}function be(l,t,o,d){const p=O(o);let v=0;for(const f of p)v+=ie(l,t,o,f,d);return v}function Ze(l){return P(this,null,function*(){if(R.value.some(t=>t.code===l.code)){if(!confirm("Are you sure you want to delete this custom banquet detail? This action cannot be undone."))return;try{yield fetch(`/api/resource/Banquet Details/${l.code}`,{method:"DELETE"}),yield X(),S.success("Banquet detail deleted")}catch(t){S.error("Failed to delete banquet detail")}}else W.value.push(l.code)})}function et(){W.value=[],S.success("Default fields have been restored.")}const ce=de(()=>{const l=Be.findIndex(d=>d.code==="others"),t=Be.filter(d=>!W.value.includes(d.code)),o=R.value.filter(d=>!W.value.includes(d.code));return l===-1?[...t,...o]:[...t.slice(0,l),...o,...t.slice(l)]});return(l,t)=>(i(),u(w,null,[e("div",Xt,[h(ht,{onOpenSettings:He}),e("div",Zt,[e("div",eo,[e("div",{class:D(["bg-gradient-to-b from-white to-gray-50 border-r border-gray-200 min-h-screen flex flex-col shadow-sm transition-all duration-300",M.value?"w-14 p-2":"w-80 p-6"])},[e("button",{onClick:t[0]||(t[0]=o=>M.value=!M.value),class:"mb-4 flex items-center gap-2 px-2 py-1 bg-violet-100 hover:bg-violet-200 rounded transition-all dark:bg-violet-900/30 dark:hover:bg-violet-800/40"},[M.value?(i(),H(c(qe),{key:1,class:"w-5 h-5 text-violet-700 dark:text-white"})):(i(),H(c(Ft),{key:0,class:"w-5 h-5 text-violet-700 dark:text-white"})),M.value?C("",!0):(i(),u("span",to,"Collapse"))]),h(ve,{name:"fade"},{default:oe(()=>[J(e("div",null,[e("div",oo,[e("div",ao,[e("div",so,[h(c(bt),{class:"w-7 h-7 mx-2 text-white"})]),t[6]||(t[6]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Banquet Revenue Assumptions",-1))]),t[7]||(t[7]=e("p",{class:"text-sm text-gray-500"},"Manage and configure your banquet revenue data",-1))]),e("div",ro,[e("div",no,[e("div",lo,[j.value?(i(),u("div",co,t[9]||(t[9]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),x(" All Saved ",-1)]))):(i(),u("div",io,t[8]||(t[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1),x(" Unsaved ",-1)])))]),!N.value&&!j.value?(i(),u("button",{key:0,disabled:N.value,onClick:Ke,class:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-violet-600 to-violet-700 text-white rounded-lg hover:from-violet-700 hover:to-violet-800 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105"},t[10]||(t[10]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})],-1),x(" Save ",-1)]),8,uo)):C("",!0),N.value?(i(),u("button",vo,t[11]||(t[11]=[e("svg",{class:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),x(" Saving... ",-1)]))):C("",!0)]),V.value?(i(),u("span",mo,[t[12]||(t[12]=e("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),x(" "+A(V.value),1)])):C("",!0)]),e("div",po,[t[15]||(t[15]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},[e("svg",{class:"w-4 h-4 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})]),x(" Quick Actions ")],-1)),M.value?C("",!0):(i(),u("div",go,[e("div",ho,[h(c(me),{class:"w-6 h-6 text-red-600"}),t[13]||(t[13]=e("span",null,"All figures shown exclude taxes.",-1))])])),e("div",bo,[e("button",{onClick:We,class:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-violet-200 text-violet-700 rounded-lg hover:bg-violet-50 transition-all text-sm font-medium"},[h(c(ft),{class:"w-4 h-4"}),t[14]||(t[14]=x(" Refresh ",-1))])])]),e("div",fo,[e("div",xo,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-violet-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})]),x(" Year Range Filter ")],-1)),e("div",_o,[e("div",wo,[e("div",null,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},[e("svg",{class:"w-3 h-3 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),x(" From Year ")],-1)),J(e("select",{disabled:"","onUpdate:modelValue":t[1]||(t[1]=o=>ke(z)?z.value=o:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-gray-100 text-sm"},[t[16]||(t[16]=e("option",{value:""},"Select Year",-1)),(i(!0),u(w,null,Y(r.value,o=>(i(),u("option",{key:"from-"+o,value:o},A(o),9,ko))),128))],512),[[ue,c(z)]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},[e("svg",{class:"w-3 h-3 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})]),x(" To Year ")],-1)),J(e("select",{disabled:"","onUpdate:modelValue":t[2]||(t[2]=o=>ke(G)?G.value=o:null),class:"w-full px-3 py-2.5 rounded-lg border border-gray-300 focus:border-violet-500 focus:ring-2 focus:ring-violet-200 transition-all bg-gray-100 text-sm"},[t[18]||(t[18]=e("option",{value:""},"Select Year",-1)),(i(!0),u(w,null,Y($e.value,o=>(i(),u("option",{key:"to-"+o,value:o},A(o),9,yo))),128))],512),[[ue,c(G)]])])]),e("div",Co,[e("button",{onClick:Qe,class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-all duration-200 text-sm font-medium"},t[20]||(t[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),x(" Clear ",-1)])),e("button",{onClick:t[3]||(t[3]=o=>_.value=!0),class:"flex-1 flex items-center justify-center gap-2 px-3 py-2.5 bg-white border border-violet-500 text-violet-700 rounded-lg hover:bg-violet-50 transition-all duration-200 text-sm font-medium"},t[21]||(t[21]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})],-1),x(" Advanced ",-1)]))])])])])],512),[[vt,!M.value]])]),_:1})],2),e("div",jo,[c(b)?B.value.length&&se.value?(i(),u(w,{key:1},[e("div",qo,[e("div",Ao,[e("div",Bo,[h(c(Nt),{class:"w-3 h-3 text-white"})]),t[23]||(t[23]=e("h2",{class:"text-lg font-bold text-gray-800"},"Banquet Revenue Assumptions Overview",-1))]),e("div",So,[e("button",{onClick:t[4]||(t[4]=o=>K.value=!0),disabled:!c(b),class:D(["px-3 py-1.5 text-sm font-medium shadow rounded-md transition-all",c(b)?"bg-violet-600 text-white hover:bg-violet-700":"bg-gray-400 text-gray-200 cursor-not-allowed"])}," Add Banquet Detail ",10,No),e("button",{onClick:et,class:"px-3 py-1.5 bg-gray-500 text-white rounded hover:bg-gray-600 text-sm font-medium shadow transition-all"}," Reset to Default ")])]),e("div",Fo,[e("div",Do,[e("div",Lo,[e("table",Yo,[e("thead",Eo,[e("tr",null,[e("th",Ro,[e("div",Po,[h(c(xt),{class:"w-3 h-3"}),t[24]||(t[24]=x(" Banquet Details ",-1))])]),(i(!0),u(w,null,Y(B.value,o=>(i(),u("th",{key:"header-"+o,colspan:c(U)(o)?1:O(o).length+1,class:"px-2 py-2 text-center border-x-2 border-white cursor-pointer select-none hover:bg-violet-700 transition-all duration-200 group text-sm",onClick:d=>c(Bt)(o),title:"Click to collapse/expand"},[e("div",Vo,[e("span",Mo,A(o),1),c(U)(o)?(i(),H(c(qe),{key:1,class:"w-3 h-3 transition-transform group-hover:scale-110"})):(i(),H(c(_t),{key:0,class:"w-3 h-3 transition-transform group-hover:scale-110"}))])],8,To))),128))]),e("tr",$o,[(i(!0),u(w,null,Y(B.value,o=>(i(),u(w,{key:"months-"+o},[c(U)(o)?(i(),u("th",Io,t[26]||(t[26]=[e("div",{class:"flex items-center justify-center gap-1"}," Forecast ",-1)]))):(i(),u(w,{key:0},[(i(!0),u(w,null,Y(O(o),d=>(i(),u("th",{key:o+"-"+d,class:"px-2 py-1 text-center border border-violet-300 min-w-[100px] font-medium"},A(d),1))),128)),t[25]||(t[25]=e("th",{class:"px-2 py-1 text-center border border-violet-300 min-w-[110px] font-semibold"},[e("div",{class:"flex items-center justify-center gap-1"}," Forecast ")],-1))],64))],64))),128))])]),e("tbody",Oo,[(i(!0),u(w,null,Y(ce.value,(o,d)=>(i(),u(w,{key:o.code},[e("tr",{class:D(["transition-all duration-200 border-b border-gray-100 dark:border-gray-700",["gross","net_amount"].includes(o.code)?"bg-violet-700 text-white font-bold":"even:bg-gray-50 hover:bg-violet-50 dark:even:bg-[#151823] dark:hover:bg-[#1d2230]"])},[e("td",{class:D(["px-3 py-2 font-medium border-r border-violet-200 flex items-center justify-between dark:border-violet-600",["gross","net_amount"].includes(o.code)?"bg-violet-700 text-white font-bold":"text-gray-600 dark:text-gray-200"])},[e("span",null,A(o.label),1),e("div",Ho,[["food","liquor","soft_drinks","hall_space_charges","gross","net_amount","amount_per_event","amount_per_pax","avg_pax_per_event"].includes(o.code)?(i(),u("span",Uo," Auto ")):C("",!0),R.value.some(p=>p.code===o.code)?(i(),u("span",zo," Custom ")):C("",!0),["gross","net_amount","advance_bal","amount_per_event","amount_per_pax","avg_pax_per_event"].includes(o.code)?C("",!0):(i(),u("button",{key:2,onClick:p=>Ze(o),class:"ml-2 text-red-500 hover:text-red-700",title:"Delete"},t[27]||(t[27]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,Go))])],2),(i(!0),u(w,null,Y(B.value,p=>(i(),u(w,{key:"row-"+p+"-"+o.code},[c(U)(p)?(i(),u("td",{key:1,class:D(["px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50 dark:border-violet-600 dark:bg-violet-800/30",["gross","net_amount"].includes(o.code)?"bg-violet-800 text-white font-bold":""])},[e("span",{class:D(["text-xs text-violet-700 dark:text-violet-200",["gross","net_amount"].includes(o.code)?"text-white":""])},A(c(te)(o.code,be(m,o.code,p,c(I)[p]||n.value))),3)],2)):(i(),u(w,{key:0},[["food","liquor","soft_drinks","hall_space_charges","gross","net_amount","amount_per_event","amount_per_pax","avg_pax_per_event"].includes(o.code)?(i(!0),u(w,{key:0},Y(O(p),v=>(i(),u("td",{key:"cell-"+p+"-"+v,class:D(["px-2 py-1 text-right border border-violet-200 bg-gray-50 outline-none focus:ring-2 focus:ring-violet-500 transition-all duration-200 font-semibold select-none dark:border-violet-600 dark:bg-gray-800",["gross","net_amount"].includes(o.code)?"bg-violet-700 text-white font-bold":""])},[e("span",Qo,A(c(te)(o.code,ie(m,o.code,p,v,c(I)[p]||n.value))),1)],2))),128)):(i(!0),u(w,{key:1},Y(O(p),v=>(i(),u("td",{key:"cell-editable-"+p+"-"+v,contenteditable:"true",class:D(["px-2 py-1 text-right border border-violet-200 hover:bg-violet-50 outline-none focus:ring-2 focus:ring-violet-500 transition-all duration-200 dark:border-violet-600 dark:hover:bg-violet-900/20 dark:focus:bg-gray-700",["gross","net_amount"].includes(o.code)?"bg-violet-700 text-white font-bold":""]),onInput:f=>c(Ct)({year:p,label:v,expense:o.code,event:f,banquetData:m}),onFocus:f=>c(yt)({year:p,label:v,expense:o.code,event:f}),onBlur:f=>Je({year:p,label:v,expense:o.code,event:f})},[e("span",Ko,A(c(te)(o.code,ie(m,o.code,p,v,c(I)[p]||n.value))),1)],42,Jo))),128)),e("td",{class:D(["px-2 py-1 text-right border border-violet-200 font-semibold bg-violet-50 dark:border-violet-600 dark:bg-violet-800/30",["gross","net_amount"].includes(o.code)?"bg-violet-800 text-white font-bold":""])},[e("span",{class:D(["text-xs text-violet-700 dark:text-violet-200",["gross","net_amount"].includes(o.code)?"text-white":""])},A(c(te)(o.code,be(m,o.code,p,c(I)[p]||n.value))),3)],2)],64))],64))),128))],2),o.code==="avg_hall_space_charges_check"?(i(),u("tr",Wo,[e("td",{colspan:1+B.value.reduce((p,v)=>p+(c(U)(v)?1:O(v).length+1),0),class:"h-10 font-bold text-xl text-violet-700 bg-violet-200 border px-2 py-2 m-0 dark:text-violet-200 dark:bg-violet-800/50 dark:border-violet-600"}," Details ",8,Xo)])):C("",!0),o.code==="net_amount"?(i(),u("tr",Zo,[e("td",{colspan:1+B.value.reduce((p,v)=>p+(c(U)(v)?1:O(v).length+1),0),class:"h-10 font-bold text-xl text-violet-700 bg-violet-200 border px-2 py-2 m-0 dark:text-violet-200 dark:bg-violet-800/50 dark:border-violet-600"}," Statistics ",8,ea)])):C("",!0)],64))),128))])])])])])],64)):c(b)?(i(),H(Wt,{key:2,"from-year":c(z),"to-year":c(G)},null,8,["from-year","to-year"])):(i(),H(Se,{key:3})):(i(),H(Se,{key:0}))])])])]),h(ve,{name:"fade"},{default:oe(()=>[_.value?(i(),u("div",ta,[e("div",oa,[e("div",aa,[h(c(ye),{class:"w-6 h-6 text-white"}),t[28]||(t[28]=e("h2",{class:"text-xl font-bold text-white"},"Advanced Display Mode Settings",-1))]),e("div",sa,[B.value.length?C("",!0):(i(),u("div",ra,[h(c(me),{class:"w-6 h-6 text-yellow-600"}),t[29]||(t[29]=e("span",{class:"text-yellow-800 font-medium"},'Please select both \\"From Year\\" and \\"To Year\\" to configure advanced settings.',-1))])),B.value.length?(i(),u("div",na,[(i(!0),u(w,null,Y(B.value,o=>(i(),u("div",{key:"adv-"+o,class:"flex justify-between items-center border-b pb-2"},[e("span",la,[h(c(Ne),{class:"w-4 h-4 text-violet-600"}),x(" "+A(o),1)]),J(e("select",{"onUpdate:modelValue":d=>L.value[o]=d,class:"px-6 py-2 border rounded-md focus:ring-violet-500"},t[30]||(t[30]=[e("option",{value:"monthly"},"Monthly",-1),e("option",{value:"quarterly"},"Quarterly",-1)]),8,ia),[[ue,L.value[o]]])]))),128))])):C("",!0)]),e("div",ca,[e("button",{onClick:Oe,class:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 flex items-center gap-2"},[h(c(Ce),{class:"w-4 h-4"}),t[31]||(t[31]=x(" Cancel ",-1))]),B.value.length?(i(),u("button",{key:0,onClick:Ie,class:"px-4 py-2 rounded-md bg-violet-600 text-white hover:bg-violet-700 flex items-center gap-2"},[h(c(je),{class:"w-4 h-4"}),t[32]||(t[32]=x(" Apply ",-1))])):C("",!0)])])])):C("",!0)]),_:1}),h(ve,{name:"fade"},{default:oe(()=>[K.value?(i(),u("div",da,[e("div",ua,[e("div",va,[h(c(ye),{class:"w-6 h-6 text-white"}),t[33]||(t[33]=e("h2",{class:"text-xl font-bold text-white"},"Add Banquet Detail",-1))]),e("div",ma,[c(b)?(i(),u("div",ga,[t[35]||(t[35]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Banquet Detail",-1)),J(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>$.value=o),class:"w-full px-3 py-2 border rounded focus:ring-violet-500",placeholder:"e.g. Decoration"},null,512),[[mt,$.value]])])):(i(),u("div",pa,[h(c(me),{class:"w-6 h-6 text-yellow-600"}),t[34]||(t[34]=e("span",{class:"text-yellow-800 font-medium"},"Please select a project first to add banquet details.",-1))]))]),e("div",ha,[e("button",{onClick:ze,class:"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200 text-gray-700 flex items-center gap-2"},[h(c(Ce),{class:"w-4 h-4"}),t[36]||(t[36]=x(" Cancel ",-1))]),e("button",{onClick:Ge,disabled:!c(b)||!$.value,class:D(["px-4 py-2 rounded-md flex items-center gap-2",c(b)&&$.value?"bg-violet-600 text-white hover:bg-violet-700":"bg-gray-400 text-gray-200 cursor-not-allowed"])},[h(c(je),{class:"w-4 h-4"}),t[37]||(t[37]=x(" Add ",-1))],10,ba)])])])):C("",!0)]),_:1}),h(wt,{"is-visible":re.value,onClose:Ue},null,8,["is-visible"])],64))}},La=he(fa,[["__scopeId","data-v-f38738bc"]]);export{La as default};
